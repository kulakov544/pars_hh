{"text": "2024-07-17T12:30:35.445847+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (11448), thread 'MainThread' (6560):\nTraceback (most recent call last):\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x0000023579774C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000002357A051460>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'department__0': None, 'response_letter_required__0': False, 'response_url__0': None, 'published_at__0': '2024-07-16T13:15:1...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000002357A300D60; closed: -1>\n\npsycopg2.ProgrammingError: can't adapt type 'dict'\n\n\nThe above exception was the direct cause of the following exception:\n\n\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 175, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '103992155', 'premium': False, 'name': 'Junior Python Разработчик', 'department': None, 'has_test': False, 'response_...\n    └ <function save_to_db at 0x00000235797FC900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 148, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False)\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x00000235777254E0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    103992155  ...  0fe1b4962066bddca65c231c79b5f8068...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False}\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    103992155  ...  0fe1b4962066bddca65c231c79b5f806...\n           └ <function NDFrame.to_sql at 0x00000235777253A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x0000023578A91620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x0000023578A931A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x000002357A2543E0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2018, in to_sql\n    total_inserted = sql_engine.insert_records(\n                     │          └ <function SQLAlchemyEngine.insert_records at 0x0000023578A92980>\n                     └ <pandas.io.sql.SQLAlchemyEngine object at 0x000002357A2CE930>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1567, in insert_records\n    raise err\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1558, in insert_records\n    return table.insert(chunksize=chunksize, method=method)\n           │     │                │                 └ None\n           │     │                └ None\n           │     └ <function SQLTable.insert at 0x0000023578A91DA0>\n           └ <pandas.io.sql.SQLTable object at 0x000002357A2CF0E0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1119, in insert\n    num_inserted = exec_insert(conn, keys, chunk_iter)\n                   │           │     │     └ <zip object at 0x000002357A311E80>\n                   │           │     └ ['vacancy_id', 'premium', 'name', 'department', 'has_test', 'response_letter_required', 'area', 'salary_from', 'salary_to', '...\n                   │           └ <sqlalchemy.engine.base.Connection object at 0x00000235797D3EF0>\n                   └ <bound method SQLTable._execute_insert of <pandas.io.sql.SQLTable object at 0x000002357A2CF0E0>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1010, in _execute_insert\n    result = conn.execute(self.table.insert(), data)\n             │    │       │    │     │         └ [{'vacancy_id': '103992155', 'premium': False, 'name': 'Junior Python Разработчик', 'department': None, 'has_test': False, 'r...\n             │    │       │    │     └ <function TableClause.insert at 0x00000235795D9300>\n             │    │       │    └ Table('stage_pars_hh', MetaData(), Column('vacancy_id', Text(), table=<stage_pars_hh>), Column('premium', Boolean(), table=<s...\n             │    │       └ <pandas.io.sql.SQLTable object at 0x000002357A2CF0E0>\n             │    └ <function Connection.execute at 0x00000235796B9440>\n             └ <sqlalchemy.engine.base.Connection object at 0x00000235797D3EF0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x000002357A306BD0>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           │          └ <function Connection._execute_clauseelement at 0x00000235796B9760>\n           └ <sqlalchemy.engine.base.Connection object at 0x00000235797D3EF0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          │    └ <function Connection._execute_context at 0x00000235796B9940>\n          └ <sqlalchemy.engine.base.Connection object at 0x00000235797D3EF0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1844, in _execute_context\n    return self._exec_insertmany_context(dialect, context)\n           │    │                        │        └ <sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x000002357A306C90>\n           │    │                        └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000002357A051460>\n           │    └ <function Connection._exec_insertmany_context at 0x00000235796B9A80>\n           └ <sqlalchemy.engine.base.Connection object at 0x00000235797D3EF0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2124, in _exec_insertmany_context\n    self._handle_dbapi_exception(\n    │    └ <function Connection._handle_dbapi_exception at 0x00000235796B9C60>\n    └ <sqlalchemy.engine.base.Connection object at 0x00000235797D3EF0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2353, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n          │                    │              │                 └ ProgrammingError(\"can't adapt type 'dict'\")\n          │                    │              └ (<class 'psycopg2.ProgrammingError'>, ProgrammingError(\"can't adapt type 'dict'\"), <traceback object at 0x000002357A1A6A00>)\n          │                    └ <method 'with_traceback' of 'BaseException' objects>\n          └ ProgrammingError(\"(psycopg2.ProgrammingError) can't adapt type 'dict'\")\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x0000023579774C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000002357A051460>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'department__0': None, 'response_letter_required__0': False, 'response_url__0': None, 'published_at__0': '2024-07-16T13:15:1...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000002357A300D60; closed: -1>\n\nsqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 751951 characters truncated ... 5)s, %(employment__975)s, %(adv_response_url__975)s, %(is_adv_vacancy__975)s, %(vacancy_hash__975)s)]\n[parameters: {'department__0': None, 'response_letter_required__0': False, 'response_url__0': None, 'published_at__0': '2024-07-16T13:15:10+0300', 'premium__0': False, 'snippet_responsibility__0': 'Писать стабильный, поддерживаемый код, в соответствии с ТЗ. Вместе с командой проектировать архитектуру приложений и выбирать технологии. Разработка функционала для...', 'has_test__0': False, 'professional_roles__0': 'Программист, разработчик', 'accept_incomplete_resumes__0': False, 'alternate_url__0': 'https://hh.ru/vacancy/103992155', 'name__0': 'Junior Python Разработчик', 'salary_from__0': 50000.0, 'created_at__0': '2024-07-16T13:15:10+0300', 'vacancy_hash__0': '0fe1b4962066bddca65c231c79b5f806886646de67c420817c8d0e4fc40411ee', 'url__0': 'https://api.hh.ru/vacancies/103992155?host=hh.ru', 'contacts__0': None, 'employer_name__0': 'О-комплекс', 'archived__0': False, 'employer_url__0': 'https://api.hh.ru/employers/5454644', 'show_logo_in_search__0': None, 'accept_temporary__0': False, 'type__0': 'Открытая', 'area__0': 'Москва', 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=103992155', 'snippet_requirement__0': 'Решать задачи на <highlighttext>Python</highlighttext> и разрабатывать сайты при помощи фреймворка Django. Работа с базами данных с ипользованием PostgreSQL (+архитектура). ', 'schedule__0': 'Удаленная работа', 'employment__0': 'Полная занятость', 'is_adv_vacancy__0': False, 'sort_point_distance__0': None, 'adv_response_url__0': None, 'experience__0': 'От 1 года до 3 лет', 'salary_to__0': None, 'vacancy_id__0': '103992155', 'department__1': None, 'response_letter_required__1': False, 'response_url__1': None, 'published_at__1': '2024-07-16T19:17:34+0300', 'premium__1': False, 'snippet_responsibility__1': 'Продукт: разработка проектов для Telegram miniApps. В основном разработка веб приложений и интеграция с платежными системами, в том числе на...', 'has_test__1': False, 'professional_roles__1': 'Программист, разработчик', 'accept_incomplete_resumes__1': False, 'alternate_url__1': 'https://hh.ru/vacancy/104018898', 'name__1': 'Программист', 'salary_from__1': 60000.0, 'created_at__1': '2024-07-16T19:17:34+0300', 'vacancy_hash__1': '621a063c70dcc6985943d083ea5feb581e97ef587e9de2a1b6d4f02880c574bb', 'url__1': 'https://api.hh.ru/vacancies/104018898?host=hh.ru', 'contacts__1': None, 'employer_name__1': 'Profitmarcet' ... 32108 parameters truncated ... 'employer_name__974': 'NAUMEN', 'archived__974': False, 'employer_url__974': 'https://api.hh.ru/employers/42600', 'show_logo_in_search__974': True, 'accept_temporary__974': False, 'type__974': 'Открытая', 'area__974': 'Екатеринбург', 'apply_alternate_url__974': 'https://hh.ru/applicant/vacancy_response?vacancyId=101279533', 'snippet_requirement__974': 'Понимание принципов и проблем многопоточного программирования. Опыт разработки клиент-серверных приложений. Будет плюсом: Опыт разработки на <highlighttext>Python</highlighttext>. Высшее профильное образование.', 'schedule__974': 'Удаленная работа', 'employment__974': 'Полная занятость', 'is_adv_vacancy__974': False, 'sort_point_distance__974': None, 'adv_response_url__974': None, 'experience__974': 'От 3 до 6 лет', 'salary_to__974': None, 'vacancy_id__974': '101279533', 'department__975': None, 'response_letter_required__975': False, 'response_url__975': None, 'published_at__975': '2024-07-14T17:27:46+0300', 'premium__975': False, 'snippet_responsibility__975': 'Планирование этапности перевода функциональности в соответствии с принципами сохранения целостности ведения бизнес-процессов в системе. Формализация требований для <highlighttext>разработчиков</highlighttext>. ', 'has_test__975': False, 'professional_roles__975': 'Системный аналитик', 'accept_incomplete_resumes__975': False, 'alternate_url__975': 'https://hh.ru/vacancy/102794788', 'name__975': 'Аналитик 1С (УТ, ERP)', 'salary_from__975': None, 'created_at__975': '2024-07-14T17:27:46+0300', 'vacancy_hash__975': '695cea8f888792744354dac813fd83911d3dc5cccf6412a9dc706df53e7ef38a', 'url__975': 'https://api.hh.ru/vacancies/102794788?host=hh.ru', 'contacts__975': None, 'employer_name__975': 'Ракета', 'archived__975': False, 'employer_url__975': 'https://api.hh.ru/employers/2501342', 'show_logo_in_search__975': None, 'accept_temporary__975': False, 'type__975': 'Открытая', 'area__975': 'Екатеринбург', 'apply_alternate_url__975': 'https://hh.ru/applicant/vacancy_response?vacancyId=102794788', 'snippet_requirement__975': 'Опыт работы с 1С системами в роли аналитика от 3х лет. Опыт работы с УТ в роли аналитика...', 'schedule__975': 'Удаленная работа', 'employment__975': 'Полная занятость', 'is_adv_vacancy__975': False, 'sort_point_distance__975': None, 'adv_response_url__975': None, 'experience__975': 'От 3 до 6 лет', 'salary_to__975': None, 'vacancy_id__975': '102794788'}]\n(Background on this error at: https://sqlalche.me/e/20/f405)\n", "record": {"elapsed": {"repr": "0:00:25.382051", "seconds": 25.382051}, "exception": {"type": "ProgrammingError", "value": "(psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 751951 characters truncated ... 5)s, %(employment__975)s, %(adv_response_url__975)s, %(is_adv_vacancy__975)s, %(vacancy_hash__975)s)]\n[parameters: {'department__0': None, 'response_letter_required__0': False, 'response_url__0': None, 'published_at__0': '2024-07-16T13:15:10+0300', 'premium__0': False, 'snippet_responsibility__0': 'Писать стабильный, поддерживаемый код, в соответствии с ТЗ. Вместе с командой проектировать архитектуру приложений и выбирать технологии. Разработка функционала для...', 'has_test__0': False, 'professional_roles__0': 'Программист, разработчик', 'accept_incomplete_resumes__0': False, 'alternate_url__0': 'https://hh.ru/vacancy/103992155', 'name__0': 'Junior Python Разработчик', 'salary_from__0': 50000.0, 'created_at__0': '2024-07-16T13:15:10+0300', 'vacancy_hash__0': '0fe1b4962066bddca65c231c79b5f806886646de67c420817c8d0e4fc40411ee', 'url__0': 'https://api.hh.ru/vacancies/103992155?host=hh.ru', 'contacts__0': None, 'employer_name__0': 'О-комплекс', 'archived__0': False, 'employer_url__0': 'https://api.hh.ru/employers/5454644', 'show_logo_in_search__0': None, 'accept_temporary__0': False, 'type__0': 'Открытая', 'area__0': 'Москва', 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=103992155', 'snippet_requirement__0': 'Решать задачи на <highlighttext>Python</highlighttext> и разрабатывать сайты при помощи фреймворка Django. Работа с базами данных с ипользованием PostgreSQL (+архитектура). ', 'schedule__0': 'Удаленная работа', 'employment__0': 'Полная занятость', 'is_adv_vacancy__0': False, 'sort_point_distance__0': None, 'adv_response_url__0': None, 'experience__0': 'От 1 года до 3 лет', 'salary_to__0': None, 'vacancy_id__0': '103992155', 'department__1': None, 'response_letter_required__1': False, 'response_url__1': None, 'published_at__1': '2024-07-16T19:17:34+0300', 'premium__1': False, 'snippet_responsibility__1': 'Продукт: разработка проектов для Telegram miniApps. В основном разработка веб приложений и интеграция с платежными системами, в том числе на...', 'has_test__1': False, 'professional_roles__1': 'Программист, разработчик', 'accept_incomplete_resumes__1': False, 'alternate_url__1': 'https://hh.ru/vacancy/104018898', 'name__1': 'Программист', 'salary_from__1': 60000.0, 'created_at__1': '2024-07-16T19:17:34+0300', 'vacancy_hash__1': '621a063c70dcc6985943d083ea5feb581e97ef587e9de2a1b6d4f02880c574bb', 'url__1': 'https://api.hh.ru/vacancies/104018898?host=hh.ru', 'contacts__1': None, 'employer_name__1': 'Profitmarcet' ... 32108 parameters truncated ... 'employer_name__974': 'NAUMEN', 'archived__974': False, 'employer_url__974': 'https://api.hh.ru/employers/42600', 'show_logo_in_search__974': True, 'accept_temporary__974': False, 'type__974': 'Открытая', 'area__974': 'Екатеринбург', 'apply_alternate_url__974': 'https://hh.ru/applicant/vacancy_response?vacancyId=101279533', 'snippet_requirement__974': 'Понимание принципов и проблем многопоточного программирования. Опыт разработки клиент-серверных приложений. Будет плюсом: Опыт разработки на <highlighttext>Python</highlighttext>. Высшее профильное образование.', 'schedule__974': 'Удаленная работа', 'employment__974': 'Полная занятость', 'is_adv_vacancy__974': False, 'sort_point_distance__974': None, 'adv_response_url__974': None, 'experience__974': 'От 3 до 6 лет', 'salary_to__974': None, 'vacancy_id__974': '101279533', 'department__975': None, 'response_letter_required__975': False, 'response_url__975': None, 'published_at__975': '2024-07-14T17:27:46+0300', 'premium__975': False, 'snippet_responsibility__975': 'Планирование этапности перевода функциональности в соответствии с принципами сохранения целостности ведения бизнес-процессов в системе. Формализация требований для <highlighttext>разработчиков</highlighttext>. ', 'has_test__975': False, 'professional_roles__975': 'Системный аналитик', 'accept_incomplete_resumes__975': False, 'alternate_url__975': 'https://hh.ru/vacancy/102794788', 'name__975': 'Аналитик 1С (УТ, ERP)', 'salary_from__975': None, 'created_at__975': '2024-07-14T17:27:46+0300', 'vacancy_hash__975': '695cea8f888792744354dac813fd83911d3dc5cccf6412a9dc706df53e7ef38a', 'url__975': 'https://api.hh.ru/vacancies/102794788?host=hh.ru', 'contacts__975': None, 'employer_name__975': 'Ракета', 'archived__975': False, 'employer_url__975': 'https://api.hh.ru/employers/2501342', 'show_logo_in_search__975': None, 'accept_temporary__975': False, 'type__975': 'Открытая', 'area__975': 'Екатеринбург', 'apply_alternate_url__975': 'https://hh.ru/applicant/vacancy_response?vacancyId=102794788', 'snippet_requirement__975': 'Опыт работы с 1С системами в роли аналитика от 3х лет. Опыт работы с УТ в роли аналитика...', 'schedule__975': 'Удаленная работа', 'employment__975': 'Полная занятость', 'is_adv_vacancy__975': False, 'sort_point_distance__975': None, 'adv_response_url__975': None, 'experience__975': 'От 3 до 6 лет', 'salary_to__975': None, 'vacancy_id__975': '102794788'}]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 175, "message": "An error has been caught in function '<module>', process 'MainProcess' (11448), thread 'MainThread' (6560):", "module": "main", "name": "__main__", "process": {"id": 11448, "name": "MainProcess"}, "thread": {"id": 6560, "name": "MainThread"}, "time": {"repr": "2024-07-17 12:30:35.445847+03:00", "timestamp": 1721208635.445847}}}
{"text": "2024-07-17T12:43:43.426102+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (10956), thread 'MainThread' (6740):\nTraceback (most recent call last):\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x000002128EA84C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000002128EA92E40>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'snippet_responsibility__0': 'Писать стабильный, поддерживаемый код, в соответствии с ТЗ. Вместе с командой проектировать ар...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000002128F60CD60; closed: -1>\n\npsycopg2.ProgrammingError: can't adapt type 'dict'\n\n\nThe above exception was the direct cause of the following exception:\n\n\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 175, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '103992155', 'premium': False, 'name': 'Junior Python Разработчик', 'department': None, 'has_test': False, 'response_...\n    └ <function save_to_db at 0x000002128EB10900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 148, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False)\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x000002128CA154E0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    103992155  ...  0fe1b4962066bddca65c231c79b5f8068...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False}\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    103992155  ...  0fe1b4962066bddca65c231c79b5f806...\n           └ <function NDFrame.to_sql at 0x000002128CA153A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x000002128DD81620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x000002128DD831A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x000002128F5AFCE0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2018, in to_sql\n    total_inserted = sql_engine.insert_records(\n                     │          └ <function SQLAlchemyEngine.insert_records at 0x000002128DD82980>\n                     └ <pandas.io.sql.SQLAlchemyEngine object at 0x000002128F5DA300>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1567, in insert_records\n    raise err\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1558, in insert_records\n    return table.insert(chunksize=chunksize, method=method)\n           │     │                │                 └ None\n           │     │                └ None\n           │     └ <function SQLTable.insert at 0x000002128DD81DA0>\n           └ <pandas.io.sql.SQLTable object at 0x000002128F5DACC0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1119, in insert\n    num_inserted = exec_insert(conn, keys, chunk_iter)\n                   │           │     │     └ <zip object at 0x000002128F5F0EC0>\n                   │           │     └ ['vacancy_id', 'premium', 'name', 'department', 'has_test', 'response_letter_required', 'area', 'salary_from', 'salary_to', '...\n                   │           └ <sqlalchemy.engine.base.Connection object at 0x000002128DF91DC0>\n                   └ <bound method SQLTable._execute_insert of <pandas.io.sql.SQLTable object at 0x000002128F5DACC0>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1010, in _execute_insert\n    result = conn.execute(self.table.insert(), data)\n             │    │       │    │     │         └ [{'vacancy_id': '103992155', 'premium': False, 'name': 'Junior Python Разработчик', 'department': None, 'has_test': False, 'r...\n             │    │       │    │     └ <function TableClause.insert at 0x000002128E8E9300>\n             │    │       │    └ Table('stage_pars_hh', MetaData(), Column('vacancy_id', Text(), table=<stage_pars_hh>), Column('premium', Boolean(), table=<s...\n             │    │       └ <pandas.io.sql.SQLTable object at 0x000002128F5DACC0>\n             │    └ <function Connection.execute at 0x000002128E9CD440>\n             └ <sqlalchemy.engine.base.Connection object at 0x000002128DF91DC0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x000002128F6128A0>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           │          └ <function Connection._execute_clauseelement at 0x000002128E9CD760>\n           └ <sqlalchemy.engine.base.Connection object at 0x000002128DF91DC0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          │    └ <function Connection._execute_context at 0x000002128E9CD940>\n          └ <sqlalchemy.engine.base.Connection object at 0x000002128DF91DC0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1844, in _execute_context\n    return self._exec_insertmany_context(dialect, context)\n           │    │                        │        └ <sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x000002128F612960>\n           │    │                        └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000002128EA92E40>\n           │    └ <function Connection._exec_insertmany_context at 0x000002128E9CDA80>\n           └ <sqlalchemy.engine.base.Connection object at 0x000002128DF91DC0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2124, in _exec_insertmany_context\n    self._handle_dbapi_exception(\n    │    └ <function Connection._handle_dbapi_exception at 0x000002128E9CDC60>\n    └ <sqlalchemy.engine.base.Connection object at 0x000002128DF91DC0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2353, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n          │                    │              │                 └ ProgrammingError(\"can't adapt type 'dict'\")\n          │                    │              └ (<class 'psycopg2.ProgrammingError'>, ProgrammingError(\"can't adapt type 'dict'\"), <traceback object at 0x000002128F523F40>)\n          │                    └ <method 'with_traceback' of 'BaseException' objects>\n          └ ProgrammingError(\"(psycopg2.ProgrammingError) can't adapt type 'dict'\")\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x000002128EA84C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000002128EA92E40>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'snippet_responsibility__0': 'Писать стабильный, поддерживаемый код, в соответствии с ТЗ. Вместе с командой проектировать ар...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000002128F60CD60; closed: -1>\n\nsqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 749629 characters truncated ... 2)s, %(employment__972)s, %(adv_response_url__972)s, %(is_adv_vacancy__972)s, %(vacancy_hash__972)s)]\n[parameters: {'snippet_responsibility__0': 'Писать стабильный, поддерживаемый код, в соответствии с ТЗ. Вместе с командой проектировать архитектуру приложений и выбирать технологии. Разработка функционала для...', 'response_letter_required__0': False, 'accept_incomplete_resumes__0': False, 'premium__0': False, 'salary_to__0': None, 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=103992155', 'sort_point_distance__0': None, 'salary_from__0': 50000.0, 'employment__0': 'Полная занятость', 'vacancy_id__0': '103992155', 'area__0': 'Москва', 'url__0': 'https://api.hh.ru/vacancies/103992155?host=hh.ru', 'name__0': 'Junior Python Разработчик', 'contacts__0': None, 'show_logo_in_search__0': None, 'department__0': None, 'employer_name__0': 'О-комплекс', 'professional_roles__0': 'Программист, разработчик', 'archived__0': False, 'response_url__0': None, 'published_at__0': '2024-07-16T13:15:10+0300', 'snippet_requirement__0': 'Решать задачи на <highlighttext>Python</highlighttext> и разрабатывать сайты при помощи фреймворка Django. Работа с базами данных с ипользованием PostgreSQL (+архитектура). ', 'adv_response_url__0': None, 'alternate_url__0': 'https://hh.ru/vacancy/103992155', 'schedule__0': 'Удаленная работа', 'created_at__0': '2024-07-16T13:15:10+0300', 'vacancy_hash__0': '0fe1b4962066bddca65c231c79b5f806886646de67c420817c8d0e4fc40411ee', 'experience__0': 'От 1 года до 3 лет', 'type__0': 'Открытая', 'has_test__0': False, 'is_adv_vacancy__0': False, 'employer_url__0': 'https://api.hh.ru/employers/5454644', 'accept_temporary__0': False, 'snippet_responsibility__1': 'Продукт: разработка проектов для Telegram miniApps. В основном разработка веб приложений и интеграция с платежными системами, в том числе на...', 'response_letter_required__1': False, 'accept_incomplete_resumes__1': False, 'premium__1': False, 'salary_to__1': 300000.0, 'apply_alternate_url__1': 'https://hh.ru/applicant/vacancy_response?vacancyId=104018898', 'sort_point_distance__1': None, 'salary_from__1': 60000.0, 'employment__1': 'Полная занятость', 'vacancy_id__1': '104018898', 'area__1': 'Москва', 'url__1': 'https://api.hh.ru/vacancies/104018898?host=hh.ru', 'name__1': 'Программист', 'contacts__1': None, 'show_logo_in_search__1': None, 'department__1': None, 'employer_name__1': 'Profitmarcet' ... 32009 parameters truncated ... 'employer_name__971': 'NAUMEN', 'professional_roles__971': 'Программист, разработчик', 'archived__971': False, 'response_url__971': None, 'published_at__971': '2024-07-15T09:57:27+0300', 'snippet_requirement__971': 'Понимание принципов и проблем многопоточного программирования. Опыт разработки клиент-серверных приложений. Будет плюсом: Опыт разработки на <highlighttext>Python</highlighttext>. Высшее профильное образование.', 'adv_response_url__971': None, 'alternate_url__971': 'https://hh.ru/vacancy/101279533', 'schedule__971': 'Удаленная работа', 'created_at__971': '2024-07-15T09:57:27+0300', 'vacancy_hash__971': '2adaa4587d4f3a9f951eddb4e9a4d4e51807a43920862499892b905f697a9920', 'experience__971': 'От 3 до 6 лет', 'type__971': 'Открытая', 'has_test__971': False, 'is_adv_vacancy__971': False, 'employer_url__971': 'https://api.hh.ru/employers/42600', 'accept_temporary__971': False, 'snippet_responsibility__972': 'Планирование этапности перевода функциональности в соответствии с принципами сохранения целостности ведения бизнес-процессов в системе. Формализация требований для <highlighttext>разработчиков</highlighttext>. ', 'response_letter_required__972': False, 'accept_incomplete_resumes__972': False, 'premium__972': False, 'salary_to__972': None, 'apply_alternate_url__972': 'https://hh.ru/applicant/vacancy_response?vacancyId=102794788', 'sort_point_distance__972': None, 'salary_from__972': None, 'employment__972': 'Полная занятость', 'vacancy_id__972': '102794788', 'area__972': 'Екатеринбург', 'url__972': 'https://api.hh.ru/vacancies/102794788?host=hh.ru', 'name__972': 'Аналитик 1С (УТ, ERP)', 'contacts__972': None, 'show_logo_in_search__972': None, 'department__972': None, 'employer_name__972': 'Ракета', 'professional_roles__972': 'Системный аналитик', 'archived__972': False, 'response_url__972': None, 'published_at__972': '2024-07-14T17:27:46+0300', 'snippet_requirement__972': 'Опыт работы с 1С системами в роли аналитика от 3х лет. Опыт работы с УТ в роли аналитика...', 'adv_response_url__972': None, 'alternate_url__972': 'https://hh.ru/vacancy/102794788', 'schedule__972': 'Удаленная работа', 'created_at__972': '2024-07-14T17:27:46+0300', 'vacancy_hash__972': '695cea8f888792744354dac813fd83911d3dc5cccf6412a9dc706df53e7ef38a', 'experience__972': 'От 3 до 6 лет', 'type__972': 'Открытая', 'has_test__972': False, 'is_adv_vacancy__972': False, 'employer_url__972': 'https://api.hh.ru/employers/2501342', 'accept_temporary__972': False}]\n(Background on this error at: https://sqlalche.me/e/20/f405)\n", "record": {"elapsed": {"repr": "0:00:24.392165", "seconds": 24.392165}, "exception": {"type": "ProgrammingError", "value": "(psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 749629 characters truncated ... 2)s, %(employment__972)s, %(adv_response_url__972)s, %(is_adv_vacancy__972)s, %(vacancy_hash__972)s)]\n[parameters: {'snippet_responsibility__0': 'Писать стабильный, поддерживаемый код, в соответствии с ТЗ. Вместе с командой проектировать архитектуру приложений и выбирать технологии. Разработка функционала для...', 'response_letter_required__0': False, 'accept_incomplete_resumes__0': False, 'premium__0': False, 'salary_to__0': None, 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=103992155', 'sort_point_distance__0': None, 'salary_from__0': 50000.0, 'employment__0': 'Полная занятость', 'vacancy_id__0': '103992155', 'area__0': 'Москва', 'url__0': 'https://api.hh.ru/vacancies/103992155?host=hh.ru', 'name__0': 'Junior Python Разработчик', 'contacts__0': None, 'show_logo_in_search__0': None, 'department__0': None, 'employer_name__0': 'О-комплекс', 'professional_roles__0': 'Программист, разработчик', 'archived__0': False, 'response_url__0': None, 'published_at__0': '2024-07-16T13:15:10+0300', 'snippet_requirement__0': 'Решать задачи на <highlighttext>Python</highlighttext> и разрабатывать сайты при помощи фреймворка Django. Работа с базами данных с ипользованием PostgreSQL (+архитектура). ', 'adv_response_url__0': None, 'alternate_url__0': 'https://hh.ru/vacancy/103992155', 'schedule__0': 'Удаленная работа', 'created_at__0': '2024-07-16T13:15:10+0300', 'vacancy_hash__0': '0fe1b4962066bddca65c231c79b5f806886646de67c420817c8d0e4fc40411ee', 'experience__0': 'От 1 года до 3 лет', 'type__0': 'Открытая', 'has_test__0': False, 'is_adv_vacancy__0': False, 'employer_url__0': 'https://api.hh.ru/employers/5454644', 'accept_temporary__0': False, 'snippet_responsibility__1': 'Продукт: разработка проектов для Telegram miniApps. В основном разработка веб приложений и интеграция с платежными системами, в том числе на...', 'response_letter_required__1': False, 'accept_incomplete_resumes__1': False, 'premium__1': False, 'salary_to__1': 300000.0, 'apply_alternate_url__1': 'https://hh.ru/applicant/vacancy_response?vacancyId=104018898', 'sort_point_distance__1': None, 'salary_from__1': 60000.0, 'employment__1': 'Полная занятость', 'vacancy_id__1': '104018898', 'area__1': 'Москва', 'url__1': 'https://api.hh.ru/vacancies/104018898?host=hh.ru', 'name__1': 'Программист', 'contacts__1': None, 'show_logo_in_search__1': None, 'department__1': None, 'employer_name__1': 'Profitmarcet' ... 32009 parameters truncated ... 'employer_name__971': 'NAUMEN', 'professional_roles__971': 'Программист, разработчик', 'archived__971': False, 'response_url__971': None, 'published_at__971': '2024-07-15T09:57:27+0300', 'snippet_requirement__971': 'Понимание принципов и проблем многопоточного программирования. Опыт разработки клиент-серверных приложений. Будет плюсом: Опыт разработки на <highlighttext>Python</highlighttext>. Высшее профильное образование.', 'adv_response_url__971': None, 'alternate_url__971': 'https://hh.ru/vacancy/101279533', 'schedule__971': 'Удаленная работа', 'created_at__971': '2024-07-15T09:57:27+0300', 'vacancy_hash__971': '2adaa4587d4f3a9f951eddb4e9a4d4e51807a43920862499892b905f697a9920', 'experience__971': 'От 3 до 6 лет', 'type__971': 'Открытая', 'has_test__971': False, 'is_adv_vacancy__971': False, 'employer_url__971': 'https://api.hh.ru/employers/42600', 'accept_temporary__971': False, 'snippet_responsibility__972': 'Планирование этапности перевода функциональности в соответствии с принципами сохранения целостности ведения бизнес-процессов в системе. Формализация требований для <highlighttext>разработчиков</highlighttext>. ', 'response_letter_required__972': False, 'accept_incomplete_resumes__972': False, 'premium__972': False, 'salary_to__972': None, 'apply_alternate_url__972': 'https://hh.ru/applicant/vacancy_response?vacancyId=102794788', 'sort_point_distance__972': None, 'salary_from__972': None, 'employment__972': 'Полная занятость', 'vacancy_id__972': '102794788', 'area__972': 'Екатеринбург', 'url__972': 'https://api.hh.ru/vacancies/102794788?host=hh.ru', 'name__972': 'Аналитик 1С (УТ, ERP)', 'contacts__972': None, 'show_logo_in_search__972': None, 'department__972': None, 'employer_name__972': 'Ракета', 'professional_roles__972': 'Системный аналитик', 'archived__972': False, 'response_url__972': None, 'published_at__972': '2024-07-14T17:27:46+0300', 'snippet_requirement__972': 'Опыт работы с 1С системами в роли аналитика от 3х лет. Опыт работы с УТ в роли аналитика...', 'adv_response_url__972': None, 'alternate_url__972': 'https://hh.ru/vacancy/102794788', 'schedule__972': 'Удаленная работа', 'created_at__972': '2024-07-14T17:27:46+0300', 'vacancy_hash__972': '695cea8f888792744354dac813fd83911d3dc5cccf6412a9dc706df53e7ef38a', 'experience__972': 'От 3 до 6 лет', 'type__972': 'Открытая', 'has_test__972': False, 'is_adv_vacancy__972': False, 'employer_url__972': 'https://api.hh.ru/employers/2501342', 'accept_temporary__972': False}]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 175, "message": "An error has been caught in function '<module>', process 'MainProcess' (10956), thread 'MainThread' (6740):", "module": "main", "name": "__main__", "process": {"id": 10956, "name": "MainProcess"}, "thread": {"id": 6740, "name": "MainThread"}, "time": {"repr": "2024-07-17 12:43:43.426102+03:00", "timestamp": 1721209423.426102}}}
{"text": "2024-07-17T12:57:53.789090+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (12564), thread 'MainThread' (7364):\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 176, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '103992155', 'premium': False, 'name': 'Junior Python Разработчик', 'department': None, 'has_test': False, 'response_...\n    └ <function save_to_db at 0x000001CE1E290900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 129, in save_to_db\n    \"working_days\": v.get('working_days')[0][\"name\"] if v.get('working_days') is not [] else None,\n\nIndexError: list index out of range\n", "record": {"elapsed": {"repr": "0:00:23.903729", "seconds": 23.903729}, "exception": {"type": "IndexError", "value": "list index out of range", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 176, "message": "An error has been caught in function '<module>', process 'MainProcess' (12564), thread 'MainThread' (7364):", "module": "main", "name": "__main__", "process": {"id": 12564, "name": "MainProcess"}, "thread": {"id": 7364, "name": "MainThread"}, "time": {"repr": "2024-07-17 12:57:53.789090+03:00", "timestamp": 1721210273.78909}}}
{"text": "2024-07-17T13:01:02.240590+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (15204), thread 'MainThread' (6708):\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 176, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '103992155', 'premium': False, 'name': 'Junior Python Разработчик', 'department': None, 'has_test': False, 'response_...\n    └ <function save_to_db at 0x000002106B060900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 130, in save_to_db\n    \"working_time_intervals\": v.get('working_time_intervals')[0][\"name\"] if v.get('working_days') is not [] else None,\n\nIndexError: list index out of range\n", "record": {"elapsed": {"repr": "0:00:23.860887", "seconds": 23.860887}, "exception": {"type": "IndexError", "value": "list index out of range", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 176, "message": "An error has been caught in function '<module>', process 'MainProcess' (15204), thread 'MainThread' (6708):", "module": "main", "name": "__main__", "process": {"id": 15204, "name": "MainProcess"}, "thread": {"id": 6708, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:01:02.240590+03:00", "timestamp": 1721210462.24059}}}
{"text": "2024-07-17T13:02:21.936907+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (3100), thread 'MainThread' (8772):\nTraceback (most recent call last):\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x0000025896C74C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x0000025897549E50>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'premium__0': False, 'response_url__0': None, 'experience__0': 'От 1 года до 3 лет', 'employer_name__0': 'О-комплекс', 'empl...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x0000025897800D60; closed: -1>\n\npsycopg2.ProgrammingError: can't adapt type 'dict'\n\n\nThe above exception was the direct cause of the following exception:\n\n\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 176, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '103992155', 'premium': False, 'name': 'Junior Python Разработчик', 'department': None, 'has_test': False, 'response_...\n    └ <function save_to_db at 0x0000025896D00900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 149, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False)\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x0000025894C0D4E0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    103992155  ...  0fe1b4962066bddca65c231c79b5f8068...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False}\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    103992155  ...  0fe1b4962066bddca65c231c79b5f806...\n           └ <function NDFrame.to_sql at 0x0000025894C0D3A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x0000025895F71620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x0000025895F731A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x0000025894C97920>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2018, in to_sql\n    total_inserted = sql_engine.insert_records(\n                     │          └ <function SQLAlchemyEngine.insert_records at 0x0000025895F72980>\n                     └ <pandas.io.sql.SQLAlchemyEngine object at 0x00000258977C6EA0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1567, in insert_records\n    raise err\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1558, in insert_records\n    return table.insert(chunksize=chunksize, method=method)\n           │     │                │                 └ None\n           │     │                └ None\n           │     └ <function SQLTable.insert at 0x0000025895F71DA0>\n           └ <pandas.io.sql.SQLTable object at 0x00000258977C6E10>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1119, in insert\n    num_inserted = exec_insert(conn, keys, chunk_iter)\n                   │           │     │     └ <zip object at 0x0000025897811140>\n                   │           │     └ ['vacancy_id', 'premium', 'name', 'department', 'has_test', 'response_letter_required', 'area', 'salary_from', 'salary_to', '...\n                   │           └ <sqlalchemy.engine.base.Connection object at 0x0000025896CF8A70>\n                   └ <bound method SQLTable._execute_insert of <pandas.io.sql.SQLTable object at 0x00000258977C6E10>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1010, in _execute_insert\n    result = conn.execute(self.table.insert(), data)\n             │    │       │    │     │         └ [{'vacancy_id': '103992155', 'premium': False, 'name': 'Junior Python Разработчик', 'department': None, 'has_test': False, 'r...\n             │    │       │    │     └ <function TableClause.insert at 0x0000025896AD5300>\n             │    │       │    └ Table('stage_pars_hh', MetaData(), Column('vacancy_id', Text(), table=<stage_pars_hh>), Column('premium', Boolean(), table=<s...\n             │    │       └ <pandas.io.sql.SQLTable object at 0x00000258977C6E10>\n             │    └ <function Connection.execute at 0x0000025896BB9440>\n             └ <sqlalchemy.engine.base.Connection object at 0x0000025896CF8A70>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x00000258977FF260>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           │          └ <function Connection._execute_clauseelement at 0x0000025896BB9760>\n           └ <sqlalchemy.engine.base.Connection object at 0x0000025896CF8A70>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          │    └ <function Connection._execute_context at 0x0000025896BB9940>\n          └ <sqlalchemy.engine.base.Connection object at 0x0000025896CF8A70>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1844, in _execute_context\n    return self._exec_insertmany_context(dialect, context)\n           │    │                        │        └ <sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x00000258977FF380>\n           │    │                        └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x0000025897549E50>\n           │    └ <function Connection._exec_insertmany_context at 0x0000025896BB9A80>\n           └ <sqlalchemy.engine.base.Connection object at 0x0000025896CF8A70>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2124, in _exec_insertmany_context\n    self._handle_dbapi_exception(\n    │    └ <function Connection._handle_dbapi_exception at 0x0000025896BB9C60>\n    └ <sqlalchemy.engine.base.Connection object at 0x0000025896CF8A70>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2353, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n          │                    │              │                 └ ProgrammingError(\"can't adapt type 'dict'\")\n          │                    │              └ (<class 'psycopg2.ProgrammingError'>, ProgrammingError(\"can't adapt type 'dict'\"), <traceback object at 0x000002589766BA00>)\n          │                    └ <method 'with_traceback' of 'BaseException' objects>\n          └ ProgrammingError(\"(psycopg2.ProgrammingError) can't adapt type 'dict'\")\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x0000025896C74C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x0000025897549E50>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'premium__0': False, 'response_url__0': None, 'experience__0': 'От 1 года до 3 лет', 'employer_name__0': 'О-комплекс', 'empl...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x0000025897800D60; closed: -1>\n\nsqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 771968 characters truncated ... %(accept_incomplete_resumes__960)s, %(experience__960)s, %(employment__960)s, %(vacancy_hash__960)s)]\n[parameters: {'premium__0': False, 'response_url__0': None, 'experience__0': 'От 1 года до 3 лет', 'employer_name__0': 'О-комплекс', 'employer_url__0': 'https://api.hh.ru/employers/5454644', 'url__0': 'https://api.hh.ru/vacancies/103992155?host=hh.ru', 'response_letter_required__0': False, 'snippet_responsibility__0': 'Писать стабильный, поддерживаемый код, в соответствии с ТЗ. Вместе с командой проектировать архитектуру приложений и выбирать технологии. Разработка функционала для...', 'name__0': 'Junior Python Разработчик', 'alternate_url__0': 'https://hh.ru/vacancy/103992155', 'type__0': 'Открытая', 'employment__0': 'Полная занятость', 'vacancy_id__0': '103992155', 'department__0': None, 'accept_incomplete_resumes__0': False, 'has_test__0': False, 'salary_to__0': None, 'published_at__0': '2024-07-16T13:15:10+0300', 'archived__0': False, 'created_at__0': '2024-07-16T13:15:10+0300', 'snippet_requirement__0': 'Решать задачи на <highlighttext>Python</highlighttext> и разрабатывать сайты при помощи фреймворка Django. Работа с базами данных с ипользованием PostgreSQL (+архитектура). ', 'salary_from__0': 50000.0, 'accept_temporary__0': False, 'working_time_modes__0': None, 'show_logo_in_search__0': None, 'contacts__0': None, 'schedule__0': 'Удаленная работа', 'vacancy_hash__0': '0fe1b4962066bddca65c231c79b5f806886646de67c420817c8d0e4fc40411ee', 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=103992155', 'working_time_intervals__0': None, 'working_days__0': None, 'area__0': 'Москва', 'sort_point_distance__0': None, 'professional_roles__0': 'Программист, разработчик', 'premium__1': False, 'response_url__1': None, 'experience__1': 'Нет опыта', 'employer_name__1': 'ТЭМП', 'employer_url__1': 'https://api.hh.ru/employers/3486217', 'url__1': 'https://api.hh.ru/vacancies/104008693?host=hh.ru', 'response_letter_required__1': False, 'snippet_responsibility__1': 'Помогать клиентам в оперативной настройке работы сервисов. Предоставлять обратную связь менеджерам и <highlighttext>разработчикам</highlighttext> для устранения неполадок. Выполнять поставленные цели и...', 'name__1': 'Удаленный менеджер (срочно, возможна подработка)', 'alternate_url__1': 'https://hh.ru/vacancy/104008693', 'type__1': 'Открытая', 'employment__1': 'Частичная занятость', 'vacancy_id__1': '104008693', 'department__1': None, 'accept_incomplete_resumes__1': True, 'has_test__1': False ... 32574 parameters truncated ... 'archived__959': False, 'created_at__959': '2024-06-28T12:34:21+0300', 'snippet_requirement__959': 'Уверенное знание языка программирования <highlighttext>Python</highlighttext>. Уверенные знания баз данных (преимущественно MySQL, основы postgresql). Понимание стека веб технологий (Html, JS, CSS). ', 'salary_from__959': None, 'accept_temporary__959': False, 'working_time_modes__959': None, 'show_logo_in_search__959': None, 'contacts__959': None, 'schedule__959': 'Удаленная работа', 'vacancy_hash__959': '014664947280b460c9368939562464fc014ec92600190e3cc655ceaa6b83cf65', 'apply_alternate_url__959': 'https://hh.ru/applicant/vacancy_response?vacancyId=99545689', 'working_time_intervals__959': None, 'working_days__959': None, 'area__959': 'Екатеринбург', 'sort_point_distance__959': None, 'professional_roles__959': 'Программист, разработчик', 'premium__960': False, 'response_url__960': None, 'experience__960': 'От 1 года до 3 лет', 'employer_name__960': 'СДЭК', 'employer_url__960': 'https://api.hh.ru/employers/2526975', 'url__960': 'https://api.hh.ru/vacancies/103012774?host=hh.ru', 'response_letter_required__960': False, 'snippet_responsibility__960': 'Сопровождать Битрикс24 - осуществлять поддержку сотрудников, следить за актуальностью и работоспособностью внутренних процессов. Брать на себя техническую реализацию воронок с...', 'name__960': 'CRM-маркетолог/Администратор CRM/junior-разработчик', 'alternate_url__960': 'https://hh.ru/vacancy/103012774', 'type__960': 'Открытая', 'employment__960': 'Полная занятость', 'vacancy_id__960': '103012774', 'department__960': None, 'accept_incomplete_resumes__960': False, 'has_test__960': False, 'salary_to__960': None, 'published_at__960': '2024-07-01T07:56:53+0300', 'archived__960': False, 'created_at__960': '2024-07-01T07:56:53+0300', 'snippet_requirement__960': 'Мы готовы рассмотреть кандидатов с релевантным опытом на одной из трех позиций: CRM-маркетолог, Администратор CRM или junior-<highlighttext>разработчик</highlighttext>.', 'salary_from__960': 50000.0, 'accept_temporary__960': False, 'working_time_modes__960': None, 'show_logo_in_search__960': None, 'contacts__960': None, 'schedule__960': 'Удаленная работа', 'vacancy_hash__960': 'a61b008dad55593a7420f9db326f124c97d948fbdfe9d7249a3570fd1fb58ebf', 'apply_alternate_url__960': 'https://hh.ru/applicant/vacancy_response?vacancyId=103012774', 'working_time_intervals__960': None, 'working_days__960': None, 'area__960': 'Екатеринбург', 'sort_point_distance__960': None, 'professional_roles__960': 'Менеджер по маркетингу, интернет-маркетолог'}]\n(Background on this error at: https://sqlalche.me/e/20/f405)\n", "record": {"elapsed": {"repr": "0:00:24.395857", "seconds": 24.395857}, "exception": {"type": "ProgrammingError", "value": "(psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 771968 characters truncated ... %(accept_incomplete_resumes__960)s, %(experience__960)s, %(employment__960)s, %(vacancy_hash__960)s)]\n[parameters: {'premium__0': False, 'response_url__0': None, 'experience__0': 'От 1 года до 3 лет', 'employer_name__0': 'О-комплекс', 'employer_url__0': 'https://api.hh.ru/employers/5454644', 'url__0': 'https://api.hh.ru/vacancies/103992155?host=hh.ru', 'response_letter_required__0': False, 'snippet_responsibility__0': 'Писать стабильный, поддерживаемый код, в соответствии с ТЗ. Вместе с командой проектировать архитектуру приложений и выбирать технологии. Разработка функционала для...', 'name__0': 'Junior Python Разработчик', 'alternate_url__0': 'https://hh.ru/vacancy/103992155', 'type__0': 'Открытая', 'employment__0': 'Полная занятость', 'vacancy_id__0': '103992155', 'department__0': None, 'accept_incomplete_resumes__0': False, 'has_test__0': False, 'salary_to__0': None, 'published_at__0': '2024-07-16T13:15:10+0300', 'archived__0': False, 'created_at__0': '2024-07-16T13:15:10+0300', 'snippet_requirement__0': 'Решать задачи на <highlighttext>Python</highlighttext> и разрабатывать сайты при помощи фреймворка Django. Работа с базами данных с ипользованием PostgreSQL (+архитектура). ', 'salary_from__0': 50000.0, 'accept_temporary__0': False, 'working_time_modes__0': None, 'show_logo_in_search__0': None, 'contacts__0': None, 'schedule__0': 'Удаленная работа', 'vacancy_hash__0': '0fe1b4962066bddca65c231c79b5f806886646de67c420817c8d0e4fc40411ee', 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=103992155', 'working_time_intervals__0': None, 'working_days__0': None, 'area__0': 'Москва', 'sort_point_distance__0': None, 'professional_roles__0': 'Программист, разработчик', 'premium__1': False, 'response_url__1': None, 'experience__1': 'Нет опыта', 'employer_name__1': 'ТЭМП', 'employer_url__1': 'https://api.hh.ru/employers/3486217', 'url__1': 'https://api.hh.ru/vacancies/104008693?host=hh.ru', 'response_letter_required__1': False, 'snippet_responsibility__1': 'Помогать клиентам в оперативной настройке работы сервисов. Предоставлять обратную связь менеджерам и <highlighttext>разработчикам</highlighttext> для устранения неполадок. Выполнять поставленные цели и...', 'name__1': 'Удаленный менеджер (срочно, возможна подработка)', 'alternate_url__1': 'https://hh.ru/vacancy/104008693', 'type__1': 'Открытая', 'employment__1': 'Частичная занятость', 'vacancy_id__1': '104008693', 'department__1': None, 'accept_incomplete_resumes__1': True, 'has_test__1': False ... 32574 parameters truncated ... 'archived__959': False, 'created_at__959': '2024-06-28T12:34:21+0300', 'snippet_requirement__959': 'Уверенное знание языка программирования <highlighttext>Python</highlighttext>. Уверенные знания баз данных (преимущественно MySQL, основы postgresql). Понимание стека веб технологий (Html, JS, CSS). ', 'salary_from__959': None, 'accept_temporary__959': False, 'working_time_modes__959': None, 'show_logo_in_search__959': None, 'contacts__959': None, 'schedule__959': 'Удаленная работа', 'vacancy_hash__959': '014664947280b460c9368939562464fc014ec92600190e3cc655ceaa6b83cf65', 'apply_alternate_url__959': 'https://hh.ru/applicant/vacancy_response?vacancyId=99545689', 'working_time_intervals__959': None, 'working_days__959': None, 'area__959': 'Екатеринбург', 'sort_point_distance__959': None, 'professional_roles__959': 'Программист, разработчик', 'premium__960': False, 'response_url__960': None, 'experience__960': 'От 1 года до 3 лет', 'employer_name__960': 'СДЭК', 'employer_url__960': 'https://api.hh.ru/employers/2526975', 'url__960': 'https://api.hh.ru/vacancies/103012774?host=hh.ru', 'response_letter_required__960': False, 'snippet_responsibility__960': 'Сопровождать Битрикс24 - осуществлять поддержку сотрудников, следить за актуальностью и работоспособностью внутренних процессов. Брать на себя техническую реализацию воронок с...', 'name__960': 'CRM-маркетолог/Администратор CRM/junior-разработчик', 'alternate_url__960': 'https://hh.ru/vacancy/103012774', 'type__960': 'Открытая', 'employment__960': 'Полная занятость', 'vacancy_id__960': '103012774', 'department__960': None, 'accept_incomplete_resumes__960': False, 'has_test__960': False, 'salary_to__960': None, 'published_at__960': '2024-07-01T07:56:53+0300', 'archived__960': False, 'created_at__960': '2024-07-01T07:56:53+0300', 'snippet_requirement__960': 'Мы готовы рассмотреть кандидатов с релевантным опытом на одной из трех позиций: CRM-маркетолог, Администратор CRM или junior-<highlighttext>разработчик</highlighttext>.', 'salary_from__960': 50000.0, 'accept_temporary__960': False, 'working_time_modes__960': None, 'show_logo_in_search__960': None, 'contacts__960': None, 'schedule__960': 'Удаленная работа', 'vacancy_hash__960': 'a61b008dad55593a7420f9db326f124c97d948fbdfe9d7249a3570fd1fb58ebf', 'apply_alternate_url__960': 'https://hh.ru/applicant/vacancy_response?vacancyId=103012774', 'working_time_intervals__960': None, 'working_days__960': None, 'area__960': 'Екатеринбург', 'sort_point_distance__960': None, 'professional_roles__960': 'Менеджер по маркетингу, интернет-маркетолог'}]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 176, "message": "An error has been caught in function '<module>', process 'MainProcess' (3100), thread 'MainThread' (8772):", "module": "main", "name": "__main__", "process": {"id": 3100, "name": "MainProcess"}, "thread": {"id": 8772, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:02:21.936907+03:00", "timestamp": 1721210541.936907}}}
{"text": "2024-07-17T13:08:38.650405+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (9120), thread 'MainThread' (12180):\nTraceback (most recent call last):\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x000001C660B44C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001C661592E40>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'working_time_modes__0': None, 'created_at__0': '2024-07-16T13:15:10+0300', 'apply_alternate_url__0': 'https://hh.ru/applica...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000001C6616D0D60; closed: -1>\n\npsycopg2.ProgrammingError: can't adapt type 'dict'\n\n\nThe above exception was the direct cause of the following exception:\n\n\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 177, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '103992155', 'premium': False, 'name': 'Junior Python Разработчик', 'department': None, 'has_test': False, 'response_...\n    └ <function save_to_db at 0x000001C660BD0900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 149, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False)\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x000001C65EB4D4E0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    103992155  ...  0fe1b4962066bddca65c231c79b5f8068...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False}\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    103992155  ...  0fe1b4962066bddca65c231c79b5f806...\n           └ <function NDFrame.to_sql at 0x000001C65EB4D3A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x000001C65FEB1620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x000001C65FEB31A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x000001C66150BD40>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2018, in to_sql\n    total_inserted = sql_engine.insert_records(\n                     │          └ <function SQLAlchemyEngine.insert_records at 0x000001C65FEB2980>\n                     └ <pandas.io.sql.SQLAlchemyEngine object at 0x000001C661696B70>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1567, in insert_records\n    raise err\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1558, in insert_records\n    return table.insert(chunksize=chunksize, method=method)\n           │     │                │                 └ None\n           │     │                └ None\n           │     └ <function SQLTable.insert at 0x000001C65FEB1DA0>\n           └ <pandas.io.sql.SQLTable object at 0x000001C661696810>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1119, in insert\n    num_inserted = exec_insert(conn, keys, chunk_iter)\n                   │           │     │     └ <zip object at 0x000001C6616DC780>\n                   │           │     └ ['vacancy_id', 'premium', 'name', 'department', 'has_test', 'response_letter_required', 'area', 'salary_from', 'salary_to', '...\n                   │           └ <sqlalchemy.engine.base.Connection object at 0x000001C66149D1F0>\n                   └ <bound method SQLTable._execute_insert of <pandas.io.sql.SQLTable object at 0x000001C661696810>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1010, in _execute_insert\n    result = conn.execute(self.table.insert(), data)\n             │    │       │    │     │         └ [{'vacancy_id': '103992155', 'premium': False, 'name': 'Junior Python Разработчик', 'department': None, 'has_test': False, 'r...\n             │    │       │    │     └ <function TableClause.insert at 0x000001C6609A5300>\n             │    │       │    └ Table('stage_pars_hh', MetaData(), Column('vacancy_id', Text(), table=<stage_pars_hh>), Column('premium', Boolean(), table=<s...\n             │    │       └ <pandas.io.sql.SQLTable object at 0x000001C661696810>\n             │    └ <function Connection.execute at 0x000001C660A8D440>\n             └ <sqlalchemy.engine.base.Connection object at 0x000001C66149D1F0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x000001C6616CB140>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           │          └ <function Connection._execute_clauseelement at 0x000001C660A8D760>\n           └ <sqlalchemy.engine.base.Connection object at 0x000001C66149D1F0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          │    └ <function Connection._execute_context at 0x000001C660A8D940>\n          └ <sqlalchemy.engine.base.Connection object at 0x000001C66149D1F0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1844, in _execute_context\n    return self._exec_insertmany_context(dialect, context)\n           │    │                        │        └ <sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x000001C6616CB200>\n           │    │                        └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001C661592E40>\n           │    └ <function Connection._exec_insertmany_context at 0x000001C660A8DA80>\n           └ <sqlalchemy.engine.base.Connection object at 0x000001C66149D1F0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2124, in _exec_insertmany_context\n    self._handle_dbapi_exception(\n    │    └ <function Connection._handle_dbapi_exception at 0x000001C660A8DC60>\n    └ <sqlalchemy.engine.base.Connection object at 0x000001C66149D1F0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2353, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n          │                    │              │                 └ ProgrammingError(\"can't adapt type 'dict'\")\n          │                    │              └ (<class 'psycopg2.ProgrammingError'>, ProgrammingError(\"can't adapt type 'dict'\"), <traceback object at 0x000001C6609F5200>)\n          │                    └ <method 'with_traceback' of 'BaseException' objects>\n          └ ProgrammingError(\"(psycopg2.ProgrammingError) can't adapt type 'dict'\")\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x000001C660B44C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001C661592E40>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'working_time_modes__0': None, 'created_at__0': '2024-07-16T13:15:10+0300', 'apply_alternate_url__0': 'https://hh.ru/applica...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000001C6616D0D60; closed: -1>\n\nsqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 771968 characters truncated ... %(accept_incomplete_resumes__960)s, %(experience__960)s, %(employment__960)s, %(vacancy_hash__960)s)]\n[parameters: {'working_time_modes__0': None, 'created_at__0': '2024-07-16T13:15:10+0300', 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=103992155', 'salary_from__0': 50000.0, 'type__0': 'Открытая', 'url__0': 'https://api.hh.ru/vacancies/103992155?host=hh.ru', 'working_time_intervals__0': None, 'alternate_url__0': 'https://hh.ru/vacancy/103992155', 'professional_roles__0': 'Программист, разработчик', 'employment__0': 'Полная занятость', 'contacts__0': None, 'area__0': 'Москва', 'response_url__0': None, 'archived__0': False, 'published_at__0': '2024-07-16T13:15:10+0300', 'sort_point_distance__0': None, 'snippet_requirement__0': 'Решать задачи на <highlighttext>Python</highlighttext> и разрабатывать сайты при помощи фреймворка Django. Работа с базами данных с ипользованием PostgreSQL (+архитектура). ', 'has_test__0': False, 'vacancy_id__0': '103992155', 'show_logo_in_search__0': None, 'department__0': None, 'accept_incomplete_resumes__0': False, 'response_letter_required__0': False, 'employer_name__0': 'О-комплекс', 'name__0': 'Junior Python Разработчик', 'vacancy_hash__0': '0fe1b4962066bddca65c231c79b5f806886646de67c420817c8d0e4fc40411ee', 'experience__0': 'От 1 года до 3 лет', 'premium__0': False, 'schedule__0': 'Удаленная работа', 'working_days__0': None, 'snippet_responsibility__0': 'Писать стабильный, поддерживаемый код, в соответствии с ТЗ. Вместе с командой проектировать архитектуру приложений и выбирать технологии. Разработка функционала для...', 'salary_to__0': None, 'accept_temporary__0': False, 'employer_url__0': 'https://api.hh.ru/employers/5454644', 'working_time_modes__1': 'Можно начинать работать после 16:00', 'created_at__1': '2024-07-16T16:12:17+0300', 'apply_alternate_url__1': 'https://hh.ru/applicant/vacancy_response?vacancyId=104008693', 'salary_from__1': 47990.0, 'type__1': 'Открытая', 'url__1': 'https://api.hh.ru/vacancies/104008693?host=hh.ru', 'working_time_intervals__1': 'Можно работать сменами по\\xa04–6 часов в\\xa0день', 'alternate_url__1': 'https://hh.ru/vacancy/104008693', 'professional_roles__1': 'Другое', 'employment__1': 'Частичная занятость', 'contacts__1': None, 'area__1': 'Москва', 'response_url__1': None, 'archived__1': False, 'published_at__1': '2024-07-16T16:12:17+0300', 'sort_point_distance__1': None ... 32574 parameters truncated ... 'vacancy_id__959': '103012774', 'show_logo_in_search__959': None, 'department__959': None, 'accept_incomplete_resumes__959': False, 'response_letter_required__959': False, 'employer_name__959': 'СДЭК', 'name__959': 'CRM-маркетолог/Администратор CRM/junior-разработчик', 'vacancy_hash__959': 'a61b008dad55593a7420f9db326f124c97d948fbdfe9d7249a3570fd1fb58ebf', 'experience__959': 'От 1 года до 3 лет', 'premium__959': False, 'schedule__959': 'Удаленная работа', 'working_days__959': None, 'snippet_responsibility__959': 'Сопровождать Битрикс24 - осуществлять поддержку сотрудников, следить за актуальностью и работоспособностью внутренних процессов. Брать на себя техническую реализацию воронок с...', 'salary_to__959': None, 'accept_temporary__959': False, 'employer_url__959': 'https://api.hh.ru/employers/2526975', 'working_time_modes__960': None, 'created_at__960': '2024-06-19T16:13:54+0300', 'apply_alternate_url__960': 'https://hh.ru/applicant/vacancy_response?vacancyId=97078971', 'salary_from__960': None, 'type__960': 'Открытая', 'url__960': 'https://api.hh.ru/vacancies/97078971?host=hh.ru', 'working_time_intervals__960': None, 'alternate_url__960': 'https://hh.ru/vacancy/97078971', 'professional_roles__960': 'Тестировщик', 'employment__960': 'Полная занятость', 'contacts__960': None, 'area__960': 'Екатеринбург', 'response_url__960': None, 'archived__960': False, 'published_at__960': '2024-06-19T16:13:54+0300', 'sort_point_distance__960': None, 'snippet_requirement__960': 'Знаете и понимаете теорию тестирования. Имеете опыт работы в автоматизации тестирования бэкэнд-систем не менее 2х лет. ', 'has_test__960': False, 'vacancy_id__960': '97078971', 'show_logo_in_search__960': True, 'department__960': None, 'accept_incomplete_resumes__960': False, 'response_letter_required__960': False, 'employer_name__960': 'Maxim technology', 'name__960': 'SDET/ QA Automation Engineer', 'vacancy_hash__960': '46c67b9ab745fb7b7aeb01cee24c60a95b4c42e4706f4d1aed75a984b894cfb0', 'experience__960': 'От 3 до 6 лет', 'premium__960': False, 'schedule__960': 'Удаленная работа', 'working_days__960': None, 'snippet_responsibility__960': 'Разрабатывать и поддерживать автоматизированные тесты для бэкэнд-систем на <highlighttext>Python</highlighttext> (pytest). Взаимодействовать с <highlighttext>разработчиками</highlighttext> и читать C# код (будет плюсом...', 'salary_to__960': None, 'accept_temporary__960': False, 'employer_url__960': 'https://api.hh.ru/employers/5425152'}]\n(Background on this error at: https://sqlalche.me/e/20/f405)\n", "record": {"elapsed": {"repr": "0:00:24.186416", "seconds": 24.186416}, "exception": {"type": "ProgrammingError", "value": "(psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 771968 characters truncated ... %(accept_incomplete_resumes__960)s, %(experience__960)s, %(employment__960)s, %(vacancy_hash__960)s)]\n[parameters: {'working_time_modes__0': None, 'created_at__0': '2024-07-16T13:15:10+0300', 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=103992155', 'salary_from__0': 50000.0, 'type__0': 'Открытая', 'url__0': 'https://api.hh.ru/vacancies/103992155?host=hh.ru', 'working_time_intervals__0': None, 'alternate_url__0': 'https://hh.ru/vacancy/103992155', 'professional_roles__0': 'Программист, разработчик', 'employment__0': 'Полная занятость', 'contacts__0': None, 'area__0': 'Москва', 'response_url__0': None, 'archived__0': False, 'published_at__0': '2024-07-16T13:15:10+0300', 'sort_point_distance__0': None, 'snippet_requirement__0': 'Решать задачи на <highlighttext>Python</highlighttext> и разрабатывать сайты при помощи фреймворка Django. Работа с базами данных с ипользованием PostgreSQL (+архитектура). ', 'has_test__0': False, 'vacancy_id__0': '103992155', 'show_logo_in_search__0': None, 'department__0': None, 'accept_incomplete_resumes__0': False, 'response_letter_required__0': False, 'employer_name__0': 'О-комплекс', 'name__0': 'Junior Python Разработчик', 'vacancy_hash__0': '0fe1b4962066bddca65c231c79b5f806886646de67c420817c8d0e4fc40411ee', 'experience__0': 'От 1 года до 3 лет', 'premium__0': False, 'schedule__0': 'Удаленная работа', 'working_days__0': None, 'snippet_responsibility__0': 'Писать стабильный, поддерживаемый код, в соответствии с ТЗ. Вместе с командой проектировать архитектуру приложений и выбирать технологии. Разработка функционала для...', 'salary_to__0': None, 'accept_temporary__0': False, 'employer_url__0': 'https://api.hh.ru/employers/5454644', 'working_time_modes__1': 'Можно начинать работать после 16:00', 'created_at__1': '2024-07-16T16:12:17+0300', 'apply_alternate_url__1': 'https://hh.ru/applicant/vacancy_response?vacancyId=104008693', 'salary_from__1': 47990.0, 'type__1': 'Открытая', 'url__1': 'https://api.hh.ru/vacancies/104008693?host=hh.ru', 'working_time_intervals__1': 'Можно работать сменами по\\xa04–6 часов в\\xa0день', 'alternate_url__1': 'https://hh.ru/vacancy/104008693', 'professional_roles__1': 'Другое', 'employment__1': 'Частичная занятость', 'contacts__1': None, 'area__1': 'Москва', 'response_url__1': None, 'archived__1': False, 'published_at__1': '2024-07-16T16:12:17+0300', 'sort_point_distance__1': None ... 32574 parameters truncated ... 'vacancy_id__959': '103012774', 'show_logo_in_search__959': None, 'department__959': None, 'accept_incomplete_resumes__959': False, 'response_letter_required__959': False, 'employer_name__959': 'СДЭК', 'name__959': 'CRM-маркетолог/Администратор CRM/junior-разработчик', 'vacancy_hash__959': 'a61b008dad55593a7420f9db326f124c97d948fbdfe9d7249a3570fd1fb58ebf', 'experience__959': 'От 1 года до 3 лет', 'premium__959': False, 'schedule__959': 'Удаленная работа', 'working_days__959': None, 'snippet_responsibility__959': 'Сопровождать Битрикс24 - осуществлять поддержку сотрудников, следить за актуальностью и работоспособностью внутренних процессов. Брать на себя техническую реализацию воронок с...', 'salary_to__959': None, 'accept_temporary__959': False, 'employer_url__959': 'https://api.hh.ru/employers/2526975', 'working_time_modes__960': None, 'created_at__960': '2024-06-19T16:13:54+0300', 'apply_alternate_url__960': 'https://hh.ru/applicant/vacancy_response?vacancyId=97078971', 'salary_from__960': None, 'type__960': 'Открытая', 'url__960': 'https://api.hh.ru/vacancies/97078971?host=hh.ru', 'working_time_intervals__960': None, 'alternate_url__960': 'https://hh.ru/vacancy/97078971', 'professional_roles__960': 'Тестировщик', 'employment__960': 'Полная занятость', 'contacts__960': None, 'area__960': 'Екатеринбург', 'response_url__960': None, 'archived__960': False, 'published_at__960': '2024-06-19T16:13:54+0300', 'sort_point_distance__960': None, 'snippet_requirement__960': 'Знаете и понимаете теорию тестирования. Имеете опыт работы в автоматизации тестирования бэкэнд-систем не менее 2х лет. ', 'has_test__960': False, 'vacancy_id__960': '97078971', 'show_logo_in_search__960': True, 'department__960': None, 'accept_incomplete_resumes__960': False, 'response_letter_required__960': False, 'employer_name__960': 'Maxim technology', 'name__960': 'SDET/ QA Automation Engineer', 'vacancy_hash__960': '46c67b9ab745fb7b7aeb01cee24c60a95b4c42e4706f4d1aed75a984b894cfb0', 'experience__960': 'От 3 до 6 лет', 'premium__960': False, 'schedule__960': 'Удаленная работа', 'working_days__960': None, 'snippet_responsibility__960': 'Разрабатывать и поддерживать автоматизированные тесты для бэкэнд-систем на <highlighttext>Python</highlighttext> (pytest). Взаимодействовать с <highlighttext>разработчиками</highlighttext> и читать C# код (будет плюсом...', 'salary_to__960': None, 'accept_temporary__960': False, 'employer_url__960': 'https://api.hh.ru/employers/5425152'}]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 177, "message": "An error has been caught in function '<module>', process 'MainProcess' (9120), thread 'MainThread' (12180):", "module": "main", "name": "__main__", "process": {"id": 9120, "name": "MainProcess"}, "thread": {"id": 12180, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:08:38.650405+03:00", "timestamp": 1721210918.650405}}}
{"text": "2024-07-17T13:13:18.524158+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (5760), thread 'MainThread' (8168):\nTraceback (most recent call last):\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x00000219B0A54C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x00000219B1325730>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'alternate_url__0': 'https://hh.ru/vacancy/103992155', 'snippet_requirement__0': 'Решать задачи на <highlighttext>Python</hi...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x00000219B15D90E0; closed: -1>\n\npsycopg2.ProgrammingError: can't adapt type 'dict'\n\n\nThe above exception was the direct cause of the following exception:\n\n\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 179, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '103992155', 'premium': False, 'name': 'Junior Python Разработчик', 'department': None, 'has_test': False, 'response_...\n    └ <function save_to_db at 0x00000219B0AE0900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 151, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False)\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x00000219AEA4D4E0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    103992155  ...  0fe1b4962066bddca65c231c79b5f8068...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False}\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    103992155  ...  0fe1b4962066bddca65c231c79b5f806...\n           └ <function NDFrame.to_sql at 0x00000219AEA4D3A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x00000219AFDB1620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x00000219AFDB31A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x00000219B1556600>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2018, in to_sql\n    total_inserted = sql_engine.insert_records(\n                     │          └ <function SQLAlchemyEngine.insert_records at 0x00000219AFDB2980>\n                     └ <pandas.io.sql.SQLAlchemyEngine object at 0x00000219B15AA8A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1567, in insert_records\n    raise err\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1558, in insert_records\n    return table.insert(chunksize=chunksize, method=method)\n           │     │                │                 └ None\n           │     │                └ None\n           │     └ <function SQLTable.insert at 0x00000219AFDB1DA0>\n           └ <pandas.io.sql.SQLTable object at 0x00000219B15AA9C0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1119, in insert\n    num_inserted = exec_insert(conn, keys, chunk_iter)\n                   │           │     │     └ <zip object at 0x00000219B15ECF40>\n                   │           │     └ ['vacancy_id', 'premium', 'name', 'department', 'has_test', 'response_letter_required', 'area', 'salary_from', 'salary_to', '...\n                   │           └ <sqlalchemy.engine.base.Connection object at 0x00000219AD732DE0>\n                   └ <bound method SQLTable._execute_insert of <pandas.io.sql.SQLTable object at 0x00000219B15AA9C0>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1010, in _execute_insert\n    result = conn.execute(self.table.insert(), data)\n             │    │       │    │     │         └ [{'vacancy_id': '103992155', 'premium': False, 'name': 'Junior Python Разработчик', 'department': None, 'has_test': False, 'r...\n             │    │       │    │     └ <function TableClause.insert at 0x00000219B08B9300>\n             │    │       │    └ Table('stage_pars_hh', MetaData(), Column('vacancy_id', Text(), table=<stage_pars_hh>), Column('premium', Boolean(), table=<s...\n             │    │       └ <pandas.io.sql.SQLTable object at 0x00000219B15AA9C0>\n             │    └ <function Connection.execute at 0x00000219B099D440>\n             └ <sqlalchemy.engine.base.Connection object at 0x00000219AD732DE0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x00000219B15DF020>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           │          └ <function Connection._execute_clauseelement at 0x00000219B099D760>\n           └ <sqlalchemy.engine.base.Connection object at 0x00000219AD732DE0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          │    └ <function Connection._execute_context at 0x00000219B099D940>\n          └ <sqlalchemy.engine.base.Connection object at 0x00000219AD732DE0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1844, in _execute_context\n    return self._exec_insertmany_context(dialect, context)\n           │    │                        │        └ <sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x00000219B15DF0E0>\n           │    │                        └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x00000219B1325730>\n           │    └ <function Connection._exec_insertmany_context at 0x00000219B099DA80>\n           └ <sqlalchemy.engine.base.Connection object at 0x00000219AD732DE0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2124, in _exec_insertmany_context\n    self._handle_dbapi_exception(\n    │    └ <function Connection._handle_dbapi_exception at 0x00000219B099DC60>\n    └ <sqlalchemy.engine.base.Connection object at 0x00000219AD732DE0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2353, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n          │                    │              │                 └ ProgrammingError(\"can't adapt type 'dict'\")\n          │                    │              └ (<class 'psycopg2.ProgrammingError'>, ProgrammingError(\"can't adapt type 'dict'\"), <traceback object at 0x00000219B1239E80>)\n          │                    └ <method 'with_traceback' of 'BaseException' objects>\n          └ ProgrammingError(\"(psycopg2.ProgrammingError) can't adapt type 'dict'\")\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x00000219B0A54C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x00000219B1325730>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'alternate_url__0': 'https://hh.ru/vacancy/103992155', 'snippet_requirement__0': 'Решать задачи на <highlighttext>Python</hi...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x00000219B15D90E0; closed: -1>\n\nsqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 780915 characters truncated ... %(accept_incomplete_resumes__933)s, %(experience__933)s, %(employment__933)s, %(vacancy_hash__933)s)]\n[parameters: {'alternate_url__0': 'https://hh.ru/vacancy/103992155', 'snippet_requirement__0': 'Решать задачи на <highlighttext>Python</highlighttext> и разрабатывать сайты при помощи фреймворка Django. Работа с базами данных с ипользованием PostgreSQL (+архитектура). ', 'professional_roles__0': 'Программист, разработчик', 'accept_incomplete_resumes__0': False, 'working_time_intervals__0': None, 'salary_from__0': 50000.0, 'employer_vacancies_url__0': 'https://api.hh.ru/vacancies?employer_id=5454644', 'response_url__0': None, 'schedule__0': 'Удаленная работа', 'sort_point_distance__0': None, 'salary_to__0': None, 'employer_url__0': 'https://hh.ru/employer/5454644', 'accept_temporary__0': False, 'department__0': None, 'working_days__0': None, 'vacancy_hash__0': '0fe1b4962066bddca65c231c79b5f806886646de67c420817c8d0e4fc40411ee', 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=103992155', 'employment__0': 'Полная занятость', 'created_at__0': '2024-07-16T13:15:10+0300', 'vacancy_id__0': '103992155', 'contacts__0': None, 'premium__0': False, 'employer_name__0': 'О-комплекс', 'published_at__0': '2024-07-16T13:15:10+0300', 'experience__0': 'От 1 года до 3 лет', 'has_test__0': False, 'area__0': 'Москва', 'archived__0': False, 'type__0': 'Открытая', 'show_logo_in_search__0': None, 'snippet_responsibility__0': 'Писать стабильный, поддерживаемый код, в соответствии с ТЗ. Вместе с командой проектировать архитектуру приложений и выбирать технологии. Разработка функционала для...', 'response_letter_required__0': False, 'name__0': 'Junior Python Разработчик', 'working_time_modes__0': None, 'url__0': 'https://api.hh.ru/vacancies/103992155?host=hh.ru', 'alternate_url__1': 'https://hh.ru/vacancy/104008693', 'snippet_requirement__1': 'У вас грамотная письменная речь. Умеете находить подход к людям. Любите много общаться по телефону. Наличие ПК/ноутбука, стабильного интернета...', 'professional_roles__1': 'Другое', 'accept_incomplete_resumes__1': True, 'working_time_intervals__1': 'Можно работать сменами по\\xa04–6 часов в\\xa0день', 'salary_from__1': 47990.0, 'employer_vacancies_url__1': 'https://api.hh.ru/vacancies?employer_id=3486217', 'response_url__1': None, 'schedule__1': 'Удаленная работа', 'sort_point_distance__1': None, 'salary_to__1': None, 'employer_url__1': 'https://hh.ru/employer/3486217', 'accept_temporary__1': True, 'department__1': None, 'working_days__1': 'Работа только по\\xa0сб\\xa0и\\xa0вс' ... 32590 parameters truncated ... 'contacts__932': None, 'premium__932': False, 'employer_name__932': '2ГИС', 'published_at__932': '2024-07-16T09:06:02+0300', 'experience__932': 'От 3 до 6 лет', 'has_test__932': False, 'area__932': 'Санкт-Петербург', 'archived__932': False, 'type__932': 'Открытая', 'show_logo_in_search__932': True, 'snippet_responsibility__932': 'Предлагать и реализовывать изменения в текущем стеке технологий. Помогать командам оптимизировать работу с нашей инфраструктурой. Улучшать мониторинг и реагировать на...', 'response_letter_required__932': False, 'name__932': 'DBA/DBOps в команду Infrastructure & Operations', 'working_time_modes__932': None, 'url__932': 'https://api.hh.ru/vacancies/98551258?host=hh.ru', 'alternate_url__933': 'https://hh.ru/vacancy/103013666', 'snippet_requirement__933': 'Знание Linux на уровне администратора. Опыт работы с GitLab, включая GitLab CI. Навыки программирования на <highlighttext>Python</highlighttext>. Опыт с Transformers, Airflow...', 'professional_roles__933': 'DevOps-инженер', 'accept_incomplete_resumes__933': False, 'working_time_intervals__933': None, 'salary_from__933': None, 'employer_vacancies_url__933': 'https://api.hh.ru/vacancies?employer_id=2565797', 'response_url__933': None, 'schedule__933': 'Удаленная работа', 'sort_point_distance__933': None, 'salary_to__933': None, 'employer_url__933': 'https://hh.ru/employer/2565797', 'accept_temporary__933': False, 'department__933': None, 'working_days__933': None, 'vacancy_hash__933': '5a443d91aaa3cce9f0f471a5958ec06595c7759da23c1c61a36f680949e5d0a8', 'apply_alternate_url__933': 'https://hh.ru/applicant/vacancy_response?vacancyId=103013666', 'employment__933': 'Полная занятость', 'created_at__933': '2024-07-09T10:52:39+0300', 'vacancy_id__933': '103013666', 'contacts__933': None, 'premium__933': False, 'employer_name__933': 'БиАйЭй-Технолоджиз', 'published_at__933': '2024-07-09T10:52:39+0300', 'experience__933': 'От 3 до 6 лет', 'has_test__933': False, 'area__933': 'Санкт-Петербург', 'archived__933': False, 'type__933': 'Открытая', 'show_logo_in_search__933': True, 'snippet_responsibility__933': '...и поддержка её актуальности. Автоматизация и сопровождение выпуска релизов, процессов сборки, доставки и обновления проектов компании. Взаимодействие с командой <highlighttext>разработчиков</highlighttext>.', 'response_letter_required__933': False, 'name__933': 'DevOps инженер на ML проект', 'working_time_modes__933': None, 'url__933': 'https://api.hh.ru/vacancies/103013666?host=hh.ru'}]\n(Background on this error at: https://sqlalche.me/e/20/f405)\n", "record": {"elapsed": {"repr": "0:00:27.976508", "seconds": 27.976508}, "exception": {"type": "ProgrammingError", "value": "(psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 780915 characters truncated ... %(accept_incomplete_resumes__933)s, %(experience__933)s, %(employment__933)s, %(vacancy_hash__933)s)]\n[parameters: {'alternate_url__0': 'https://hh.ru/vacancy/103992155', 'snippet_requirement__0': 'Решать задачи на <highlighttext>Python</highlighttext> и разрабатывать сайты при помощи фреймворка Django. Работа с базами данных с ипользованием PostgreSQL (+архитектура). ', 'professional_roles__0': 'Программист, разработчик', 'accept_incomplete_resumes__0': False, 'working_time_intervals__0': None, 'salary_from__0': 50000.0, 'employer_vacancies_url__0': 'https://api.hh.ru/vacancies?employer_id=5454644', 'response_url__0': None, 'schedule__0': 'Удаленная работа', 'sort_point_distance__0': None, 'salary_to__0': None, 'employer_url__0': 'https://hh.ru/employer/5454644', 'accept_temporary__0': False, 'department__0': None, 'working_days__0': None, 'vacancy_hash__0': '0fe1b4962066bddca65c231c79b5f806886646de67c420817c8d0e4fc40411ee', 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=103992155', 'employment__0': 'Полная занятость', 'created_at__0': '2024-07-16T13:15:10+0300', 'vacancy_id__0': '103992155', 'contacts__0': None, 'premium__0': False, 'employer_name__0': 'О-комплекс', 'published_at__0': '2024-07-16T13:15:10+0300', 'experience__0': 'От 1 года до 3 лет', 'has_test__0': False, 'area__0': 'Москва', 'archived__0': False, 'type__0': 'Открытая', 'show_logo_in_search__0': None, 'snippet_responsibility__0': 'Писать стабильный, поддерживаемый код, в соответствии с ТЗ. Вместе с командой проектировать архитектуру приложений и выбирать технологии. Разработка функционала для...', 'response_letter_required__0': False, 'name__0': 'Junior Python Разработчик', 'working_time_modes__0': None, 'url__0': 'https://api.hh.ru/vacancies/103992155?host=hh.ru', 'alternate_url__1': 'https://hh.ru/vacancy/104008693', 'snippet_requirement__1': 'У вас грамотная письменная речь. Умеете находить подход к людям. Любите много общаться по телефону. Наличие ПК/ноутбука, стабильного интернета...', 'professional_roles__1': 'Другое', 'accept_incomplete_resumes__1': True, 'working_time_intervals__1': 'Можно работать сменами по\\xa04–6 часов в\\xa0день', 'salary_from__1': 47990.0, 'employer_vacancies_url__1': 'https://api.hh.ru/vacancies?employer_id=3486217', 'response_url__1': None, 'schedule__1': 'Удаленная работа', 'sort_point_distance__1': None, 'salary_to__1': None, 'employer_url__1': 'https://hh.ru/employer/3486217', 'accept_temporary__1': True, 'department__1': None, 'working_days__1': 'Работа только по\\xa0сб\\xa0и\\xa0вс' ... 32590 parameters truncated ... 'contacts__932': None, 'premium__932': False, 'employer_name__932': '2ГИС', 'published_at__932': '2024-07-16T09:06:02+0300', 'experience__932': 'От 3 до 6 лет', 'has_test__932': False, 'area__932': 'Санкт-Петербург', 'archived__932': False, 'type__932': 'Открытая', 'show_logo_in_search__932': True, 'snippet_responsibility__932': 'Предлагать и реализовывать изменения в текущем стеке технологий. Помогать командам оптимизировать работу с нашей инфраструктурой. Улучшать мониторинг и реагировать на...', 'response_letter_required__932': False, 'name__932': 'DBA/DBOps в команду Infrastructure & Operations', 'working_time_modes__932': None, 'url__932': 'https://api.hh.ru/vacancies/98551258?host=hh.ru', 'alternate_url__933': 'https://hh.ru/vacancy/103013666', 'snippet_requirement__933': 'Знание Linux на уровне администратора. Опыт работы с GitLab, включая GitLab CI. Навыки программирования на <highlighttext>Python</highlighttext>. Опыт с Transformers, Airflow...', 'professional_roles__933': 'DevOps-инженер', 'accept_incomplete_resumes__933': False, 'working_time_intervals__933': None, 'salary_from__933': None, 'employer_vacancies_url__933': 'https://api.hh.ru/vacancies?employer_id=2565797', 'response_url__933': None, 'schedule__933': 'Удаленная работа', 'sort_point_distance__933': None, 'salary_to__933': None, 'employer_url__933': 'https://hh.ru/employer/2565797', 'accept_temporary__933': False, 'department__933': None, 'working_days__933': None, 'vacancy_hash__933': '5a443d91aaa3cce9f0f471a5958ec06595c7759da23c1c61a36f680949e5d0a8', 'apply_alternate_url__933': 'https://hh.ru/applicant/vacancy_response?vacancyId=103013666', 'employment__933': 'Полная занятость', 'created_at__933': '2024-07-09T10:52:39+0300', 'vacancy_id__933': '103013666', 'contacts__933': None, 'premium__933': False, 'employer_name__933': 'БиАйЭй-Технолоджиз', 'published_at__933': '2024-07-09T10:52:39+0300', 'experience__933': 'От 3 до 6 лет', 'has_test__933': False, 'area__933': 'Санкт-Петербург', 'archived__933': False, 'type__933': 'Открытая', 'show_logo_in_search__933': True, 'snippet_responsibility__933': '...и поддержка её актуальности. Автоматизация и сопровождение выпуска релизов, процессов сборки, доставки и обновления проектов компании. Взаимодействие с командой <highlighttext>разработчиков</highlighttext>.', 'response_letter_required__933': False, 'name__933': 'DevOps инженер на ML проект', 'working_time_modes__933': None, 'url__933': 'https://api.hh.ru/vacancies/103013666?host=hh.ru'}]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 179, "message": "An error has been caught in function '<module>', process 'MainProcess' (5760), thread 'MainThread' (8168):", "module": "main", "name": "__main__", "process": {"id": 5760, "name": "MainProcess"}, "thread": {"id": 8168, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:13:18.524158+03:00", "timestamp": 1721211198.524158}}}
{"text": "2024-07-17T13:16:40.842979+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (6744), thread 'MainThread' (1200):\nTraceback (most recent call last):\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x000001833AF94C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001833B8A9F40>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'employer_url__0': 'https://hh.ru/employer/5454644', 'employment__0': 'Полная занятость', 'response_letter_required__0': Fal...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000001833BB18D60; closed: -1>\n\npsycopg2.ProgrammingError: can't adapt type 'dict'\n\n\nThe above exception was the direct cause of the following exception:\n\n\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 178, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '103992155', 'premium': False, 'name': 'Junior Python Разработчик', 'department': None, 'has_test': False, 'response_...\n    └ <function save_to_db at 0x000001833B020900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 150, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False)\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x0000018338FF14E0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    103992155  ...  0fe1b4962066bddca65c231c79b5f8068...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False}\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    103992155  ...  0fe1b4962066bddca65c231c79b5f806...\n           └ <function NDFrame.to_sql at 0x0000018338FF13A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x000001833A351620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x000001833A3531A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x000001833B93B470>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2018, in to_sql\n    total_inserted = sql_engine.insert_records(\n                     │          └ <function SQLAlchemyEngine.insert_records at 0x000001833A352980>\n                     └ <pandas.io.sql.SQLAlchemyEngine object at 0x000001833BAEA810>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1567, in insert_records\n    raise err\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1558, in insert_records\n    return table.insert(chunksize=chunksize, method=method)\n           │     │                │                 └ None\n           │     │                └ None\n           │     └ <function SQLTable.insert at 0x000001833A351DA0>\n           └ <pandas.io.sql.SQLTable object at 0x000001833BAEAB70>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1119, in insert\n    num_inserted = exec_insert(conn, keys, chunk_iter)\n                   │           │     │     └ <zip object at 0x000001833BB2C780>\n                   │           │     └ ['vacancy_id', 'premium', 'name', 'department', 'has_test', 'response_letter_required', 'area', 'salary_from', 'salary_to', '...\n                   │           └ <sqlalchemy.engine.base.Connection object at 0x000001833B8EF890>\n                   └ <bound method SQLTable._execute_insert of <pandas.io.sql.SQLTable object at 0x000001833BAEAB70>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1010, in _execute_insert\n    result = conn.execute(self.table.insert(), data)\n             │    │       │    │     │         └ [{'vacancy_id': '103992155', 'premium': False, 'name': 'Junior Python Разработчик', 'department': None, 'has_test': False, 'r...\n             │    │       │    │     └ <function TableClause.insert at 0x000001833ADF9300>\n             │    │       │    └ Table('stage_pars_hh', MetaData(), Column('vacancy_id', Text(), table=<stage_pars_hh>), Column('premium', Boolean(), table=<s...\n             │    │       └ <pandas.io.sql.SQLTable object at 0x000001833BAEAB70>\n             │    └ <function Connection.execute at 0x000001833AEDD440>\n             └ <sqlalchemy.engine.base.Connection object at 0x000001833B8EF890>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x000001833BB12F90>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           │          └ <function Connection._execute_clauseelement at 0x000001833AEDD760>\n           └ <sqlalchemy.engine.base.Connection object at 0x000001833B8EF890>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          │    └ <function Connection._execute_context at 0x000001833AEDD940>\n          └ <sqlalchemy.engine.base.Connection object at 0x000001833B8EF890>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1844, in _execute_context\n    return self._exec_insertmany_context(dialect, context)\n           │    │                        │        └ <sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x000001833B59E000>\n           │    │                        └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001833B8A9F40>\n           │    └ <function Connection._exec_insertmany_context at 0x000001833AEDDA80>\n           └ <sqlalchemy.engine.base.Connection object at 0x000001833B8EF890>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2124, in _exec_insertmany_context\n    self._handle_dbapi_exception(\n    │    └ <function Connection._handle_dbapi_exception at 0x000001833AEDDC60>\n    └ <sqlalchemy.engine.base.Connection object at 0x000001833B8EF890>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2353, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n          │                    │              │                 └ ProgrammingError(\"can't adapt type 'dict'\")\n          │                    │              └ (<class 'psycopg2.ProgrammingError'>, ProgrammingError(\"can't adapt type 'dict'\"), <traceback object at 0x000001833B96D540>)\n          │                    └ <method 'with_traceback' of 'BaseException' objects>\n          └ ProgrammingError(\"(psycopg2.ProgrammingError) can't adapt type 'dict'\")\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x000001833AF94C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001833B8A9F40>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'employer_url__0': 'https://hh.ru/employer/5454644', 'employment__0': 'Полная занятость', 'response_letter_required__0': Fal...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000001833BB18D60; closed: -1>\n\nsqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 771968 characters truncated ... %(accept_incomplete_resumes__960)s, %(experience__960)s, %(employment__960)s, %(vacancy_hash__960)s)]\n[parameters: {'employer_url__0': 'https://hh.ru/employer/5454644', 'employment__0': 'Полная занятость', 'response_letter_required__0': False, 'sort_point_distance__0': None, 'snippet_responsibility__0': 'Писать стабильный, поддерживаемый код, в соответствии с ТЗ. Вместе с командой проектировать архитектуру приложений и выбирать технологии. Разработка функционала для...', 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=103992155', 'published_at__0': '2024-07-16T13:15:10+0300', 'created_at__0': '2024-07-16T13:15:10+0300', 'salary_from__0': 50000.0, 'contacts__0': None, 'vacancy_id__0': '103992155', 'accept_temporary__0': False, 'professional_roles__0': 'Программист, разработчик', 'employer_name__0': 'О-комплекс', 'snippet_requirement__0': 'Решать задачи на <highlighttext>Python</highlighttext> и разрабатывать сайты при помощи фреймворка Django. Работа с базами данных с ипользованием PostgreSQL (+архитектура). ', 'archived__0': False, 'working_time_intervals__0': None, 'premium__0': False, 'area__0': 'Москва', 'schedule__0': 'Удаленная работа', 'url__0': 'https://api.hh.ru/vacancies/103992155?host=hh.ru', 'show_logo_in_search__0': None, 'salary_to__0': None, 'response_url__0': None, 'name__0': 'Junior Python Разработчик', 'working_time_modes__0': None, 'alternate_url__0': 'https://hh.ru/vacancy/103992155', 'has_test__0': False, 'vacancy_hash__0': '0fe1b4962066bddca65c231c79b5f806886646de67c420817c8d0e4fc40411ee', 'accept_incomplete_resumes__0': False, 'department__0': None, 'type__0': 'Открытая', 'experience__0': 'От 1 года до 3 лет', 'working_days__0': None, 'employer_url__1': 'https://hh.ru/employer/3486217', 'employment__1': 'Частичная занятость', 'response_letter_required__1': False, 'sort_point_distance__1': None, 'snippet_responsibility__1': 'Помогать клиентам в оперативной настройке работы сервисов. Предоставлять обратную связь менеджерам и <highlighttext>разработчикам</highlighttext> для устранения неполадок. Выполнять поставленные цели и...', 'apply_alternate_url__1': 'https://hh.ru/applicant/vacancy_response?vacancyId=104008693', 'published_at__1': '2024-07-16T16:12:17+0300', 'created_at__1': '2024-07-16T16:12:17+0300', 'salary_from__1': 47990.0, 'contacts__1': None, 'vacancy_id__1': '104008693', 'accept_temporary__1': True, 'professional_roles__1': 'Другое', 'employer_name__1': 'ТЭМП', 'snippet_requirement__1': 'У вас грамотная письменная речь. Умеете находить подход к людям. Любите много общаться по телефону. Наличие ПК/ноутбука, стабильного интернета...', 'archived__1': False ... 32574 parameters truncated ... 'area__959': 'Екатеринбург', 'schedule__959': 'Удаленная работа', 'url__959': 'https://api.hh.ru/vacancies/97078971?host=hh.ru', 'show_logo_in_search__959': True, 'salary_to__959': None, 'response_url__959': None, 'name__959': 'SDET/ QA Automation Engineer', 'working_time_modes__959': None, 'alternate_url__959': 'https://hh.ru/vacancy/97078971', 'has_test__959': False, 'vacancy_hash__959': '46c67b9ab745fb7b7aeb01cee24c60a95b4c42e4706f4d1aed75a984b894cfb0', 'accept_incomplete_resumes__959': False, 'department__959': None, 'type__959': 'Открытая', 'experience__959': 'От 3 до 6 лет', 'working_days__959': None, 'employer_url__960': 'https://hh.ru/employer/9498112', 'employment__960': 'Полная занятость', 'response_letter_required__960': False, 'sort_point_distance__960': None, 'snippet_responsibility__960': 'Отвечать пользователям в чатах и по почте. Помогать решать вопросы, связанные с сервисами Яндекса. Передавать фидбэк менеджерам и <highlighttext>разработчикам</highlighttext>. ', 'apply_alternate_url__960': 'https://hh.ru/applicant/vacancy_response?vacancyId=100702941', 'published_at__960': '2024-06-27T09:15:34+0300', 'created_at__960': '2024-06-27T09:15:34+0300', 'salary_from__960': 36000.0, 'contacts__960': None, 'vacancy_id__960': '100702941', 'accept_temporary__960': False, 'professional_roles__960': 'Специалист технической поддержки', 'employer_name__960': 'Яндекс Крауд', 'snippet_requirement__960': 'Не боитесь сложных ситуаций и больших объёмов информации. Знаете языки JavaScript, HTML и <highlighttext>Python</highlighttext>. Спокойно относитесь к однообразным задачам и...', 'archived__960': False, 'working_time_intervals__960': None, 'premium__960': False, 'area__960': 'Екатеринбург', 'schedule__960': 'Удаленная работа', 'url__960': 'https://api.hh.ru/vacancies/100702941?host=hh.ru', 'show_logo_in_search__960': True, 'salary_to__960': None, 'response_url__960': None, 'name__960': 'Специалист ночной технической поддержки (Браузер)', 'working_time_modes__960': None, 'alternate_url__960': 'https://hh.ru/vacancy/100702941', 'has_test__960': False, 'vacancy_hash__960': 'e5d754c77bdf8bcf500734edf27124ddc51ee9d1e4c88e44be06cc1e19738e14', 'accept_incomplete_resumes__960': False, 'department__960': {'id': '9498112-9498112-support', 'name': 'Яндекс Крауд: Поддержка'}, 'type__960': 'Открытая', 'experience__960': 'Нет опыта', 'working_days__960': None}]\n(Background on this error at: https://sqlalche.me/e/20/f405)\n", "record": {"elapsed": {"repr": "0:00:24.671350", "seconds": 24.67135}, "exception": {"type": "ProgrammingError", "value": "(psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 771968 characters truncated ... %(accept_incomplete_resumes__960)s, %(experience__960)s, %(employment__960)s, %(vacancy_hash__960)s)]\n[parameters: {'employer_url__0': 'https://hh.ru/employer/5454644', 'employment__0': 'Полная занятость', 'response_letter_required__0': False, 'sort_point_distance__0': None, 'snippet_responsibility__0': 'Писать стабильный, поддерживаемый код, в соответствии с ТЗ. Вместе с командой проектировать архитектуру приложений и выбирать технологии. Разработка функционала для...', 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=103992155', 'published_at__0': '2024-07-16T13:15:10+0300', 'created_at__0': '2024-07-16T13:15:10+0300', 'salary_from__0': 50000.0, 'contacts__0': None, 'vacancy_id__0': '103992155', 'accept_temporary__0': False, 'professional_roles__0': 'Программист, разработчик', 'employer_name__0': 'О-комплекс', 'snippet_requirement__0': 'Решать задачи на <highlighttext>Python</highlighttext> и разрабатывать сайты при помощи фреймворка Django. Работа с базами данных с ипользованием PostgreSQL (+архитектура). ', 'archived__0': False, 'working_time_intervals__0': None, 'premium__0': False, 'area__0': 'Москва', 'schedule__0': 'Удаленная работа', 'url__0': 'https://api.hh.ru/vacancies/103992155?host=hh.ru', 'show_logo_in_search__0': None, 'salary_to__0': None, 'response_url__0': None, 'name__0': 'Junior Python Разработчик', 'working_time_modes__0': None, 'alternate_url__0': 'https://hh.ru/vacancy/103992155', 'has_test__0': False, 'vacancy_hash__0': '0fe1b4962066bddca65c231c79b5f806886646de67c420817c8d0e4fc40411ee', 'accept_incomplete_resumes__0': False, 'department__0': None, 'type__0': 'Открытая', 'experience__0': 'От 1 года до 3 лет', 'working_days__0': None, 'employer_url__1': 'https://hh.ru/employer/3486217', 'employment__1': 'Частичная занятость', 'response_letter_required__1': False, 'sort_point_distance__1': None, 'snippet_responsibility__1': 'Помогать клиентам в оперативной настройке работы сервисов. Предоставлять обратную связь менеджерам и <highlighttext>разработчикам</highlighttext> для устранения неполадок. Выполнять поставленные цели и...', 'apply_alternate_url__1': 'https://hh.ru/applicant/vacancy_response?vacancyId=104008693', 'published_at__1': '2024-07-16T16:12:17+0300', 'created_at__1': '2024-07-16T16:12:17+0300', 'salary_from__1': 47990.0, 'contacts__1': None, 'vacancy_id__1': '104008693', 'accept_temporary__1': True, 'professional_roles__1': 'Другое', 'employer_name__1': 'ТЭМП', 'snippet_requirement__1': 'У вас грамотная письменная речь. Умеете находить подход к людям. Любите много общаться по телефону. Наличие ПК/ноутбука, стабильного интернета...', 'archived__1': False ... 32574 parameters truncated ... 'area__959': 'Екатеринбург', 'schedule__959': 'Удаленная работа', 'url__959': 'https://api.hh.ru/vacancies/97078971?host=hh.ru', 'show_logo_in_search__959': True, 'salary_to__959': None, 'response_url__959': None, 'name__959': 'SDET/ QA Automation Engineer', 'working_time_modes__959': None, 'alternate_url__959': 'https://hh.ru/vacancy/97078971', 'has_test__959': False, 'vacancy_hash__959': '46c67b9ab745fb7b7aeb01cee24c60a95b4c42e4706f4d1aed75a984b894cfb0', 'accept_incomplete_resumes__959': False, 'department__959': None, 'type__959': 'Открытая', 'experience__959': 'От 3 до 6 лет', 'working_days__959': None, 'employer_url__960': 'https://hh.ru/employer/9498112', 'employment__960': 'Полная занятость', 'response_letter_required__960': False, 'sort_point_distance__960': None, 'snippet_responsibility__960': 'Отвечать пользователям в чатах и по почте. Помогать решать вопросы, связанные с сервисами Яндекса. Передавать фидбэк менеджерам и <highlighttext>разработчикам</highlighttext>. ', 'apply_alternate_url__960': 'https://hh.ru/applicant/vacancy_response?vacancyId=100702941', 'published_at__960': '2024-06-27T09:15:34+0300', 'created_at__960': '2024-06-27T09:15:34+0300', 'salary_from__960': 36000.0, 'contacts__960': None, 'vacancy_id__960': '100702941', 'accept_temporary__960': False, 'professional_roles__960': 'Специалист технической поддержки', 'employer_name__960': 'Яндекс Крауд', 'snippet_requirement__960': 'Не боитесь сложных ситуаций и больших объёмов информации. Знаете языки JavaScript, HTML и <highlighttext>Python</highlighttext>. Спокойно относитесь к однообразным задачам и...', 'archived__960': False, 'working_time_intervals__960': None, 'premium__960': False, 'area__960': 'Екатеринбург', 'schedule__960': 'Удаленная работа', 'url__960': 'https://api.hh.ru/vacancies/100702941?host=hh.ru', 'show_logo_in_search__960': True, 'salary_to__960': None, 'response_url__960': None, 'name__960': 'Специалист ночной технической поддержки (Браузер)', 'working_time_modes__960': None, 'alternate_url__960': 'https://hh.ru/vacancy/100702941', 'has_test__960': False, 'vacancy_hash__960': 'e5d754c77bdf8bcf500734edf27124ddc51ee9d1e4c88e44be06cc1e19738e14', 'accept_incomplete_resumes__960': False, 'department__960': {'id': '9498112-9498112-support', 'name': 'Яндекс Крауд: Поддержка'}, 'type__960': 'Открытая', 'experience__960': 'Нет опыта', 'working_days__960': None}]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 178, "message": "An error has been caught in function '<module>', process 'MainProcess' (6744), thread 'MainThread' (1200):", "module": "main", "name": "__main__", "process": {"id": 6744, "name": "MainProcess"}, "thread": {"id": 1200, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:16:40.842979+03:00", "timestamp": 1721211400.842979}}}
{"text": "2024-07-17T13:21:22.467323+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (11684), thread 'MainThread' (15104):\nTraceback (most recent call last):\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x000001AB23234C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001AB22EF2E40>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'created_at__0': '2024-07-16T13:15:10+0300', 'premium__0': False, 'snippet_responsibility__0': 'Писать стабильный, поддержив...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000001AB23DBCD60; closed: -1>\n\npsycopg2.ProgrammingError: can't adapt type 'dict'\n\n\nThe above exception was the direct cause of the following exception:\n\n\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 178, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '103992155', 'premium': False, 'name': 'Junior Python Разработчик', 'department': None, 'has_test': False, 'response_...\n    └ <function save_to_db at 0x000001AB232C0900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 150, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False)\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x000001AB212614E0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    103992155  ...  0fe1b4962066bddca65c231c79b5f8068...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False}\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    103992155  ...  0fe1b4962066bddca65c231c79b5f806...\n           └ <function NDFrame.to_sql at 0x000001AB212613A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x000001AB225C1620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x000001AB225C31A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x000001AB229B7BC0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2018, in to_sql\n    total_inserted = sql_engine.insert_records(\n                     │          └ <function SQLAlchemyEngine.insert_records at 0x000001AB225C2980>\n                     └ <pandas.io.sql.SQLAlchemyEngine object at 0x000001AB23D867B0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1567, in insert_records\n    raise err\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1558, in insert_records\n    return table.insert(chunksize=chunksize, method=method)\n           │     │                │                 └ None\n           │     │                └ None\n           │     └ <function SQLTable.insert at 0x000001AB225C1DA0>\n           └ <pandas.io.sql.SQLTable object at 0x000001AB23D86AB0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1119, in insert\n    num_inserted = exec_insert(conn, keys, chunk_iter)\n                   │           │     │     └ <zip object at 0x000001AB23DCC840>\n                   │           │     └ ['vacancy_id', 'premium', 'name', 'department', 'has_test', 'response_letter_required', 'area', 'salary_from', 'salary_to', '...\n                   │           └ <sqlalchemy.engine.base.Connection object at 0x000001AB23190290>\n                   └ <bound method SQLTable._execute_insert of <pandas.io.sql.SQLTable object at 0x000001AB23D86AB0>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1010, in _execute_insert\n    result = conn.execute(self.table.insert(), data)\n             │    │       │    │     │         └ [{'vacancy_id': '103992155', 'premium': False, 'name': 'Junior Python Разработчик', 'department': None, 'has_test': False, 'r...\n             │    │       │    │     └ <function TableClause.insert at 0x000001AB23099300>\n             │    │       │    └ Table('stage_pars_hh', MetaData(), Column('vacancy_id', Text(), table=<stage_pars_hh>), Column('premium', Boolean(), table=<s...\n             │    │       └ <pandas.io.sql.SQLTable object at 0x000001AB23D86AB0>\n             │    └ <function Connection.execute at 0x000001AB2317D440>\n             └ <sqlalchemy.engine.base.Connection object at 0x000001AB23190290>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x000001AB23DB7020>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           │          └ <function Connection._execute_clauseelement at 0x000001AB2317D760>\n           └ <sqlalchemy.engine.base.Connection object at 0x000001AB23190290>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          │    └ <function Connection._execute_context at 0x000001AB2317D940>\n          └ <sqlalchemy.engine.base.Connection object at 0x000001AB23190290>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1844, in _execute_context\n    return self._exec_insertmany_context(dialect, context)\n           │    │                        │        └ <sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x000001AB23DB7110>\n           │    │                        └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001AB22EF2E40>\n           │    └ <function Connection._exec_insertmany_context at 0x000001AB2317DA80>\n           └ <sqlalchemy.engine.base.Connection object at 0x000001AB23190290>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2124, in _exec_insertmany_context\n    self._handle_dbapi_exception(\n    │    └ <function Connection._handle_dbapi_exception at 0x000001AB2317DC60>\n    └ <sqlalchemy.engine.base.Connection object at 0x000001AB23190290>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2353, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n          │                    │              │                 └ ProgrammingError(\"can't adapt type 'dict'\")\n          │                    │              └ (<class 'psycopg2.ProgrammingError'>, ProgrammingError(\"can't adapt type 'dict'\"), <traceback object at 0x000001AB232BF240>)\n          │                    └ <method 'with_traceback' of 'BaseException' objects>\n          └ ProgrammingError(\"(psycopg2.ProgrammingError) can't adapt type 'dict'\")\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x000001AB23234C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001AB22EF2E40>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'created_at__0': '2024-07-16T13:15:10+0300', 'premium__0': False, 'snippet_responsibility__0': 'Писать стабильный, поддержив...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000001AB23DBCD60; closed: -1>\n\nsqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 771968 characters truncated ... %(accept_incomplete_resumes__960)s, %(experience__960)s, %(employment__960)s, %(vacancy_hash__960)s)]\n[parameters: {'created_at__0': '2024-07-16T13:15:10+0300', 'premium__0': False, 'snippet_responsibility__0': 'Писать стабильный, поддерживаемый код, в соответствии с ТЗ. Вместе с командой проектировать архитектуру приложений и выбирать технологии. Разработка функционала для...', 'vacancy_hash__0': '0fe1b4962066bddca65c231c79b5f806886646de67c420817c8d0e4fc40411ee', 'department__0': None, 'employer_url__0': 'https://hh.ru/employer/5454644', 'alternate_url__0': 'https://hh.ru/vacancy/103992155', 'working_time_modes__0': None, 'name__0': 'Junior Python Разработчик', 'contacts__0': None, 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=103992155', 'response_letter_required__0': False, 'snippet_requirement__0': 'Решать задачи на <highlighttext>Python</highlighttext> и разрабатывать сайты при помощи фреймворка Django. Работа с базами данных с ипользованием PostgreSQL (+архитектура). ', 'show_logo_in_search__0': None, 'employment__0': 'Полная занятость', 'accept_temporary__0': False, 'salary_from__0': 50000.0, 'salary_to__0': None, 'schedule__0': 'Удаленная работа', 'vacancy_id__0': '103992155', 'experience__0': 'От 1 года до 3 лет', 'has_test__0': False, 'employer_name__0': 'О-комплекс', 'accept_incomplete_resumes__0': False, 'area__0': 'Москва', 'working_days__0': None, 'url__0': 'https://api.hh.ru/vacancies/103992155?host=hh.ru', 'sort_point_distance__0': None, 'published_at__0': '2024-07-16T13:15:10+0300', 'working_time_intervals__0': None, 'professional_roles__0': 'Программист, разработчик', 'response_url__0': None, 'type__0': 'Открытая', 'archived__0': False, 'created_at__1': '2024-07-16T16:12:17+0300', 'premium__1': False, 'snippet_responsibility__1': 'Помогать клиентам в оперативной настройке работы сервисов. Предоставлять обратную связь менеджерам и <highlighttext>разработчикам</highlighttext> для устранения неполадок. Выполнять поставленные цели и...', 'vacancy_hash__1': '375e951be4b00b3dfeadfbc9447545536827fd8f475ff22b153ee3b8d69d42b0', 'department__1': None, 'employer_url__1': 'https://hh.ru/employer/3486217', 'alternate_url__1': 'https://hh.ru/vacancy/104008693', 'working_time_modes__1': 'Можно начинать работать после 16:00', 'name__1': 'Удаленный менеджер (срочно, возможна подработка)', 'contacts__1': None, 'apply_alternate_url__1': 'https://hh.ru/applicant/vacancy_response?vacancyId=104008693', 'response_letter_required__1': False, 'snippet_requirement__1': 'У вас грамотная письменная речь. Умеете находить подход к людям. Любите много общаться по телефону. Наличие ПК/ноутбука, стабильного интернета...', 'show_logo_in_search__1': None, 'employment__1': 'Частичная занятость', 'accept_temporary__1': True ... 32574 parameters truncated ... 'schedule__959': 'Удаленная работа', 'vacancy_id__959': '97078971', 'experience__959': 'От 3 до 6 лет', 'has_test__959': False, 'employer_name__959': 'Maxim technology', 'accept_incomplete_resumes__959': False, 'area__959': 'Екатеринбург', 'working_days__959': None, 'url__959': 'https://api.hh.ru/vacancies/97078971?host=hh.ru', 'sort_point_distance__959': None, 'published_at__959': '2024-06-19T16:13:54+0300', 'working_time_intervals__959': None, 'professional_roles__959': 'Тестировщик', 'response_url__959': None, 'type__959': 'Открытая', 'archived__959': False, 'created_at__960': '2024-06-27T09:15:34+0300', 'premium__960': False, 'snippet_responsibility__960': 'Отвечать пользователям в чатах и по почте. Помогать решать вопросы, связанные с сервисами Яндекса. Передавать фидбэк менеджерам и <highlighttext>разработчикам</highlighttext>. ', 'vacancy_hash__960': 'e5d754c77bdf8bcf500734edf27124ddc51ee9d1e4c88e44be06cc1e19738e14', 'department__960': {'id': '9498112-9498112-support', 'name': 'Яндекс Крауд: Поддержка'}, 'employer_url__960': 'https://hh.ru/employer/9498112', 'alternate_url__960': 'https://hh.ru/vacancy/100702941', 'working_time_modes__960': None, 'name__960': 'Специалист ночной технической поддержки (Браузер)', 'contacts__960': None, 'apply_alternate_url__960': 'https://hh.ru/applicant/vacancy_response?vacancyId=100702941', 'response_letter_required__960': False, 'snippet_requirement__960': 'Не боитесь сложных ситуаций и больших объёмов информации. Знаете языки JavaScript, HTML и <highlighttext>Python</highlighttext>. Спокойно относитесь к однообразным задачам и...', 'show_logo_in_search__960': True, 'employment__960': 'Полная занятость', 'accept_temporary__960': False, 'salary_from__960': 36000.0, 'salary_to__960': None, 'schedule__960': 'Удаленная работа', 'vacancy_id__960': '100702941', 'experience__960': 'Нет опыта', 'has_test__960': False, 'employer_name__960': 'Яндекс Крауд', 'accept_incomplete_resumes__960': False, 'area__960': 'Екатеринбург', 'working_days__960': None, 'url__960': 'https://api.hh.ru/vacancies/100702941?host=hh.ru', 'sort_point_distance__960': None, 'published_at__960': '2024-06-27T09:15:34+0300', 'working_time_intervals__960': None, 'professional_roles__960': 'Специалист технической поддержки', 'response_url__960': None, 'type__960': 'Открытая', 'archived__960': False}]\n(Background on this error at: https://sqlalche.me/e/20/f405)\n", "record": {"elapsed": {"repr": "0:00:24.704499", "seconds": 24.704499}, "exception": {"type": "ProgrammingError", "value": "(psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 771968 characters truncated ... %(accept_incomplete_resumes__960)s, %(experience__960)s, %(employment__960)s, %(vacancy_hash__960)s)]\n[parameters: {'created_at__0': '2024-07-16T13:15:10+0300', 'premium__0': False, 'snippet_responsibility__0': 'Писать стабильный, поддерживаемый код, в соответствии с ТЗ. Вместе с командой проектировать архитектуру приложений и выбирать технологии. Разработка функционала для...', 'vacancy_hash__0': '0fe1b4962066bddca65c231c79b5f806886646de67c420817c8d0e4fc40411ee', 'department__0': None, 'employer_url__0': 'https://hh.ru/employer/5454644', 'alternate_url__0': 'https://hh.ru/vacancy/103992155', 'working_time_modes__0': None, 'name__0': 'Junior Python Разработчик', 'contacts__0': None, 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=103992155', 'response_letter_required__0': False, 'snippet_requirement__0': 'Решать задачи на <highlighttext>Python</highlighttext> и разрабатывать сайты при помощи фреймворка Django. Работа с базами данных с ипользованием PostgreSQL (+архитектура). ', 'show_logo_in_search__0': None, 'employment__0': 'Полная занятость', 'accept_temporary__0': False, 'salary_from__0': 50000.0, 'salary_to__0': None, 'schedule__0': 'Удаленная работа', 'vacancy_id__0': '103992155', 'experience__0': 'От 1 года до 3 лет', 'has_test__0': False, 'employer_name__0': 'О-комплекс', 'accept_incomplete_resumes__0': False, 'area__0': 'Москва', 'working_days__0': None, 'url__0': 'https://api.hh.ru/vacancies/103992155?host=hh.ru', 'sort_point_distance__0': None, 'published_at__0': '2024-07-16T13:15:10+0300', 'working_time_intervals__0': None, 'professional_roles__0': 'Программист, разработчик', 'response_url__0': None, 'type__0': 'Открытая', 'archived__0': False, 'created_at__1': '2024-07-16T16:12:17+0300', 'premium__1': False, 'snippet_responsibility__1': 'Помогать клиентам в оперативной настройке работы сервисов. Предоставлять обратную связь менеджерам и <highlighttext>разработчикам</highlighttext> для устранения неполадок. Выполнять поставленные цели и...', 'vacancy_hash__1': '375e951be4b00b3dfeadfbc9447545536827fd8f475ff22b153ee3b8d69d42b0', 'department__1': None, 'employer_url__1': 'https://hh.ru/employer/3486217', 'alternate_url__1': 'https://hh.ru/vacancy/104008693', 'working_time_modes__1': 'Можно начинать работать после 16:00', 'name__1': 'Удаленный менеджер (срочно, возможна подработка)', 'contacts__1': None, 'apply_alternate_url__1': 'https://hh.ru/applicant/vacancy_response?vacancyId=104008693', 'response_letter_required__1': False, 'snippet_requirement__1': 'У вас грамотная письменная речь. Умеете находить подход к людям. Любите много общаться по телефону. Наличие ПК/ноутбука, стабильного интернета...', 'show_logo_in_search__1': None, 'employment__1': 'Частичная занятость', 'accept_temporary__1': True ... 32574 parameters truncated ... 'schedule__959': 'Удаленная работа', 'vacancy_id__959': '97078971', 'experience__959': 'От 3 до 6 лет', 'has_test__959': False, 'employer_name__959': 'Maxim technology', 'accept_incomplete_resumes__959': False, 'area__959': 'Екатеринбург', 'working_days__959': None, 'url__959': 'https://api.hh.ru/vacancies/97078971?host=hh.ru', 'sort_point_distance__959': None, 'published_at__959': '2024-06-19T16:13:54+0300', 'working_time_intervals__959': None, 'professional_roles__959': 'Тестировщик', 'response_url__959': None, 'type__959': 'Открытая', 'archived__959': False, 'created_at__960': '2024-06-27T09:15:34+0300', 'premium__960': False, 'snippet_responsibility__960': 'Отвечать пользователям в чатах и по почте. Помогать решать вопросы, связанные с сервисами Яндекса. Передавать фидбэк менеджерам и <highlighttext>разработчикам</highlighttext>. ', 'vacancy_hash__960': 'e5d754c77bdf8bcf500734edf27124ddc51ee9d1e4c88e44be06cc1e19738e14', 'department__960': {'id': '9498112-9498112-support', 'name': 'Яндекс Крауд: Поддержка'}, 'employer_url__960': 'https://hh.ru/employer/9498112', 'alternate_url__960': 'https://hh.ru/vacancy/100702941', 'working_time_modes__960': None, 'name__960': 'Специалист ночной технической поддержки (Браузер)', 'contacts__960': None, 'apply_alternate_url__960': 'https://hh.ru/applicant/vacancy_response?vacancyId=100702941', 'response_letter_required__960': False, 'snippet_requirement__960': 'Не боитесь сложных ситуаций и больших объёмов информации. Знаете языки JavaScript, HTML и <highlighttext>Python</highlighttext>. Спокойно относитесь к однообразным задачам и...', 'show_logo_in_search__960': True, 'employment__960': 'Полная занятость', 'accept_temporary__960': False, 'salary_from__960': 36000.0, 'salary_to__960': None, 'schedule__960': 'Удаленная работа', 'vacancy_id__960': '100702941', 'experience__960': 'Нет опыта', 'has_test__960': False, 'employer_name__960': 'Яндекс Крауд', 'accept_incomplete_resumes__960': False, 'area__960': 'Екатеринбург', 'working_days__960': None, 'url__960': 'https://api.hh.ru/vacancies/100702941?host=hh.ru', 'sort_point_distance__960': None, 'published_at__960': '2024-06-27T09:15:34+0300', 'working_time_intervals__960': None, 'professional_roles__960': 'Специалист технической поддержки', 'response_url__960': None, 'type__960': 'Открытая', 'archived__960': False}]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 178, "message": "An error has been caught in function '<module>', process 'MainProcess' (11684), thread 'MainThread' (15104):", "module": "main", "name": "__main__", "process": {"id": 11684, "name": "MainProcess"}, "thread": {"id": 15104, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:21:22.467323+03:00", "timestamp": 1721211682.467323}}}
{"text": "2024-07-17T13:21:22.882737+0300 INFO Собрано 971 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:25.119913", "seconds": 25.119913}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 179, "message": "Собрано 971 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 11684, "name": "MainProcess"}, "thread": {"id": 15104, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:21:22.882737+03:00", "timestamp": 1721211682.882737}}}
{"text": "2024-07-17T13:22:26.632177+0300 INFO Собрано 779 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:11.427742", "seconds": 11.427742}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 779 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 2744, "name": "MainProcess"}, "thread": {"id": 2872, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:22:26.632177+03:00", "timestamp": 1721211746.632177}}}
{"text": "2024-07-17T13:22:31.703078+0300 INFO Собрано 156 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:16.498643", "seconds": 16.498643}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 156 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 2744, "name": "MainProcess"}, "thread": {"id": 2872, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:22:31.703078+03:00", "timestamp": 1721211751.703078}}}
{"text": "2024-07-17T13:22:35.166129+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:19.961694", "seconds": 19.961694}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 2744, "name": "MainProcess"}, "thread": {"id": 2872, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:22:35.166129+03:00", "timestamp": 1721211755.166129}}}
{"text": "2024-07-17T13:22:39.583548+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (2744), thread 'MainThread' (2872):\nTraceback (most recent call last):\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x000001C34EB64C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001C34EBC3380>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'salary_to__0': None, 'salary_from__0': 50000.0, 'url__0': 'https://api.hh.ru/vacancies/103992155?host=hh.ru', 'response_let...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000001C34F6ECD60; closed: -1>\n\npsycopg2.ProgrammingError: can't adapt type 'dict'\n\n\nThe above exception was the direct cause of the following exception:\n\n\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 178, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '103992155', 'premium': False, 'name': 'Junior Python Разработчик', 'department': None, 'has_test': False, 'response_...\n    └ <function save_to_db at 0x000001C34EBF0900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 150, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False)\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x000001C34CB494E0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    103992155  ...  0fe1b4962066bddca65c231c79b5f8068...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False}\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    103992155  ...  0fe1b4962066bddca65c231c79b5f806...\n           └ <function NDFrame.to_sql at 0x000001C34CB493A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x000001C34DEB1620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x000001C34DEB31A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x000001C34EB682F0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2018, in to_sql\n    total_inserted = sql_engine.insert_records(\n                     │          └ <function SQLAlchemyEngine.insert_records at 0x000001C34DEB2980>\n                     └ <pandas.io.sql.SQLAlchemyEngine object at 0x000001C34F6AEBD0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1567, in insert_records\n    raise err\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1558, in insert_records\n    return table.insert(chunksize=chunksize, method=method)\n           │     │                │                 └ None\n           │     │                └ None\n           │     └ <function SQLTable.insert at 0x000001C34DEB1DA0>\n           └ <pandas.io.sql.SQLTable object at 0x000001C34F6AECC0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1119, in insert\n    num_inserted = exec_insert(conn, keys, chunk_iter)\n                   │           │     │     └ <zip object at 0x000001C34F6FCB80>\n                   │           │     └ ['vacancy_id', 'premium', 'name', 'department', 'has_test', 'response_letter_required', 'area', 'salary_from', 'salary_to', '...\n                   │           └ <sqlalchemy.engine.base.Connection object at 0x000001C34F16DEB0>\n                   └ <bound method SQLTable._execute_insert of <pandas.io.sql.SQLTable object at 0x000001C34F6AECC0>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1010, in _execute_insert\n    result = conn.execute(self.table.insert(), data)\n             │    │       │    │     │         └ [{'vacancy_id': '103992155', 'premium': False, 'name': 'Junior Python Разработчик', 'department': None, 'has_test': False, 'r...\n             │    │       │    │     └ <function TableClause.insert at 0x000001C34E9C9300>\n             │    │       │    └ Table('stage_pars_hh', MetaData(), Column('vacancy_id', Text(), table=<stage_pars_hh>), Column('premium', Boolean(), table=<s...\n             │    │       └ <pandas.io.sql.SQLTable object at 0x000001C34F6AECC0>\n             │    └ <function Connection.execute at 0x000001C34EAAD440>\n             └ <sqlalchemy.engine.base.Connection object at 0x000001C34F16DEB0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x000001C34F6AEA20>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           │          └ <function Connection._execute_clauseelement at 0x000001C34EAAD760>\n           └ <sqlalchemy.engine.base.Connection object at 0x000001C34F16DEB0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          │    └ <function Connection._execute_context at 0x000001C34EAAD940>\n          └ <sqlalchemy.engine.base.Connection object at 0x000001C34F16DEB0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1844, in _execute_context\n    return self._exec_insertmany_context(dialect, context)\n           │    │                        │        └ <sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x000001C34F6E7290>\n           │    │                        └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001C34EBC3380>\n           │    └ <function Connection._exec_insertmany_context at 0x000001C34EAADA80>\n           └ <sqlalchemy.engine.base.Connection object at 0x000001C34F16DEB0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2124, in _exec_insertmany_context\n    self._handle_dbapi_exception(\n    │    └ <function Connection._handle_dbapi_exception at 0x000001C34EAADC60>\n    └ <sqlalchemy.engine.base.Connection object at 0x000001C34F16DEB0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2353, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n          │                    │              │                 └ ProgrammingError(\"can't adapt type 'dict'\")\n          │                    │              └ (<class 'psycopg2.ProgrammingError'>, ProgrammingError(\"can't adapt type 'dict'\"), <traceback object at 0x000001C34F625100>)\n          │                    └ <method 'with_traceback' of 'BaseException' objects>\n          └ ProgrammingError(\"(psycopg2.ProgrammingError) can't adapt type 'dict'\")\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x000001C34EB64C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001C34EBC3380>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'salary_to__0': None, 'salary_from__0': 50000.0, 'url__0': 'https://api.hh.ru/vacancies/103992155?host=hh.ru', 'response_let...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000001C34F6ECD60; closed: -1>\n\nsqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 771968 characters truncated ... %(accept_incomplete_resumes__960)s, %(experience__960)s, %(employment__960)s, %(vacancy_hash__960)s)]\n[parameters: {'salary_to__0': None, 'salary_from__0': 50000.0, 'url__0': 'https://api.hh.ru/vacancies/103992155?host=hh.ru', 'response_letter_required__0': False, 'working_time_intervals__0': None, 'snippet_responsibility__0': 'Писать стабильный, поддерживаемый код, в соответствии с ТЗ. Вместе с командой проектировать архитектуру приложений и выбирать технологии. Разработка функционала для...', 'alternate_url__0': 'https://hh.ru/vacancy/103992155', 'department__0': None, 'sort_point_distance__0': None, 'snippet_requirement__0': 'Решать задачи на <highlighttext>Python</highlighttext> и разрабатывать сайты при помощи фреймворка Django. Работа с базами данных с ипользованием PostgreSQL (+архитектура). ', 'contacts__0': None, 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=103992155', 'accept_temporary__0': False, 'employment__0': 'Полная занятость', 'published_at__0': '2024-07-16T13:15:10+0300', 'employer_name__0': 'О-комплекс', 'has_test__0': False, 'working_days__0': None, 'working_time_modes__0': None, 'premium__0': False, 'area__0': 'Москва', 'professional_roles__0': 'Программист, разработчик', 'schedule__0': 'Удаленная работа', 'show_logo_in_search__0': None, 'employer_url__0': 'https://hh.ru/employer/5454644', 'type__0': 'Открытая', 'response_url__0': None, 'experience__0': 'От 1 года до 3 лет', 'archived__0': False, 'created_at__0': '2024-07-16T13:15:10+0300', 'accept_incomplete_resumes__0': False, 'vacancy_hash__0': '0fe1b4962066bddca65c231c79b5f806886646de67c420817c8d0e4fc40411ee', 'vacancy_id__0': '103992155', 'name__0': 'Junior Python Разработчик', 'salary_to__1': None, 'salary_from__1': 47990.0, 'url__1': 'https://api.hh.ru/vacancies/104008693?host=hh.ru', 'response_letter_required__1': False, 'working_time_intervals__1': 'Можно работать сменами по\\xa04–6 часов в\\xa0день', 'snippet_responsibility__1': 'Помогать клиентам в оперативной настройке работы сервисов. Предоставлять обратную связь менеджерам и <highlighttext>разработчикам</highlighttext> для устранения неполадок. Выполнять поставленные цели и...', 'alternate_url__1': 'https://hh.ru/vacancy/104008693', 'department__1': None, 'sort_point_distance__1': None, 'snippet_requirement__1': 'У вас грамотная письменная речь. Умеете находить подход к людям. Любите много общаться по телефону. Наличие ПК/ноутбука, стабильного интернета...', 'contacts__1': None, 'apply_alternate_url__1': 'https://hh.ru/applicant/vacancy_response?vacancyId=104008693', 'accept_temporary__1': True, 'employment__1': 'Частичная занятость', 'published_at__1': '2024-07-16T16:12:17+0300', 'employer_name__1': 'ТЭМП' ... 32574 parameters truncated ... 'working_time_modes__959': None, 'premium__959': False, 'area__959': 'Екатеринбург', 'professional_roles__959': 'Тестировщик', 'schedule__959': 'Удаленная работа', 'show_logo_in_search__959': True, 'employer_url__959': 'https://hh.ru/employer/5425152', 'type__959': 'Открытая', 'response_url__959': None, 'experience__959': 'От 3 до 6 лет', 'archived__959': False, 'created_at__959': '2024-06-19T16:13:54+0300', 'accept_incomplete_resumes__959': False, 'vacancy_hash__959': '46c67b9ab745fb7b7aeb01cee24c60a95b4c42e4706f4d1aed75a984b894cfb0', 'vacancy_id__959': '97078971', 'name__959': 'SDET/ QA Automation Engineer', 'salary_to__960': None, 'salary_from__960': 36000.0, 'url__960': 'https://api.hh.ru/vacancies/100702941?host=hh.ru', 'response_letter_required__960': False, 'working_time_intervals__960': None, 'snippet_responsibility__960': 'Отвечать пользователям в чатах и по почте. Помогать решать вопросы, связанные с сервисами Яндекса. Передавать фидбэк менеджерам и <highlighttext>разработчикам</highlighttext>. ', 'alternate_url__960': 'https://hh.ru/vacancy/100702941', 'department__960': {'id': '9498112-9498112-support', 'name': 'Яндекс Крауд: Поддержка'}, 'sort_point_distance__960': None, 'snippet_requirement__960': 'Не боитесь сложных ситуаций и больших объёмов информации. Знаете языки JavaScript, HTML и <highlighttext>Python</highlighttext>. Спокойно относитесь к однообразным задачам и...', 'contacts__960': None, 'apply_alternate_url__960': 'https://hh.ru/applicant/vacancy_response?vacancyId=100702941', 'accept_temporary__960': False, 'employment__960': 'Полная занятость', 'published_at__960': '2024-06-27T09:15:34+0300', 'employer_name__960': 'Яндекс Крауд', 'has_test__960': False, 'working_days__960': None, 'working_time_modes__960': None, 'premium__960': False, 'area__960': 'Екатеринбург', 'professional_roles__960': 'Специалист технической поддержки', 'schedule__960': 'Удаленная работа', 'show_logo_in_search__960': True, 'employer_url__960': 'https://hh.ru/employer/9498112', 'type__960': 'Открытая', 'response_url__960': None, 'experience__960': 'Нет опыта', 'archived__960': False, 'created_at__960': '2024-06-27T09:15:34+0300', 'accept_incomplete_resumes__960': False, 'vacancy_hash__960': 'e5d754c77bdf8bcf500734edf27124ddc51ee9d1e4c88e44be06cc1e19738e14', 'vacancy_id__960': '100702941', 'name__960': 'Специалист ночной технической поддержки (Браузер)'}]\n(Background on this error at: https://sqlalche.me/e/20/f405)\n", "record": {"elapsed": {"repr": "0:00:24.379113", "seconds": 24.379113}, "exception": {"type": "ProgrammingError", "value": "(psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 771968 characters truncated ... %(accept_incomplete_resumes__960)s, %(experience__960)s, %(employment__960)s, %(vacancy_hash__960)s)]\n[parameters: {'salary_to__0': None, 'salary_from__0': 50000.0, 'url__0': 'https://api.hh.ru/vacancies/103992155?host=hh.ru', 'response_letter_required__0': False, 'working_time_intervals__0': None, 'snippet_responsibility__0': 'Писать стабильный, поддерживаемый код, в соответствии с ТЗ. Вместе с командой проектировать архитектуру приложений и выбирать технологии. Разработка функционала для...', 'alternate_url__0': 'https://hh.ru/vacancy/103992155', 'department__0': None, 'sort_point_distance__0': None, 'snippet_requirement__0': 'Решать задачи на <highlighttext>Python</highlighttext> и разрабатывать сайты при помощи фреймворка Django. Работа с базами данных с ипользованием PostgreSQL (+архитектура). ', 'contacts__0': None, 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=103992155', 'accept_temporary__0': False, 'employment__0': 'Полная занятость', 'published_at__0': '2024-07-16T13:15:10+0300', 'employer_name__0': 'О-комплекс', 'has_test__0': False, 'working_days__0': None, 'working_time_modes__0': None, 'premium__0': False, 'area__0': 'Москва', 'professional_roles__0': 'Программист, разработчик', 'schedule__0': 'Удаленная работа', 'show_logo_in_search__0': None, 'employer_url__0': 'https://hh.ru/employer/5454644', 'type__0': 'Открытая', 'response_url__0': None, 'experience__0': 'От 1 года до 3 лет', 'archived__0': False, 'created_at__0': '2024-07-16T13:15:10+0300', 'accept_incomplete_resumes__0': False, 'vacancy_hash__0': '0fe1b4962066bddca65c231c79b5f806886646de67c420817c8d0e4fc40411ee', 'vacancy_id__0': '103992155', 'name__0': 'Junior Python Разработчик', 'salary_to__1': None, 'salary_from__1': 47990.0, 'url__1': 'https://api.hh.ru/vacancies/104008693?host=hh.ru', 'response_letter_required__1': False, 'working_time_intervals__1': 'Можно работать сменами по\\xa04–6 часов в\\xa0день', 'snippet_responsibility__1': 'Помогать клиентам в оперативной настройке работы сервисов. Предоставлять обратную связь менеджерам и <highlighttext>разработчикам</highlighttext> для устранения неполадок. Выполнять поставленные цели и...', 'alternate_url__1': 'https://hh.ru/vacancy/104008693', 'department__1': None, 'sort_point_distance__1': None, 'snippet_requirement__1': 'У вас грамотная письменная речь. Умеете находить подход к людям. Любите много общаться по телефону. Наличие ПК/ноутбука, стабильного интернета...', 'contacts__1': None, 'apply_alternate_url__1': 'https://hh.ru/applicant/vacancy_response?vacancyId=104008693', 'accept_temporary__1': True, 'employment__1': 'Частичная занятость', 'published_at__1': '2024-07-16T16:12:17+0300', 'employer_name__1': 'ТЭМП' ... 32574 parameters truncated ... 'working_time_modes__959': None, 'premium__959': False, 'area__959': 'Екатеринбург', 'professional_roles__959': 'Тестировщик', 'schedule__959': 'Удаленная работа', 'show_logo_in_search__959': True, 'employer_url__959': 'https://hh.ru/employer/5425152', 'type__959': 'Открытая', 'response_url__959': None, 'experience__959': 'От 3 до 6 лет', 'archived__959': False, 'created_at__959': '2024-06-19T16:13:54+0300', 'accept_incomplete_resumes__959': False, 'vacancy_hash__959': '46c67b9ab745fb7b7aeb01cee24c60a95b4c42e4706f4d1aed75a984b894cfb0', 'vacancy_id__959': '97078971', 'name__959': 'SDET/ QA Automation Engineer', 'salary_to__960': None, 'salary_from__960': 36000.0, 'url__960': 'https://api.hh.ru/vacancies/100702941?host=hh.ru', 'response_letter_required__960': False, 'working_time_intervals__960': None, 'snippet_responsibility__960': 'Отвечать пользователям в чатах и по почте. Помогать решать вопросы, связанные с сервисами Яндекса. Передавать фидбэк менеджерам и <highlighttext>разработчикам</highlighttext>. ', 'alternate_url__960': 'https://hh.ru/vacancy/100702941', 'department__960': {'id': '9498112-9498112-support', 'name': 'Яндекс Крауд: Поддержка'}, 'sort_point_distance__960': None, 'snippet_requirement__960': 'Не боитесь сложных ситуаций и больших объёмов информации. Знаете языки JavaScript, HTML и <highlighttext>Python</highlighttext>. Спокойно относитесь к однообразным задачам и...', 'contacts__960': None, 'apply_alternate_url__960': 'https://hh.ru/applicant/vacancy_response?vacancyId=100702941', 'accept_temporary__960': False, 'employment__960': 'Полная занятость', 'published_at__960': '2024-06-27T09:15:34+0300', 'employer_name__960': 'Яндекс Крауд', 'has_test__960': False, 'working_days__960': None, 'working_time_modes__960': None, 'premium__960': False, 'area__960': 'Екатеринбург', 'professional_roles__960': 'Специалист технической поддержки', 'schedule__960': 'Удаленная работа', 'show_logo_in_search__960': True, 'employer_url__960': 'https://hh.ru/employer/9498112', 'type__960': 'Открытая', 'response_url__960': None, 'experience__960': 'Нет опыта', 'archived__960': False, 'created_at__960': '2024-06-27T09:15:34+0300', 'accept_incomplete_resumes__960': False, 'vacancy_hash__960': 'e5d754c77bdf8bcf500734edf27124ddc51ee9d1e4c88e44be06cc1e19738e14', 'vacancy_id__960': '100702941', 'name__960': 'Специалист ночной технической поддержки (Браузер)'}]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 178, "message": "An error has been caught in function '<module>', process 'MainProcess' (2744), thread 'MainThread' (2872):", "module": "main", "name": "__main__", "process": {"id": 2744, "name": "MainProcess"}, "thread": {"id": 2872, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:22:39.583548+03:00", "timestamp": 1721211759.583548}}}
{"text": "2024-07-17T13:22:40.010110+0300 INFO Собрано 971 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:24.805675", "seconds": 24.805675}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 179, "message": "Собрано 971 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 2744, "name": "MainProcess"}, "thread": {"id": 2872, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:22:40.010110+03:00", "timestamp": 1721211760.01011}}}
{"text": "2024-07-17T13:27:36.889390+0300 INFO Собрано 779 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:11.793491", "seconds": 11.793491}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 779 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 12320, "name": "MainProcess"}, "thread": {"id": 7844, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:27:36.889390+03:00", "timestamp": 1721212056.88939}}}
{"text": "2024-07-17T13:27:42.090765+0300 INFO Собрано 156 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:16.994866", "seconds": 16.994866}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 156 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 12320, "name": "MainProcess"}, "thread": {"id": 7844, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:27:42.090765+03:00", "timestamp": 1721212062.090765}}}
{"text": "2024-07-17T13:27:45.570390+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:20.474491", "seconds": 20.474491}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 12320, "name": "MainProcess"}, "thread": {"id": 7844, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:27:45.570390+03:00", "timestamp": 1721212065.57039}}}
{"text": "2024-07-17T13:27:49.800086+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (12320), thread 'MainThread' (7844):\nTraceback (most recent call last):\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py\", line 3805, in get_loc\n    return self._engine.get_loc(casted_key)\n           │    │               └ 0\n           │    └ <pandas._libs.properties.CachedProperty object at 0x0000020CCE8BADC0>\n           └ Index(['vacancy_id', 'premium', 'name', 'department', 'has_test',\n                    'response_letter_required', 'area', 'salary_from', '...\n  File \"index.pyx\", line 167, in pandas._libs.index.IndexEngine.get_loc\n  File \"index.pyx\", line 196, in pandas._libs.index.IndexEngine.get_loc\n  File \"pandas\\\\_libs\\\\hashtable_class_helper.pxi\", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item\n  File \"pandas\\\\_libs\\\\hashtable_class_helper.pxi\", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item\n\nKeyError: 0\n\n\nThe above exception was the direct cause of the following exception:\n\n\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 178, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '103992155', 'premium': False, 'name': 'Junior Python Разработчик', 'department': None, 'has_test': False, 'response_...\n    └ <function save_to_db at 0x0000020CD0B90900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 146, in save_to_db\n    print(vacancies_df[0])\n          └     vacancy_id  ...                                       vacancy_hash\n            0    103992155  ...  0fe1b4962066bddca65c231c79b5f8068...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\frame.py\", line 4102, in __getitem__\n    indexer = self.columns.get_loc(key)\n              │    │               └ 0\n              │    └ <pandas._libs.properties.AxisProperty object at 0x0000020CCEBF2890>\n              └     vacancy_id  ...                                       vacancy_hash\n                0    103992155  ...  0fe1b4962066bddca65c231c79b5f8068...\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py\", line 3812, in get_loc\n    raise KeyError(key) from err\n                   └ 0\n\nKeyError: 0\n", "record": {"elapsed": {"repr": "0:00:24.704187", "seconds": 24.704187}, "exception": {"type": "KeyError", "value": "0", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 178, "message": "An error has been caught in function '<module>', process 'MainProcess' (12320), thread 'MainThread' (7844):", "module": "main", "name": "__main__", "process": {"id": 12320, "name": "MainProcess"}, "thread": {"id": 7844, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:27:49.800086+03:00", "timestamp": 1721212069.800086}}}
{"text": "2024-07-17T13:27:50.100000+0300 INFO Собрано 971 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:25.004101", "seconds": 25.004101}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 179, "message": "Собрано 971 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 12320, "name": "MainProcess"}, "thread": {"id": 7844, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:27:50.100000+03:00", "timestamp": 1721212070.1}}}
{"text": "2024-07-17T13:30:35.153606+0300 INFO Собрано 778 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:12.250844", "seconds": 12.250844}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 778 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 7348, "name": "MainProcess"}, "thread": {"id": 5460, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:30:35.153606+03:00", "timestamp": 1721212235.153606}}}
{"text": "2024-07-17T13:30:46.068373+0300 INFO Собрано 156 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:02.147459", "seconds": 2.147459}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 156 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 14004, "name": "MainProcess"}, "thread": {"id": 8432, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:30:46.068373+03:00", "timestamp": 1721212246.068373}}}
{"text": "2024-07-17T13:30:49.510879+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.589965", "seconds": 5.589965}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 14004, "name": "MainProcess"}, "thread": {"id": 8432, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:30:49.510879+03:00", "timestamp": 1721212249.510879}}}
{"text": "2024-07-17T13:30:52.581838+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (14004), thread 'MainThread' (8432):\nTraceback (most recent call last):\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py\", line 3805, in get_loc\n    return self._engine.get_loc(casted_key)\n           │    │               └ 0\n           │    └ <pandas._libs.properties.CachedProperty object at 0x00000219E982EC40>\n           └ Index(['vacancy_id', 'premium', 'name', 'department', 'has_test',\n                    'response_letter_required', 'area', 'salary_from', '...\n  File \"index.pyx\", line 167, in pandas._libs.index.IndexEngine.get_loc\n  File \"index.pyx\", line 196, in pandas._libs.index.IndexEngine.get_loc\n  File \"pandas\\\\_libs\\\\hashtable_class_helper.pxi\", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item\n  File \"pandas\\\\_libs\\\\hashtable_class_helper.pxi\", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item\n\nKeyError: 0\n\n\nThe above exception was the direct cause of the following exception:\n\n\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 180, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_test': Fa...\n    └ <function save_to_db at 0x00000219EBB00900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 141, in save_to_db\n    print(vacancies_df[0])\n          └     vacancy_id  ...                                       vacancy_hash\n            0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\frame.py\", line 4102, in __getitem__\n    indexer = self.columns.get_loc(key)\n              │    │               └ 0\n              │    └ <pandas._libs.properties.AxisProperty object at 0x00000219E9B62C50>\n              └     vacancy_id  ...                                       vacancy_hash\n                0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py\", line 3812, in get_loc\n    raise KeyError(key) from err\n                   └ 0\n\nKeyError: 0\n", "record": {"elapsed": {"repr": "0:00:08.660924", "seconds": 8.660924}, "exception": {"type": "KeyError", "value": "0", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 180, "message": "An error has been caught in function '<module>', process 'MainProcess' (14004), thread 'MainThread' (8432):", "module": "main", "name": "__main__", "process": {"id": 14004, "name": "MainProcess"}, "thread": {"id": 8432, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:30:52.581838+03:00", "timestamp": 1721212252.581838}}}
{"text": "2024-07-17T13:30:52.698560+0300 INFO Собрано 192 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:08.777646", "seconds": 8.777646}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 181, "message": "Собрано 192 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 14004, "name": "MainProcess"}, "thread": {"id": 8432, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:30:52.698560+03:00", "timestamp": 1721212252.69856}}}
{"text": "2024-07-17T13:31:17.911951+0300 INFO Собрано 155 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:02.025913", "seconds": 2.025913}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 155 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 12544, "name": "MainProcess"}, "thread": {"id": 5956, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:31:17.911951+03:00", "timestamp": 1721212277.911951}}}
{"text": "2024-07-17T13:31:21.366041+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.480003", "seconds": 5.480003}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 12544, "name": "MainProcess"}, "thread": {"id": 5956, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:31:21.366041+03:00", "timestamp": 1721212281.366041}}}
{"text": "2024-07-17T13:33:23.757579+0300 INFO Собрано 155 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:01.985544", "seconds": 1.985544}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 155 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 6256, "name": "MainProcess"}, "thread": {"id": 2280, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:33:23.757579+03:00", "timestamp": 1721212403.757579}}}
{"text": "2024-07-17T13:33:27.246973+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.474938", "seconds": 5.474938}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 6256, "name": "MainProcess"}, "thread": {"id": 2280, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:33:27.246973+03:00", "timestamp": 1721212407.246973}}}
{"text": "2024-07-17T13:36:19.154574+0300 INFO Собрано 155 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:02.188184", "seconds": 2.188184}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 155 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 1020, "name": "MainProcess"}, "thread": {"id": 5236, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:36:19.154574+03:00", "timestamp": 1721212579.154574}}}
{"text": "2024-07-17T13:36:22.620702+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.654312", "seconds": 5.654312}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 1020, "name": "MainProcess"}, "thread": {"id": 5236, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:36:22.620702+03:00", "timestamp": 1721212582.620702}}}
{"text": "2024-07-17T13:36:26.846099+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (1020), thread 'MainThread' (5236):\nTraceback (most recent call last):\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x000001A64B444C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001A64B9179E0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'alternate_url__0': 'https://hh.ru/vacancy/102978103', 'type__0': 'Открытая', 'working_time_modes__0': None, 'sort_point_dis...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000001A64BB65460; closed: -1>\n\npsycopg2.ProgrammingError: can't adapt type 'dict'\n\n\nThe above exception was the direct cause of the following exception:\n\n\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 181, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_test': Fa...\n    └ <function save_to_db at 0x000001A64B4D0900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 152, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False)\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x000001A6494254E0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False}\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    102978103  ...  24a1e68192ea262701345f49ae0607c0...\n           └ <function NDFrame.to_sql at 0x000001A6494253A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x000001A64A791620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x000001A64A7931A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x000001A64BA9A2D0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2018, in to_sql\n    total_inserted = sql_engine.insert_records(\n                     │          └ <function SQLAlchemyEngine.insert_records at 0x000001A64A792980>\n                     └ <pandas.io.sql.SQLAlchemyEngine object at 0x000001A64BB39B80>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1567, in insert_records\n    raise err\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1558, in insert_records\n    return table.insert(chunksize=chunksize, method=method)\n           │     │                │                 └ None\n           │     │                └ None\n           │     └ <function SQLTable.insert at 0x000001A64A791DA0>\n           └ <pandas.io.sql.SQLTable object at 0x000001A64BB3A4E0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1119, in insert\n    num_inserted = exec_insert(conn, keys, chunk_iter)\n                   │           │     │     └ <zip object at 0x000001A64BB72D80>\n                   │           │     └ ['vacancy_id', 'premium', 'name', 'department', 'has_test', 'response_letter_required', 'area', 'salary_from', 'salary_to', '...\n                   │           └ <sqlalchemy.engine.base.Connection object at 0x000001A64B964860>\n                   └ <bound method SQLTable._execute_insert of <pandas.io.sql.SQLTable object at 0x000001A64BB3A4E0>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1010, in _execute_insert\n    result = conn.execute(self.table.insert(), data)\n             │    │       │    │     │         └ [{'vacancy_id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_t...\n             │    │       │    │     └ <function TableClause.insert at 0x000001A64B2A5300>\n             │    │       │    └ Table('stage_pars_hh', MetaData(), Column('vacancy_id', Text(), table=<stage_pars_hh>), Column('premium', Boolean(), table=<s...\n             │    │       └ <pandas.io.sql.SQLTable object at 0x000001A64BB3A4E0>\n             │    └ <function Connection.execute at 0x000001A64B38D440>\n             └ <sqlalchemy.engine.base.Connection object at 0x000001A64B964860>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x000001A64A9C6870>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           │          └ <function Connection._execute_clauseelement at 0x000001A64B38D760>\n           └ <sqlalchemy.engine.base.Connection object at 0x000001A64B964860>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          │    └ <function Connection._execute_context at 0x000001A64B38D940>\n          └ <sqlalchemy.engine.base.Connection object at 0x000001A64B964860>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1844, in _execute_context\n    return self._exec_insertmany_context(dialect, context)\n           │    │                        │        └ <sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x000001A64BB3BC50>\n           │    │                        └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001A64B9179E0>\n           │    └ <function Connection._exec_insertmany_context at 0x000001A64B38DA80>\n           └ <sqlalchemy.engine.base.Connection object at 0x000001A64B964860>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2124, in _exec_insertmany_context\n    self._handle_dbapi_exception(\n    │    └ <function Connection._handle_dbapi_exception at 0x000001A64B38DC60>\n    └ <sqlalchemy.engine.base.Connection object at 0x000001A64B964860>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2353, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n          │                    │              │                 └ ProgrammingError(\"can't adapt type 'dict'\")\n          │                    │              └ (<class 'psycopg2.ProgrammingError'>, ProgrammingError(\"can't adapt type 'dict'\"), <traceback object at 0x000001A64BC4BF40>)\n          │                    └ <method 'with_traceback' of 'BaseException' objects>\n          └ ProgrammingError(\"(psycopg2.ProgrammingError) can't adapt type 'dict'\")\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x000001A64B444C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001A64B9179E0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'alternate_url__0': 'https://hh.ru/vacancy/102978103', 'type__0': 'Открытая', 'working_time_modes__0': None, 'sort_point_dis...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000001A64BB65460; closed: -1>\n\nsqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 150578 characters truncated ... %(accept_incomplete_resumes__190)s, %(experience__190)s, %(employment__190)s, %(vacancy_hash__190)s)]\n[parameters: {'alternate_url__0': 'https://hh.ru/vacancy/102978103', 'type__0': 'Открытая', 'working_time_modes__0': None, 'sort_point_distance__0': None, 'has_test__0': False, 'snippet_requirement__0': 'Знание языка программирования <highlighttext>Python</highlighttext>. Опыт работы с API. Понимание принципов алгоритмической торговли. Базовые знания в области блокчейн-технологий. ', 'contacts__0': None, 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=102978103', 'working_time_intervals__0': 'Можно работать сменами по\\xa04–6 часов в\\xa0день', 'response_letter_required__0': True, 'archived__0': False, 'employer_name__0': 'Smit&Co', 'vacancy_id__0': '102978103', 'department__0': None, 'employer_url__0': 'https://hh.ru/employer/4789182', 'vacancy_hash__0': '24a1e68192ea262701345f49ae0607c004c8356eedcd18ab8024240aaeda7ab9', 'working_days__0': None, 'salary_from__0': 50000.0, 'employment__0': 'Полная занятость', 'url__0': 'https://api.hh.ru/vacancies/102978103?host=hh.ru', 'schedule__0': 'Удаленная работа', 'accept_temporary__0': False, 'show_logo_in_search__0': None, 'experience__0': 'Нет опыта', 'premium__0': False, 'professional_roles__0': 'Программист, разработчик', 'area__0': 'Санкт-Петербург', 'salary_to__0': None, 'response_url__0': None, 'created_at__0': '2024-06-29T23:30:33+0300', 'snippet_responsibility__0': 'Написание кода по техническому заданию. Работа с API различных платформ для выполнения задач. Разработка алгоритмов для торговых стратегий фонда. ', 'published_at__0': '2024-06-29T23:30:33+0300', 'name__0': 'Программист-стажер в инвестиционный фонд', 'accept_incomplete_resumes__0': False, 'alternate_url__1': 'https://hh.ru/vacancy/104000699', 'type__1': 'Открытая', 'working_time_modes__1': None, 'sort_point_distance__1': None, 'has_test__1': False, 'snippet_requirement__1': 'Знание языка программирования <highlighttext>Python</highlighttext>. Опыт работы с базами данных (Mysql). Классические алгоритмы Computer Vision (Numpy, Matplotlib, OpenCV). Решение задач Object...', 'contacts__1': None, 'apply_alternate_url__1': 'https://hh.ru/applicant/vacancy_response?vacancyId=104000699', 'working_time_intervals__1': None, 'response_letter_required__1': False, 'archived__1': False, 'employer_name__1': 'РэилМатик', 'vacancy_id__1': '104000699', 'department__1': None, 'employer_url__1': 'https://hh.ru/employer/2073159', 'vacancy_hash__1': '42c741e99166fe2495dd062685979629a053935b0f7c5b4165deff23431bd4b8' ... 6394 parameters truncated ... 'employment__189': 'Полная занятость', 'url__189': 'https://api.hh.ru/vacancies/101279533?host=hh.ru', 'schedule__189': 'Удаленная работа', 'accept_temporary__189': False, 'show_logo_in_search__189': True, 'experience__189': 'От 3 до 6 лет', 'premium__189': False, 'professional_roles__189': 'Программист, разработчик', 'area__189': 'Екатеринбург', 'salary_to__189': None, 'response_url__189': None, 'created_at__189': '2024-07-15T09:57:27+0300', 'snippet_responsibility__189': 'Naumen Contact Center - программная платформа для организации контакт-центров. Она обеспечивает работу телефонии, коммуникацию с клиентами в социальных сетях, мессенджерах...', 'published_at__189': '2024-07-15T09:57:27+0300', 'name__189': 'Senior C++ разработчик на продукт Naumen Contact Center', 'accept_incomplete_resumes__189': False, 'alternate_url__190': 'https://hh.ru/vacancy/102794788', 'type__190': 'Открытая', 'working_time_modes__190': None, 'sort_point_distance__190': None, 'has_test__190': False, 'snippet_requirement__190': 'Опыт работы с 1С системами в роли аналитика от 3х лет. Опыт работы с УТ в роли аналитика...', 'contacts__190': None, 'apply_alternate_url__190': 'https://hh.ru/applicant/vacancy_response?vacancyId=102794788', 'working_time_intervals__190': None, 'response_letter_required__190': False, 'archived__190': False, 'employer_name__190': 'Ракета', 'vacancy_id__190': '102794788', 'department__190': None, 'employer_url__190': 'https://hh.ru/employer/2501342', 'vacancy_hash__190': '695cea8f888792744354dac813fd83911d3dc5cccf6412a9dc706df53e7ef38a', 'working_days__190': None, 'salary_from__190': None, 'employment__190': 'Полная занятость', 'url__190': 'https://api.hh.ru/vacancies/102794788?host=hh.ru', 'schedule__190': 'Удаленная работа', 'accept_temporary__190': False, 'show_logo_in_search__190': None, 'experience__190': 'От 3 до 6 лет', 'premium__190': False, 'professional_roles__190': 'Системный аналитик', 'area__190': 'Екатеринбург', 'salary_to__190': None, 'response_url__190': None, 'created_at__190': '2024-07-14T17:27:46+0300', 'snippet_responsibility__190': 'Планирование этапности перевода функциональности в соответствии с принципами сохранения целостности ведения бизнес-процессов в системе. Формализация требований для <highlighttext>разработчиков</highlighttext>. ', 'published_at__190': '2024-07-14T17:27:46+0300', 'name__190': 'Аналитик 1С (УТ, ERP)', 'accept_incomplete_resumes__190': False}]\n(Background on this error at: https://sqlalche.me/e/20/f405)\n", "record": {"elapsed": {"repr": "0:00:09.879709", "seconds": 9.879709}, "exception": {"type": "ProgrammingError", "value": "(psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 150578 characters truncated ... %(accept_incomplete_resumes__190)s, %(experience__190)s, %(employment__190)s, %(vacancy_hash__190)s)]\n[parameters: {'alternate_url__0': 'https://hh.ru/vacancy/102978103', 'type__0': 'Открытая', 'working_time_modes__0': None, 'sort_point_distance__0': None, 'has_test__0': False, 'snippet_requirement__0': 'Знание языка программирования <highlighttext>Python</highlighttext>. Опыт работы с API. Понимание принципов алгоритмической торговли. Базовые знания в области блокчейн-технологий. ', 'contacts__0': None, 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=102978103', 'working_time_intervals__0': 'Можно работать сменами по\\xa04–6 часов в\\xa0день', 'response_letter_required__0': True, 'archived__0': False, 'employer_name__0': 'Smit&Co', 'vacancy_id__0': '102978103', 'department__0': None, 'employer_url__0': 'https://hh.ru/employer/4789182', 'vacancy_hash__0': '24a1e68192ea262701345f49ae0607c004c8356eedcd18ab8024240aaeda7ab9', 'working_days__0': None, 'salary_from__0': 50000.0, 'employment__0': 'Полная занятость', 'url__0': 'https://api.hh.ru/vacancies/102978103?host=hh.ru', 'schedule__0': 'Удаленная работа', 'accept_temporary__0': False, 'show_logo_in_search__0': None, 'experience__0': 'Нет опыта', 'premium__0': False, 'professional_roles__0': 'Программист, разработчик', 'area__0': 'Санкт-Петербург', 'salary_to__0': None, 'response_url__0': None, 'created_at__0': '2024-06-29T23:30:33+0300', 'snippet_responsibility__0': 'Написание кода по техническому заданию. Работа с API различных платформ для выполнения задач. Разработка алгоритмов для торговых стратегий фонда. ', 'published_at__0': '2024-06-29T23:30:33+0300', 'name__0': 'Программист-стажер в инвестиционный фонд', 'accept_incomplete_resumes__0': False, 'alternate_url__1': 'https://hh.ru/vacancy/104000699', 'type__1': 'Открытая', 'working_time_modes__1': None, 'sort_point_distance__1': None, 'has_test__1': False, 'snippet_requirement__1': 'Знание языка программирования <highlighttext>Python</highlighttext>. Опыт работы с базами данных (Mysql). Классические алгоритмы Computer Vision (Numpy, Matplotlib, OpenCV). Решение задач Object...', 'contacts__1': None, 'apply_alternate_url__1': 'https://hh.ru/applicant/vacancy_response?vacancyId=104000699', 'working_time_intervals__1': None, 'response_letter_required__1': False, 'archived__1': False, 'employer_name__1': 'РэилМатик', 'vacancy_id__1': '104000699', 'department__1': None, 'employer_url__1': 'https://hh.ru/employer/2073159', 'vacancy_hash__1': '42c741e99166fe2495dd062685979629a053935b0f7c5b4165deff23431bd4b8' ... 6394 parameters truncated ... 'employment__189': 'Полная занятость', 'url__189': 'https://api.hh.ru/vacancies/101279533?host=hh.ru', 'schedule__189': 'Удаленная работа', 'accept_temporary__189': False, 'show_logo_in_search__189': True, 'experience__189': 'От 3 до 6 лет', 'premium__189': False, 'professional_roles__189': 'Программист, разработчик', 'area__189': 'Екатеринбург', 'salary_to__189': None, 'response_url__189': None, 'created_at__189': '2024-07-15T09:57:27+0300', 'snippet_responsibility__189': 'Naumen Contact Center - программная платформа для организации контакт-центров. Она обеспечивает работу телефонии, коммуникацию с клиентами в социальных сетях, мессенджерах...', 'published_at__189': '2024-07-15T09:57:27+0300', 'name__189': 'Senior C++ разработчик на продукт Naumen Contact Center', 'accept_incomplete_resumes__189': False, 'alternate_url__190': 'https://hh.ru/vacancy/102794788', 'type__190': 'Открытая', 'working_time_modes__190': None, 'sort_point_distance__190': None, 'has_test__190': False, 'snippet_requirement__190': 'Опыт работы с 1С системами в роли аналитика от 3х лет. Опыт работы с УТ в роли аналитика...', 'contacts__190': None, 'apply_alternate_url__190': 'https://hh.ru/applicant/vacancy_response?vacancyId=102794788', 'working_time_intervals__190': None, 'response_letter_required__190': False, 'archived__190': False, 'employer_name__190': 'Ракета', 'vacancy_id__190': '102794788', 'department__190': None, 'employer_url__190': 'https://hh.ru/employer/2501342', 'vacancy_hash__190': '695cea8f888792744354dac813fd83911d3dc5cccf6412a9dc706df53e7ef38a', 'working_days__190': None, 'salary_from__190': None, 'employment__190': 'Полная занятость', 'url__190': 'https://api.hh.ru/vacancies/102794788?host=hh.ru', 'schedule__190': 'Удаленная работа', 'accept_temporary__190': False, 'show_logo_in_search__190': None, 'experience__190': 'От 3 до 6 лет', 'premium__190': False, 'professional_roles__190': 'Системный аналитик', 'area__190': 'Екатеринбург', 'salary_to__190': None, 'response_url__190': None, 'created_at__190': '2024-07-14T17:27:46+0300', 'snippet_responsibility__190': 'Планирование этапности перевода функциональности в соответствии с принципами сохранения целостности ведения бизнес-процессов в системе. Формализация требований для <highlighttext>разработчиков</highlighttext>. ', 'published_at__190': '2024-07-14T17:27:46+0300', 'name__190': 'Аналитик 1С (УТ, ERP)', 'accept_incomplete_resumes__190': False}]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 181, "message": "An error has been caught in function '<module>', process 'MainProcess' (1020), thread 'MainThread' (5236):", "module": "main", "name": "__main__", "process": {"id": 1020, "name": "MainProcess"}, "thread": {"id": 5236, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:36:26.846099+03:00", "timestamp": 1721212586.846099}}}
{"text": "2024-07-17T13:36:26.997441+0300 INFO Собрано 191 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:10.031051", "seconds": 10.031051}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 182, "message": "Собрано 191 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 1020, "name": "MainProcess"}, "thread": {"id": 5236, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:36:26.997441+03:00", "timestamp": 1721212586.997441}}}
{"text": "2024-07-17T13:38:39.441572+0300 INFO Собрано 155 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:02.013346", "seconds": 2.013346}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 155 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 1292, "name": "MainProcess"}, "thread": {"id": 6716, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:38:39.441572+03:00", "timestamp": 1721212719.441572}}}
{"text": "2024-07-17T13:38:56.060366+0300 INFO Собрано 155 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:01.978586", "seconds": 1.978586}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 155 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 9752, "name": "MainProcess"}, "thread": {"id": 10208, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:38:56.060366+03:00", "timestamp": 1721212736.060366}}}
{"text": "2024-07-17T13:38:59.521543+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.439763", "seconds": 5.439763}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 9752, "name": "MainProcess"}, "thread": {"id": 10208, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:38:59.521543+03:00", "timestamp": 1721212739.521543}}}
{"text": "2024-07-17T13:39:02.719860+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (9752), thread 'MainThread' (10208):\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 181, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_test': Fa...\n    └ <function save_to_db at 0x000002315E590900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 141, in save_to_db\n    vacancies_df.to_excel('data.xlsx', index=False)\n    │            └ <function NDFrame.to_excel at 0x000002315C5ECEA0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'index': False}\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    102978103  ...  24a1e68192ea262701345f49ae0607c0...\n           └ <function NDFrame.to_excel at 0x000002315C5ECF40>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 2417, in to_excel\n    formatter.write(\n    │         └ <function ExcelFormatter.write at 0x000002315EA19120>\n    └ <pandas.io.formats.excel.ExcelFormatter object at 0x000002315E99A9C0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\formats\\excel.py\", line 943, in write\n    writer = ExcelWriter(\n             └ <class 'pandas.io.excel._base.ExcelWriter'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\excel\\_openpyxl.py\", line 57, in __init__\n    from openpyxl.workbook import Workbook\n\nModuleNotFoundError: No module named 'openpyxl'\n", "record": {"elapsed": {"repr": "0:00:08.638080", "seconds": 8.63808}, "exception": {"type": "ModuleNotFoundError", "value": "No module named 'openpyxl'", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 181, "message": "An error has been caught in function '<module>', process 'MainProcess' (9752), thread 'MainThread' (10208):", "module": "main", "name": "__main__", "process": {"id": 9752, "name": "MainProcess"}, "thread": {"id": 10208, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:39:02.719860+03:00", "timestamp": 1721212742.71986}}}
{"text": "2024-07-17T13:39:02.899996+0300 INFO Собрано 191 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:08.818216", "seconds": 8.818216}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 182, "message": "Собрано 191 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 9752, "name": "MainProcess"}, "thread": {"id": 10208, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:39:02.899996+03:00", "timestamp": 1721212742.899996}}}
{"text": "2024-07-17T13:40:31.215980+0300 INFO Собрано 155 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:02.106750", "seconds": 2.10675}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 155 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 11532, "name": "MainProcess"}, "thread": {"id": 9760, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:40:31.215980+03:00", "timestamp": 1721212831.21598}}}
{"text": "2024-07-17T13:40:34.735190+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.625960", "seconds": 5.62596}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 11532, "name": "MainProcess"}, "thread": {"id": 9760, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:40:34.735190+03:00", "timestamp": 1721212834.73519}}}
{"text": "2024-07-17T13:40:38.912464+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (11532), thread 'MainThread' (9760):\nTraceback (most recent call last):\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x000001A911734C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001A9115FAE40>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'sort_point_distance__0': None, 'professional_roles__0': 'Программист, разработчик', 'archived__0': False, 'experience__0': ...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000001A911E334C0; closed: -1>\n\npsycopg2.ProgrammingError: can't adapt type 'dict'\n\n\nThe above exception was the direct cause of the following exception:\n\n\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 179, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_test': Fa...\n    └ <function save_to_db at 0x000001A9117C0900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 150, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False)\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x000001A90F72D4E0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False}\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    102978103  ...  24a1e68192ea262701345f49ae0607c0...\n           └ <function NDFrame.to_sql at 0x000001A90F72D3A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x000001A910A91620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x000001A910A931A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x000001A911C0BE30>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2018, in to_sql\n    total_inserted = sql_engine.insert_records(\n                     │          └ <function SQLAlchemyEngine.insert_records at 0x000001A910A92980>\n                     └ <pandas.io.sql.SQLAlchemyEngine object at 0x000001A911DEB740>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1567, in insert_records\n    raise err\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1558, in insert_records\n    return table.insert(chunksize=chunksize, method=method)\n           │     │                │                 └ None\n           │     │                └ None\n           │     └ <function SQLTable.insert at 0x000001A910A91DA0>\n           └ <pandas.io.sql.SQLTable object at 0x000001A911DEB6B0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1119, in insert\n    num_inserted = exec_insert(conn, keys, chunk_iter)\n                   │           │     │     └ <zip object at 0x000001A911E490C0>\n                   │           │     └ ['vacancy_id', 'premium', 'name', 'department', 'has_test', 'response_letter_required', 'area', 'salary_from', 'salary_to', '...\n                   │           └ <sqlalchemy.engine.base.Connection object at 0x000001A910E26BA0>\n                   └ <bound method SQLTable._execute_insert of <pandas.io.sql.SQLTable object at 0x000001A911DEB6B0>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1010, in _execute_insert\n    result = conn.execute(self.table.insert(), data)\n             │    │       │    │     │         └ [{'vacancy_id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_t...\n             │    │       │    │     └ <function TableClause.insert at 0x000001A911595300>\n             │    │       │    └ Table('stage_pars_hh', MetaData(), Column('vacancy_id', Text(), table=<stage_pars_hh>), Column('premium', Boolean(), table=<s...\n             │    │       └ <pandas.io.sql.SQLTable object at 0x000001A911DEB6B0>\n             │    └ <function Connection.execute at 0x000001A91167D440>\n             └ <sqlalchemy.engine.base.Connection object at 0x000001A910E26BA0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x000001A911E2BC50>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           │          └ <function Connection._execute_clauseelement at 0x000001A91167D760>\n           └ <sqlalchemy.engine.base.Connection object at 0x000001A910E26BA0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          │    └ <function Connection._execute_context at 0x000001A91167D940>\n          └ <sqlalchemy.engine.base.Connection object at 0x000001A910E26BA0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1844, in _execute_context\n    return self._exec_insertmany_context(dialect, context)\n           │    │                        │        └ <sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x000001A911E2BCE0>\n           │    │                        └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001A9115FAE40>\n           │    └ <function Connection._exec_insertmany_context at 0x000001A91167DA80>\n           └ <sqlalchemy.engine.base.Connection object at 0x000001A910E26BA0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2124, in _exec_insertmany_context\n    self._handle_dbapi_exception(\n    │    └ <function Connection._handle_dbapi_exception at 0x000001A91167DC60>\n    └ <sqlalchemy.engine.base.Connection object at 0x000001A910E26BA0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2353, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n          │                    │              │                 └ ProgrammingError(\"can't adapt type 'dict'\")\n          │                    │              └ (<class 'psycopg2.ProgrammingError'>, ProgrammingError(\"can't adapt type 'dict'\"), <traceback object at 0x000001A911F1C240>)\n          │                    └ <method 'with_traceback' of 'BaseException' objects>\n          └ ProgrammingError(\"(psycopg2.ProgrammingError) can't adapt type 'dict'\")\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x000001A911734C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001A9115FAE40>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'sort_point_distance__0': None, 'professional_roles__0': 'Программист, разработчик', 'archived__0': False, 'experience__0': ...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000001A911E334C0; closed: -1>\n\nsqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 150578 characters truncated ... %(accept_incomplete_resumes__190)s, %(experience__190)s, %(employment__190)s, %(vacancy_hash__190)s)]\n[parameters: {'sort_point_distance__0': None, 'professional_roles__0': 'Программист, разработчик', 'archived__0': False, 'experience__0': 'Нет опыта', 'salary_from__0': 50000.0, 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=102978103', 'name__0': 'Программист-стажер в инвестиционный фонд', 'salary_to__0': None, 'department__0': None, 'show_logo_in_search__0': None, 'working_days__0': None, 'response_url__0': None, 'accept_incomplete_resumes__0': False, 'created_at__0': '2024-06-29T23:30:33+0300', 'employer_name__0': 'Smit&Co', 'snippet_requirement__0': 'Знание языка программирования <highlighttext>Python</highlighttext>. Опыт работы с API. Понимание принципов алгоритмической торговли. Базовые знания в области блокчейн-технологий. ', 'type__0': 'Открытая', 'premium__0': False, 'employer_url__0': 'https://hh.ru/employer/4789182', 'area__0': 'Санкт-Петербург', 'has_test__0': False, 'contacts__0': None, 'vacancy_id__0': '102978103', 'response_letter_required__0': True, 'published_at__0': '2024-06-29T23:30:33+0300', 'url__0': 'https://api.hh.ru/vacancies/102978103?host=hh.ru', 'alternate_url__0': 'https://hh.ru/vacancy/102978103', 'vacancy_hash__0': '24a1e68192ea262701345f49ae0607c004c8356eedcd18ab8024240aaeda7ab9', 'schedule__0': 'Удаленная работа', 'employment__0': 'Полная занятость', 'working_time_modes__0': None, 'snippet_responsibility__0': 'Написание кода по техническому заданию. Работа с API различных платформ для выполнения задач. Разработка алгоритмов для торговых стратегий фонда. ', 'working_time_intervals__0': 'Можно работать сменами по\\xa04–6 часов в\\xa0день', 'accept_temporary__0': False, 'sort_point_distance__1': None, 'professional_roles__1': 'Другое', 'archived__1': False, 'experience__1': 'Нет опыта', 'salary_from__1': 47990.0, 'apply_alternate_url__1': 'https://hh.ru/applicant/vacancy_response?vacancyId=104008694', 'name__1': 'Удаленный менеджер (срочно, возможна подработка)', 'salary_to__1': None, 'department__1': None, 'show_logo_in_search__1': None, 'working_days__1': 'Работа только по\\xa0сб\\xa0и\\xa0вс', 'response_url__1': None, 'accept_incomplete_resumes__1': True, 'created_at__1': '2024-07-16T16:12:17+0300', 'employer_name__1': 'ТЭМП', 'snippet_requirement__1': 'У вас грамотная письменная речь. Умеете находить подход к людям. Любите много общаться по телефону. Наличие ПК/ноутбука, стабильного интернета...' ... 6394 parameters truncated ... 'employer_url__189': 'https://hh.ru/employer/42600', 'area__189': 'Екатеринбург', 'has_test__189': False, 'contacts__189': None, 'vacancy_id__189': '101279533', 'response_letter_required__189': False, 'published_at__189': '2024-07-15T09:57:27+0300', 'url__189': 'https://api.hh.ru/vacancies/101279533?host=hh.ru', 'alternate_url__189': 'https://hh.ru/vacancy/101279533', 'vacancy_hash__189': '2adaa4587d4f3a9f951eddb4e9a4d4e51807a43920862499892b905f697a9920', 'schedule__189': 'Удаленная работа', 'employment__189': 'Полная занятость', 'working_time_modes__189': None, 'snippet_responsibility__189': 'Naumen Contact Center - программная платформа для организации контакт-центров. Она обеспечивает работу телефонии, коммуникацию с клиентами в социальных сетях, мессенджерах...', 'working_time_intervals__189': None, 'accept_temporary__189': False, 'sort_point_distance__190': None, 'professional_roles__190': 'Системный аналитик', 'archived__190': False, 'experience__190': 'От 3 до 6 лет', 'salary_from__190': None, 'apply_alternate_url__190': 'https://hh.ru/applicant/vacancy_response?vacancyId=102794788', 'name__190': 'Аналитик 1С (УТ, ERP)', 'salary_to__190': None, 'department__190': None, 'show_logo_in_search__190': None, 'working_days__190': None, 'response_url__190': None, 'accept_incomplete_resumes__190': False, 'created_at__190': '2024-07-14T17:27:46+0300', 'employer_name__190': 'Ракета', 'snippet_requirement__190': 'Опыт работы с 1С системами в роли аналитика от 3х лет. Опыт работы с УТ в роли аналитика...', 'type__190': 'Открытая', 'premium__190': False, 'employer_url__190': 'https://hh.ru/employer/2501342', 'area__190': 'Екатеринбург', 'has_test__190': False, 'contacts__190': None, 'vacancy_id__190': '102794788', 'response_letter_required__190': False, 'published_at__190': '2024-07-14T17:27:46+0300', 'url__190': 'https://api.hh.ru/vacancies/102794788?host=hh.ru', 'alternate_url__190': 'https://hh.ru/vacancy/102794788', 'vacancy_hash__190': '695cea8f888792744354dac813fd83911d3dc5cccf6412a9dc706df53e7ef38a', 'schedule__190': 'Удаленная работа', 'employment__190': 'Полная занятость', 'working_time_modes__190': None, 'snippet_responsibility__190': 'Планирование этапности перевода функциональности в соответствии с принципами сохранения целостности ведения бизнес-процессов в системе. Формализация требований для <highlighttext>разработчиков</highlighttext>. ', 'working_time_intervals__190': None, 'accept_temporary__190': False}]\n(Background on this error at: https://sqlalche.me/e/20/f405)\n", "record": {"elapsed": {"repr": "0:00:09.803234", "seconds": 9.803234}, "exception": {"type": "ProgrammingError", "value": "(psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 150578 characters truncated ... %(accept_incomplete_resumes__190)s, %(experience__190)s, %(employment__190)s, %(vacancy_hash__190)s)]\n[parameters: {'sort_point_distance__0': None, 'professional_roles__0': 'Программист, разработчик', 'archived__0': False, 'experience__0': 'Нет опыта', 'salary_from__0': 50000.0, 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=102978103', 'name__0': 'Программист-стажер в инвестиционный фонд', 'salary_to__0': None, 'department__0': None, 'show_logo_in_search__0': None, 'working_days__0': None, 'response_url__0': None, 'accept_incomplete_resumes__0': False, 'created_at__0': '2024-06-29T23:30:33+0300', 'employer_name__0': 'Smit&Co', 'snippet_requirement__0': 'Знание языка программирования <highlighttext>Python</highlighttext>. Опыт работы с API. Понимание принципов алгоритмической торговли. Базовые знания в области блокчейн-технологий. ', 'type__0': 'Открытая', 'premium__0': False, 'employer_url__0': 'https://hh.ru/employer/4789182', 'area__0': 'Санкт-Петербург', 'has_test__0': False, 'contacts__0': None, 'vacancy_id__0': '102978103', 'response_letter_required__0': True, 'published_at__0': '2024-06-29T23:30:33+0300', 'url__0': 'https://api.hh.ru/vacancies/102978103?host=hh.ru', 'alternate_url__0': 'https://hh.ru/vacancy/102978103', 'vacancy_hash__0': '24a1e68192ea262701345f49ae0607c004c8356eedcd18ab8024240aaeda7ab9', 'schedule__0': 'Удаленная работа', 'employment__0': 'Полная занятость', 'working_time_modes__0': None, 'snippet_responsibility__0': 'Написание кода по техническому заданию. Работа с API различных платформ для выполнения задач. Разработка алгоритмов для торговых стратегий фонда. ', 'working_time_intervals__0': 'Можно работать сменами по\\xa04–6 часов в\\xa0день', 'accept_temporary__0': False, 'sort_point_distance__1': None, 'professional_roles__1': 'Другое', 'archived__1': False, 'experience__1': 'Нет опыта', 'salary_from__1': 47990.0, 'apply_alternate_url__1': 'https://hh.ru/applicant/vacancy_response?vacancyId=104008694', 'name__1': 'Удаленный менеджер (срочно, возможна подработка)', 'salary_to__1': None, 'department__1': None, 'show_logo_in_search__1': None, 'working_days__1': 'Работа только по\\xa0сб\\xa0и\\xa0вс', 'response_url__1': None, 'accept_incomplete_resumes__1': True, 'created_at__1': '2024-07-16T16:12:17+0300', 'employer_name__1': 'ТЭМП', 'snippet_requirement__1': 'У вас грамотная письменная речь. Умеете находить подход к людям. Любите много общаться по телефону. Наличие ПК/ноутбука, стабильного интернета...' ... 6394 parameters truncated ... 'employer_url__189': 'https://hh.ru/employer/42600', 'area__189': 'Екатеринбург', 'has_test__189': False, 'contacts__189': None, 'vacancy_id__189': '101279533', 'response_letter_required__189': False, 'published_at__189': '2024-07-15T09:57:27+0300', 'url__189': 'https://api.hh.ru/vacancies/101279533?host=hh.ru', 'alternate_url__189': 'https://hh.ru/vacancy/101279533', 'vacancy_hash__189': '2adaa4587d4f3a9f951eddb4e9a4d4e51807a43920862499892b905f697a9920', 'schedule__189': 'Удаленная работа', 'employment__189': 'Полная занятость', 'working_time_modes__189': None, 'snippet_responsibility__189': 'Naumen Contact Center - программная платформа для организации контакт-центров. Она обеспечивает работу телефонии, коммуникацию с клиентами в социальных сетях, мессенджерах...', 'working_time_intervals__189': None, 'accept_temporary__189': False, 'sort_point_distance__190': None, 'professional_roles__190': 'Системный аналитик', 'archived__190': False, 'experience__190': 'От 3 до 6 лет', 'salary_from__190': None, 'apply_alternate_url__190': 'https://hh.ru/applicant/vacancy_response?vacancyId=102794788', 'name__190': 'Аналитик 1С (УТ, ERP)', 'salary_to__190': None, 'department__190': None, 'show_logo_in_search__190': None, 'working_days__190': None, 'response_url__190': None, 'accept_incomplete_resumes__190': False, 'created_at__190': '2024-07-14T17:27:46+0300', 'employer_name__190': 'Ракета', 'snippet_requirement__190': 'Опыт работы с 1С системами в роли аналитика от 3х лет. Опыт работы с УТ в роли аналитика...', 'type__190': 'Открытая', 'premium__190': False, 'employer_url__190': 'https://hh.ru/employer/2501342', 'area__190': 'Екатеринбург', 'has_test__190': False, 'contacts__190': None, 'vacancy_id__190': '102794788', 'response_letter_required__190': False, 'published_at__190': '2024-07-14T17:27:46+0300', 'url__190': 'https://api.hh.ru/vacancies/102794788?host=hh.ru', 'alternate_url__190': 'https://hh.ru/vacancy/102794788', 'vacancy_hash__190': '695cea8f888792744354dac813fd83911d3dc5cccf6412a9dc706df53e7ef38a', 'schedule__190': 'Удаленная работа', 'employment__190': 'Полная занятость', 'working_time_modes__190': None, 'snippet_responsibility__190': 'Планирование этапности перевода функциональности в соответствии с принципами сохранения целостности ведения бизнес-процессов в системе. Формализация требований для <highlighttext>разработчиков</highlighttext>. ', 'working_time_intervals__190': None, 'accept_temporary__190': False}]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 179, "message": "An error has been caught in function '<module>', process 'MainProcess' (11532), thread 'MainThread' (9760):", "module": "main", "name": "__main__", "process": {"id": 11532, "name": "MainProcess"}, "thread": {"id": 9760, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:40:38.912464+03:00", "timestamp": 1721212838.912464}}}
{"text": "2024-07-17T13:40:39.141856+0300 INFO Собрано 191 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:10.032626", "seconds": 10.032626}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 180, "message": "Собрано 191 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 11532, "name": "MainProcess"}, "thread": {"id": 9760, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:40:39.141856+03:00", "timestamp": 1721212839.141856}}}
{"text": "2024-07-17T13:52:52.962844+0300 INFO Собрано 155 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:02.339992", "seconds": 2.339992}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 155 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 7520, "name": "MainProcess"}, "thread": {"id": 7144, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:52:52.962844+03:00", "timestamp": 1721213572.962844}}}
{"text": "2024-07-17T13:52:56.382914+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.760062", "seconds": 5.760062}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 7520, "name": "MainProcess"}, "thread": {"id": 7144, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:52:56.382914+03:00", "timestamp": 1721213576.382914}}}
{"text": "2024-07-17T13:52:59.491946+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (7520), thread 'MainThread' (7144):\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 259, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_test': Fa...\n    └ <function save_to_db at 0x000001D828630900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 101, in save_to_db\n    vacancies_df = vacancies_df.astype({\n                   │            └ <function NDFrame.astype at 0x000001D826538360>\n                   └             id  premium  ... adv_context                            branding\n                     0    102978103    False  ...        None        ...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 6605, in astype\n    raise KeyError(\n\nKeyError: \"Only a column name can be used for the key in a dtype mappings argument. 'vacancy_id' not found in columns.\"\n", "record": {"elapsed": {"repr": "0:00:08.869094", "seconds": 8.869094}, "exception": {"type": "KeyError", "value": "\"Only a column name can be used for the key in a dtype mappings argument. 'vacancy_id' not found in columns.\"", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 259, "message": "An error has been caught in function '<module>', process 'MainProcess' (7520), thread 'MainThread' (7144):", "module": "main", "name": "__main__", "process": {"id": 7520, "name": "MainProcess"}, "thread": {"id": 7144, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:52:59.491946+03:00", "timestamp": 1721213579.491946}}}
{"text": "2024-07-17T13:52:59.757275+0300 INFO Собрано 191 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:09.134423", "seconds": 9.134423}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 260, "message": "Собрано 191 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 7520, "name": "MainProcess"}, "thread": {"id": 7144, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:52:59.757275+03:00", "timestamp": 1721213579.757275}}}
{"text": "2024-07-17T13:54:02.223911+0300 INFO Собрано 155 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:02.183564", "seconds": 2.183564}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 155 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 2388, "name": "MainProcess"}, "thread": {"id": 2596, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:54:02.223911+03:00", "timestamp": 1721213642.223911}}}
{"text": "2024-07-17T13:54:05.658790+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.618443", "seconds": 5.618443}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 2388, "name": "MainProcess"}, "thread": {"id": 2596, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:54:05.658790+03:00", "timestamp": 1721213645.65879}}}
{"text": "2024-07-17T13:54:08.789723+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (2388), thread 'MainThread' (2596):\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 302, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_test': Fa...\n    └ <function save_to_db at 0x000001A560530900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 144, in save_to_db\n    vacancies_df = vacancies_df.astype({\n                   │            └ <function NDFrame.astype at 0x000001A55E53C360>\n                   └     vacancy_id  ...                                       vacancy_hash\n                     0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 6605, in astype\n    raise KeyError(\n\nKeyError: \"Only a column name can be used for the key in a dtype mappings argument. 'adv_response_url' not found in columns.\"\n", "record": {"elapsed": {"repr": "0:00:08.749376", "seconds": 8.749376}, "exception": {"type": "KeyError", "value": "\"Only a column name can be used for the key in a dtype mappings argument. 'adv_response_url' not found in columns.\"", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 302, "message": "An error has been caught in function '<module>', process 'MainProcess' (2388), thread 'MainThread' (2596):", "module": "main", "name": "__main__", "process": {"id": 2388, "name": "MainProcess"}, "thread": {"id": 2596, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:54:08.789723+03:00", "timestamp": 1721213648.789723}}}
{"text": "2024-07-17T13:54:08.904746+0300 INFO Собрано 191 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:08.864399", "seconds": 8.864399}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 303, "message": "Собрано 191 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 2388, "name": "MainProcess"}, "thread": {"id": 2596, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:54:08.904746+03:00", "timestamp": 1721213648.904746}}}
{"text": "2024-07-17T13:55:09.522497+0300 INFO Собрано 155 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:01.890886", "seconds": 1.890886}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 155 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 13984, "name": "MainProcess"}, "thread": {"id": 7472, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:55:09.522497+03:00", "timestamp": 1721213709.522497}}}
{"text": "2024-07-17T13:55:13.115780+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.484169", "seconds": 5.484169}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 13984, "name": "MainProcess"}, "thread": {"id": 7472, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:55:13.115780+03:00", "timestamp": 1721213713.11578}}}
{"text": "2024-07-17T13:55:16.253057+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (13984), thread 'MainThread' (7472):\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 298, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_test': Fa...\n    └ <function save_to_db at 0x000001DBC16D0900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 142, in save_to_db\n    vacancies_df = vacancies_df.astype({\n                   │            └ <function NDFrame.astype at 0x000001DBBF61C360>\n                   └     vacancy_id  ...                                       vacancy_hash\n                     0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 6620, in astype\n    res_col = col.astype(dtype=cdt, copy=copy, errors=errors)\n              │   │            │         │            └ 'raise'\n              │   │            │         └ None\n              │   │            └ <class 'float'>\n              │   └ <function NDFrame.astype at 0x000001DBBF61C360>\n              └ 0      2024-06-29T23:30:33+0300\n                1      2024-07-16T16:12:17+0300\n                2      2024-07-16T14:44:20+0300\n                3      2024-07-11T15:15:21+03...\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 6643, in astype\n    new_data = self._mgr.astype(dtype=dtype, copy=copy, errors=errors)\n               │    │    │            │           │            └ 'raise'\n               │    │    │            │           └ None\n               │    │    │            └ <class 'float'>\n               │    │    └ <function BaseBlockManager.astype at 0x000001DBBF478C20>\n               │    └ SingleBlockManager\n               │      Items: RangeIndex(start=0, stop=191, step=1)\n               │      NumpyBlock: 191 dtype: object\n               └ 0      2024-06-29T23:30:33+0300\n                 1      2024-07-16T16:12:17+0300\n                 2      2024-07-16T14:44:20+0300\n                 3      2024-07-11T15:15:21+03...\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\internals\\managers.py\", line 430, in astype\n    return self.apply(\n           │    └ <function BaseBlockManager.apply at 0x000001DBBF478A40>\n           └ SingleBlockManager\n             Items: RangeIndex(start=0, stop=191, step=1)\n             NumpyBlock: 191 dtype: object\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\internals\\managers.py\", line 363, in apply\n    applied = getattr(b, f)(**kwargs)\n                      │  │    └ {'dtype': <class 'float'>, 'copy': True, 'errors': 'raise', 'using_cow': False}\n                      │  └ 'astype'\n                      └ NumpyBlock: 191 dtype: object\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\internals\\blocks.py\", line 758, in astype\n    new_values = astype_array_safe(values, dtype, copy=copy, errors=errors)\n                 │                 │       │           │            └ 'raise'\n                 │                 │       │           └ True\n                 │                 │       └ <class 'float'>\n                 │                 └ array(['2024-06-29T23:30:33+0300', '2024-07-16T16:12:17+0300',\n                 │                          '2024-07-16T14:44:20+0300', '2024-07-11T15:15:21+0300',...\n                 └ <function astype_array_safe at 0x000001DBBE6E4220>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\dtypes\\astype.py\", line 237, in astype_array_safe\n    new_values = astype_array(values, dtype, copy=copy)\n                 │            │       │           └ True\n                 │            │       └ dtype('float64')\n                 │            └ array(['2024-06-29T23:30:33+0300', '2024-07-16T16:12:17+0300',\n                 │                     '2024-07-16T14:44:20+0300', '2024-07-11T15:15:21+0300',...\n                 └ <function astype_array at 0x000001DBBE6E4180>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\dtypes\\astype.py\", line 182, in astype_array\n    values = _astype_nansafe(values, dtype, copy=copy)\n             │               │       │           └ True\n             │               │       └ dtype('float64')\n             │               └ array(['2024-06-29T23:30:33+0300', '2024-07-16T16:12:17+0300',\n             │                        '2024-07-16T14:44:20+0300', '2024-07-11T15:15:21+0300',...\n             └ <function _astype_nansafe at 0x000001DBBE6E4040>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\dtypes\\astype.py\", line 133, in _astype_nansafe\n    return arr.astype(dtype, copy=True)\n           │   │      └ dtype('float64')\n           │   └ <method 'astype' of 'numpy.ndarray' objects>\n           └ array(['2024-06-29T23:30:33+0300', '2024-07-16T16:12:17+0300',\n                    '2024-07-16T14:44:20+0300', '2024-07-11T15:15:21+0300',...\n\nValueError: could not convert string to float: '2024-06-29T23:30:33+0300': Error while type casting for column 'published_at'\n", "record": {"elapsed": {"repr": "0:00:08.621446", "seconds": 8.621446}, "exception": {"type": "ValueError", "value": "could not convert string to float: '2024-06-29T23:30:33+0300': Error while type casting for column 'published_at'", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 298, "message": "An error has been caught in function '<module>', process 'MainProcess' (13984), thread 'MainThread' (7472):", "module": "main", "name": "__main__", "process": {"id": 13984, "name": "MainProcess"}, "thread": {"id": 7472, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:55:16.253057+03:00", "timestamp": 1721213716.253057}}}
{"text": "2024-07-17T13:55:16.486480+0300 INFO Собрано 191 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:08.854869", "seconds": 8.854869}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 299, "message": "Собрано 191 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 13984, "name": "MainProcess"}, "thread": {"id": 7472, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:55:16.486480+03:00", "timestamp": 1721213716.48648}}}
{"text": "2024-07-17T13:57:16.873401+0300 INFO Собрано 155 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:01.946668", "seconds": 1.946668}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 155 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 14504, "name": "MainProcess"}, "thread": {"id": 3548, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:57:16.873401+03:00", "timestamp": 1721213836.873401}}}
{"text": "2024-07-17T13:57:20.322329+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.395596", "seconds": 5.395596}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 14504, "name": "MainProcess"}, "thread": {"id": 3548, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:57:20.322329+03:00", "timestamp": 1721213840.322329}}}
{"text": "2024-07-17T13:57:24.270788+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (14504), thread 'MainThread' (3548):\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 298, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_test': Fa...\n    └ <function save_to_db at 0x000002CFFB3C0900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 179, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False, dtype={\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x000002CFF93A54E0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False, 'dtype': {'vacancy_id': <class 'str'>, 'premium': <class 'bool'>, 'name': <class 'str...\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    102978103  ...  24a1e68192ea262701345f49ae0607c0...\n           └ <function NDFrame.to_sql at 0x000002CFF93A53A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x000002CFFA701620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x000002CFFA7031A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x000002CFFB7B7E60>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2008, in to_sql\n    table = self.prep_table(\n            │    └ <function SQLDatabase.prep_table at 0x000002CFFA703060>\n            └ <pandas.io.sql.SQLDatabase object at 0x000002CFFB7B7E60>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1900, in prep_table\n    raise ValueError(f\"The type of {col} is not a SQLAlchemy type\")\n                                    └ 'vacancy_id'\n\nValueError: The type of vacancy_id is not a SQLAlchemy type\n", "record": {"elapsed": {"repr": "0:00:09.344055", "seconds": 9.344055}, "exception": {"type": "ValueError", "value": "The type of vacancy_id is not a SQLAlchemy type", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 298, "message": "An error has been caught in function '<module>', process 'MainProcess' (14504), thread 'MainThread' (3548):", "module": "main", "name": "__main__", "process": {"id": 14504, "name": "MainProcess"}, "thread": {"id": 3548, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:57:24.270788+03:00", "timestamp": 1721213844.270788}}}
{"text": "2024-07-17T13:57:24.452151+0300 INFO Собрано 191 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:09.525418", "seconds": 9.525418}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 299, "message": "Собрано 191 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 14504, "name": "MainProcess"}, "thread": {"id": 3548, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:57:24.452151+03:00", "timestamp": 1721213844.452151}}}
{"text": "2024-07-17T13:59:28.692653+0300 INFO Собрано 155 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:02.369206", "seconds": 2.369206}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 155 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 12208, "name": "MainProcess"}, "thread": {"id": 11128, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:59:28.692653+03:00", "timestamp": 1721213968.692653}}}
{"text": "2024-07-17T13:59:32.189162+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.865715", "seconds": 5.865715}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 12208, "name": "MainProcess"}, "thread": {"id": 11128, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:59:32.189162+03:00", "timestamp": 1721213972.189162}}}
{"text": "2024-07-17T13:59:36.083917+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (12208), thread 'MainThread' (11128):\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 298, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_test': Fa...\n    └ <function save_to_db at 0x00000247CEEE0900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 179, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False, dtype={\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x00000247CCE454E0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False, 'dtype': {'vacancy_id': <class 'str'>, 'premium': <class 'bool'>, 'name': <class 'str...\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    102978103  ...  24a1e68192ea262701345f49ae0607c0...\n           └ <function NDFrame.to_sql at 0x00000247CCE453A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x00000247CE1A1620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x00000247CE1A31A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x00000247CEECE540>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2008, in to_sql\n    table = self.prep_table(\n            │    └ <function SQLDatabase.prep_table at 0x00000247CE1A3060>\n            └ <pandas.io.sql.SQLDatabase object at 0x00000247CEECE540>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1900, in prep_table\n    raise ValueError(f\"The type of {col} is not a SQLAlchemy type\")\n                                    └ 'vacancy_id'\n\nValueError: The type of vacancy_id is not a SQLAlchemy type\n", "record": {"elapsed": {"repr": "0:00:09.760470", "seconds": 9.76047}, "exception": {"type": "ValueError", "value": "The type of vacancy_id is not a SQLAlchemy type", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 298, "message": "An error has been caught in function '<module>', process 'MainProcess' (12208), thread 'MainThread' (11128):", "module": "main", "name": "__main__", "process": {"id": 12208, "name": "MainProcess"}, "thread": {"id": 11128, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:59:36.083917+03:00", "timestamp": 1721213976.083917}}}
{"text": "2024-07-17T13:59:36.237538+0300 INFO Собрано 191 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:09.914091", "seconds": 9.914091}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 299, "message": "Собрано 191 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 12208, "name": "MainProcess"}, "thread": {"id": 11128, "name": "MainThread"}, "time": {"repr": "2024-07-17 13:59:36.237538+03:00", "timestamp": 1721213976.237538}}}
{"text": "2024-07-17T14:07:31.314490+0300 INFO Собрано 154 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:02.371876", "seconds": 2.371876}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 154 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 10428, "name": "MainProcess"}, "thread": {"id": 604, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:07:31.314490+03:00", "timestamp": 1721214451.31449}}}
{"text": "2024-07-17T14:07:34.736203+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.793589", "seconds": 5.793589}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 10428, "name": "MainProcess"}, "thread": {"id": 604, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:07:34.736203+03:00", "timestamp": 1721214454.736203}}}
{"text": "2024-07-17T14:07:37.842670+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (10428), thread 'MainThread' (604):\nTraceback (most recent call last):\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py\", line 3805, in get_loc\n    return self._engine.get_loc(casted_key)\n           │    │               └ 'id'\n           │    └ <pandas._libs.properties.CachedProperty object at 0x00000298333F84C0>\n           └ Index(['vacancy_id', 'premium', 'name', 'department', 'has_test',\n                    'response_letter_required', 'area', 'salary_from', '...\n  File \"index.pyx\", line 167, in pandas._libs.index.IndexEngine.get_loc\n  File \"index.pyx\", line 196, in pandas._libs.index.IndexEngine.get_loc\n  File \"pandas\\\\_libs\\\\hashtable_class_helper.pxi\", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item\n  File \"pandas\\\\_libs\\\\hashtable_class_helper.pxi\", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item\n\nKeyError: 'id'\n\n\nThe above exception was the direct cause of the following exception:\n\n\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 299, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_test': Fa...\n    └ <function save_to_db at 0x00000298356C0900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 140, in save_to_db\n    print(vacancies_df['id'])\n          └     vacancy_id  ...                                       vacancy_hash\n            0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\frame.py\", line 4102, in __getitem__\n    indexer = self.columns.get_loc(key)\n              │    │               └ 'id'\n              │    └ <pandas._libs.properties.AxisProperty object at 0x000002983368A3E0>\n              └     vacancy_id  ...                                       vacancy_hash\n                0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py\", line 3812, in get_loc\n    raise KeyError(key) from err\n                   └ 'id'\n\nKeyError: 'id'\n", "record": {"elapsed": {"repr": "0:00:08.900056", "seconds": 8.900056}, "exception": {"type": "KeyError", "value": "'id'", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 299, "message": "An error has been caught in function '<module>', process 'MainProcess' (10428), thread 'MainThread' (604):", "module": "main", "name": "__main__", "process": {"id": 10428, "name": "MainProcess"}, "thread": {"id": 604, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:07:37.842670+03:00", "timestamp": 1721214457.84267}}}
{"text": "2024-07-17T14:07:38.038083+0300 INFO Собрано 190 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:09.095469", "seconds": 9.095469}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 300, "message": "Собрано 190 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 10428, "name": "MainProcess"}, "thread": {"id": 604, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:07:38.038083+03:00", "timestamp": 1721214458.038083}}}
{"text": "2024-07-17T14:08:38.129956+0300 INFO Собрано 154 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:01.880617", "seconds": 1.880617}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 154 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 11904, "name": "MainProcess"}, "thread": {"id": 14168, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:08:38.129956+03:00", "timestamp": 1721214518.129956}}}
{"text": "2024-07-17T14:08:41.516489+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.267150", "seconds": 5.26715}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 11904, "name": "MainProcess"}, "thread": {"id": 14168, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:08:41.516489+03:00", "timestamp": 1721214521.516489}}}
{"text": "2024-07-17T14:08:45.426590+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (11904), thread 'MainThread' (14168):\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 299, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_test': Fa...\n    └ <function save_to_db at 0x000001ED81190900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 180, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False, dtype={\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x000001EDFF1254E0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False, 'dtype': {'vacancy_id': <class 'str'>, 'premium': <class 'bool'>, 'name': <class 'str...\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    102978103  ...  24a1e68192ea262701345f49ae0607c0...\n           └ <function NDFrame.to_sql at 0x000001EDFF1253A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x000001EDFF4B1620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x000001EDFF4B31A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x000001ED81757E60>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2008, in to_sql\n    table = self.prep_table(\n            │    └ <function SQLDatabase.prep_table at 0x000001EDFF4B3060>\n            └ <pandas.io.sql.SQLDatabase object at 0x000001ED81757E60>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1900, in prep_table\n    raise ValueError(f\"The type of {col} is not a SQLAlchemy type\")\n                                    └ 'vacancy_id'\n\nValueError: The type of vacancy_id is not a SQLAlchemy type\n", "record": {"elapsed": {"repr": "0:00:09.177251", "seconds": 9.177251}, "exception": {"type": "ValueError", "value": "The type of vacancy_id is not a SQLAlchemy type", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 299, "message": "An error has been caught in function '<module>', process 'MainProcess' (11904), thread 'MainThread' (14168):", "module": "main", "name": "__main__", "process": {"id": 11904, "name": "MainProcess"}, "thread": {"id": 14168, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:08:45.426590+03:00", "timestamp": 1721214525.42659}}}
{"text": "2024-07-17T14:08:45.573146+0300 INFO Собрано 190 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:09.323807", "seconds": 9.323807}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 300, "message": "Собрано 190 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 11904, "name": "MainProcess"}, "thread": {"id": 14168, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:08:45.573146+03:00", "timestamp": 1721214525.573146}}}
{"text": "2024-07-17T14:09:32.122778+0300 INFO Собрано 154 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:02.142351", "seconds": 2.142351}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 154 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 6568, "name": "MainProcess"}, "thread": {"id": 12640, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:09:32.122778+03:00", "timestamp": 1721214572.122778}}}
{"text": "2024-07-17T14:09:35.513596+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.533169", "seconds": 5.533169}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 6568, "name": "MainProcess"}, "thread": {"id": 12640, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:09:35.513596+03:00", "timestamp": 1721214575.513596}}}
{"text": "2024-07-17T14:09:39.368543+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (6568), thread 'MainThread' (12640):\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 299, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_test': Fa...\n    └ <function save_to_db at 0x000001860E7D0900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 180, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False, dtype={\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x000001860C7154E0>\n    └       vacancy_id  ...                                       vacancy_hash\n      0    102978103.0  ...  24a1e68192ea262701345f49ae060...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False, 'dtype': {'vacancy_id': <class 'float'>, 'premium': <class 'bool'>, 'name': <class 's...\n           │     └ (      vacancy_id  ...                                       vacancy_hash\n           │       0    102978103.0  ...  24a1e68192ea262701345f49ae06...\n           └ <function NDFrame.to_sql at 0x000001860C7153A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x000001860DA71620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x000001860DA731A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x000001860C6C9EB0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2008, in to_sql\n    table = self.prep_table(\n            │    └ <function SQLDatabase.prep_table at 0x000001860DA73060>\n            └ <pandas.io.sql.SQLDatabase object at 0x000001860C6C9EB0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1900, in prep_table\n    raise ValueError(f\"The type of {col} is not a SQLAlchemy type\")\n                                    └ 'vacancy_id'\n\nValueError: The type of vacancy_id is not a SQLAlchemy type\n", "record": {"elapsed": {"repr": "0:00:09.388116", "seconds": 9.388116}, "exception": {"type": "ValueError", "value": "The type of vacancy_id is not a SQLAlchemy type", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 299, "message": "An error has been caught in function '<module>', process 'MainProcess' (6568), thread 'MainThread' (12640):", "module": "main", "name": "__main__", "process": {"id": 6568, "name": "MainProcess"}, "thread": {"id": 12640, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:09:39.368543+03:00", "timestamp": 1721214579.368543}}}
{"text": "2024-07-17T14:09:39.502218+0300 INFO Собрано 190 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:09.521791", "seconds": 9.521791}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 300, "message": "Собрано 190 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 6568, "name": "MainProcess"}, "thread": {"id": 12640, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:09:39.502218+03:00", "timestamp": 1721214579.502218}}}
{"text": "2024-07-17T14:15:43.149845+0300 INFO Собрано 154 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:02.012135", "seconds": 2.012135}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 154 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 11572, "name": "MainProcess"}, "thread": {"id": 6056, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:15:43.149845+03:00", "timestamp": 1721214943.149845}}}
{"text": "2024-07-17T14:15:46.607939+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.470229", "seconds": 5.470229}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 11572, "name": "MainProcess"}, "thread": {"id": 6056, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:15:46.607939+03:00", "timestamp": 1721214946.607939}}}
{"text": "2024-07-17T14:15:50.875765+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (11572), thread 'MainThread' (6056):\nTraceback (most recent call last):\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x000001FB795ACC20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001FB79BAFE90>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'archived__0': False, 'salary_from__0': 50000.0, 'has_test__0': False, 'url__0': 'https://api.hh.ru/vacancies/102978103?host...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000001FB79C8AB20; closed: -1>\n\npsycopg2.ProgrammingError: can't adapt type 'dict'\n\n\nThe above exception was the direct cause of the following exception:\n\n\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 263, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_test': Fa...\n    └ <function save_to_db at 0x000001FB79630900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 179, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False, dtype=dtype)\n    │            │      │           │                                              └ {'vacancy_id': VARCHAR(), 'premium': BOOLEAN(), 'name': VARCHAR(), 'department': VARCHAR(), 'has_test': BOOLEAN(), 'response_...\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x000001FB776054E0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False, 'dtype': {'vacancy_id': VARCHAR(), 'premium': BOOLEAN(), 'name': VARCHAR(), 'departme...\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    102978103  ...  24a1e68192ea262701345f49ae0607c0...\n           └ <function NDFrame.to_sql at 0x000001FB776053A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x000001FB77991620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x000001FB779931A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x000001FB79C4D610>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2018, in to_sql\n    total_inserted = sql_engine.insert_records(\n                     │          └ <function SQLAlchemyEngine.insert_records at 0x000001FB77992980>\n                     └ <pandas.io.sql.SQLAlchemyEngine object at 0x000001FB79C4E930>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1567, in insert_records\n    raise err\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1558, in insert_records\n    return table.insert(chunksize=chunksize, method=method)\n           │     │                │                 └ None\n           │     │                └ None\n           │     └ <function SQLTable.insert at 0x000001FB77991DA0>\n           └ <pandas.io.sql.SQLTable object at 0x000001FB7939B020>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1119, in insert\n    num_inserted = exec_insert(conn, keys, chunk_iter)\n                   │           │     │     └ <zip object at 0x000001FB79C87340>\n                   │           │     └ ['vacancy_id', 'premium', 'name', 'department', 'has_test', 'response_letter_required', 'area', 'salary_from', 'salary_to', '...\n                   │           └ <sqlalchemy.engine.base.Connection object at 0x000001FB79C4D730>\n                   └ <bound method SQLTable._execute_insert of <pandas.io.sql.SQLTable object at 0x000001FB7939B020>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1010, in _execute_insert\n    result = conn.execute(self.table.insert(), data)\n             │    │       │    │     │         └ [{'vacancy_id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_t...\n             │    │       │    │     └ <function TableClause.insert at 0x000001FB79409300>\n             │    │       │    └ Table('stage_pars_hh', MetaData(), Column('vacancy_id', VARCHAR(), table=<stage_pars_hh>), Column('premium', BOOLEAN(), table...\n             │    │       └ <pandas.io.sql.SQLTable object at 0x000001FB7939B020>\n             │    └ <function Connection.execute at 0x000001FB794F1440>\n             └ <sqlalchemy.engine.base.Connection object at 0x000001FB79C4D730>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x000001FB79C8EDB0>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           │          └ <function Connection._execute_clauseelement at 0x000001FB794F1760>\n           └ <sqlalchemy.engine.base.Connection object at 0x000001FB79C4D730>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          │    └ <function Connection._execute_context at 0x000001FB794F1940>\n          └ <sqlalchemy.engine.base.Connection object at 0x000001FB79C4D730>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1844, in _execute_context\n    return self._exec_insertmany_context(dialect, context)\n           │    │                        │        └ <sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x000001FB79C8EEA0>\n           │    │                        └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001FB79BAFE90>\n           │    └ <function Connection._exec_insertmany_context at 0x000001FB794F1A80>\n           └ <sqlalchemy.engine.base.Connection object at 0x000001FB79C4D730>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2124, in _exec_insertmany_context\n    self._handle_dbapi_exception(\n    │    └ <function Connection._handle_dbapi_exception at 0x000001FB794F1C60>\n    └ <sqlalchemy.engine.base.Connection object at 0x000001FB79C4D730>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2353, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n          │                    │              │                 └ ProgrammingError(\"can't adapt type 'dict'\")\n          │                    │              └ (<class 'psycopg2.ProgrammingError'>, ProgrammingError(\"can't adapt type 'dict'\"), <traceback object at 0x000001FB79DABFC0>)\n          │                    └ <method 'with_traceback' of 'BaseException' objects>\n          └ ProgrammingError(\"(psycopg2.ProgrammingError) can't adapt type 'dict'\")\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x000001FB795ACC20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001FB79BAFE90>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'archived__0': False, 'salary_from__0': 50000.0, 'has_test__0': False, 'url__0': 'https://api.hh.ru/vacancies/102978103?host...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000001FB79C8AB20; closed: -1>\n\nsqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 149771 characters truncated ... %(accept_incomplete_resumes__189)s, %(experience__189)s, %(employment__189)s, %(vacancy_hash__189)s)]\n[parameters: {'archived__0': False, 'salary_from__0': 50000.0, 'has_test__0': False, 'url__0': 'https://api.hh.ru/vacancies/102978103?host=hh.ru', 'contacts__0': None, 'vacancy_id__0': '102978103', 'accept_incomplete_resumes__0': False, 'premium__0': False, 'working_days__0': None, 'employer_url__0': 'https://hh.ru/employer/4789182', 'vacancy_hash__0': '24a1e68192ea262701345f49ae0607c004c8356eedcd18ab8024240aaeda7ab9', 'sort_point_distance__0': None, 'employer_name__0': 'Smit&Co', 'response_url__0': None, 'published_at__0': '2024-06-29T23:30:33+0300', 'name__0': 'Программист-стажер в инвестиционный фонд', 'area__0': 'Санкт-Петербург', 'working_time_intervals__0': 'Можно работать сменами по\\xa04–6 часов в\\xa0день', 'experience__0': 'Нет опыта', 'salary_to__0': None, 'professional_roles__0': 'Программист, разработчик', 'response_letter_required__0': True, 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=102978103', 'working_time_modes__0': None, 'accept_temporary__0': False, 'created_at__0': '2024-06-29T23:30:33+0300', 'employment__0': 'Полная занятость', 'department__0': None, 'snippet_responsibility__0': 'Написание кода по техническому заданию. Работа с API различных платформ для выполнения задач. Разработка алгоритмов для торговых стратегий фонда. ', 'snippet_requirement__0': 'Знание языка программирования <highlighttext>Python</highlighttext>. Опыт работы с API. Понимание принципов алгоритмической торговли. Базовые знания в области блокчейн-технологий. ', 'show_logo_in_search__0': None, 'schedule__0': 'Удаленная работа', 'type__0': 'Открытая', 'alternate_url__0': 'https://hh.ru/vacancy/102978103', 'archived__1': False, 'salary_from__1': 47990.0, 'has_test__1': False, 'url__1': 'https://api.hh.ru/vacancies/104008694?host=hh.ru', 'contacts__1': None, 'vacancy_id__1': '104008694', 'accept_incomplete_resumes__1': True, 'premium__1': False, 'working_days__1': 'Работа только по\\xa0сб\\xa0и\\xa0вс', 'employer_url__1': 'https://hh.ru/employer/3486217', 'vacancy_hash__1': '5abd0bbc5ec1873834c9486b532704bd88ae8f11065d484a22b64af7853f41b5', 'sort_point_distance__1': None, 'employer_name__1': 'ТЭМП', 'response_url__1': None, 'published_at__1': '2024-07-16T16:12:17+0300', 'name__1': 'Удаленный менеджер (срочно, возможна подработка)' ... 6360 parameters truncated ... 'experience__188': 'От 3 до 6 лет', 'salary_to__188': None, 'professional_roles__188': 'Программист, разработчик', 'response_letter_required__188': False, 'apply_alternate_url__188': 'https://hh.ru/applicant/vacancy_response?vacancyId=101279533', 'working_time_modes__188': None, 'accept_temporary__188': False, 'created_at__188': '2024-07-15T09:57:27+0300', 'employment__188': 'Полная занятость', 'department__188': None, 'snippet_responsibility__188': 'Naumen Contact Center - программная платформа для организации контакт-центров. Она обеспечивает работу телефонии, коммуникацию с клиентами в социальных сетях, мессенджерах...', 'snippet_requirement__188': 'Понимание принципов и проблем многопоточного программирования. Опыт разработки клиент-серверных приложений. Будет плюсом: Опыт разработки на <highlighttext>Python</highlighttext>. Высшее профильное образование.', 'show_logo_in_search__188': True, 'schedule__188': 'Удаленная работа', 'type__188': 'Открытая', 'alternate_url__188': 'https://hh.ru/vacancy/101279533', 'archived__189': False, 'salary_from__189': None, 'has_test__189': False, 'url__189': 'https://api.hh.ru/vacancies/102794788?host=hh.ru', 'contacts__189': None, 'vacancy_id__189': '102794788', 'accept_incomplete_resumes__189': False, 'premium__189': False, 'working_days__189': None, 'employer_url__189': 'https://hh.ru/employer/2501342', 'vacancy_hash__189': '695cea8f888792744354dac813fd83911d3dc5cccf6412a9dc706df53e7ef38a', 'sort_point_distance__189': None, 'employer_name__189': 'Ракета', 'response_url__189': None, 'published_at__189': '2024-07-14T17:27:46+0300', 'name__189': 'Аналитик 1С (УТ, ERP)', 'area__189': 'Екатеринбург', 'working_time_intervals__189': None, 'experience__189': 'От 3 до 6 лет', 'salary_to__189': None, 'professional_roles__189': 'Системный аналитик', 'response_letter_required__189': False, 'apply_alternate_url__189': 'https://hh.ru/applicant/vacancy_response?vacancyId=102794788', 'working_time_modes__189': None, 'accept_temporary__189': False, 'created_at__189': '2024-07-14T17:27:46+0300', 'employment__189': 'Полная занятость', 'department__189': None, 'snippet_responsibility__189': 'Планирование этапности перевода функциональности в соответствии с принципами сохранения целостности ведения бизнес-процессов в системе. Формализация требований для <highlighttext>разработчиков</highlighttext>. ', 'snippet_requirement__189': 'Опыт работы с 1С системами в роли аналитика от 3х лет. Опыт работы с УТ в роли аналитика...', 'show_logo_in_search__189': None, 'schedule__189': 'Удаленная работа', 'type__189': 'Открытая', 'alternate_url__189': 'https://hh.ru/vacancy/102794788'}]\n(Background on this error at: https://sqlalche.me/e/20/f405)\n", "record": {"elapsed": {"repr": "0:00:09.738055", "seconds": 9.738055}, "exception": {"type": "ProgrammingError", "value": "(psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 149771 characters truncated ... %(accept_incomplete_resumes__189)s, %(experience__189)s, %(employment__189)s, %(vacancy_hash__189)s)]\n[parameters: {'archived__0': False, 'salary_from__0': 50000.0, 'has_test__0': False, 'url__0': 'https://api.hh.ru/vacancies/102978103?host=hh.ru', 'contacts__0': None, 'vacancy_id__0': '102978103', 'accept_incomplete_resumes__0': False, 'premium__0': False, 'working_days__0': None, 'employer_url__0': 'https://hh.ru/employer/4789182', 'vacancy_hash__0': '24a1e68192ea262701345f49ae0607c004c8356eedcd18ab8024240aaeda7ab9', 'sort_point_distance__0': None, 'employer_name__0': 'Smit&Co', 'response_url__0': None, 'published_at__0': '2024-06-29T23:30:33+0300', 'name__0': 'Программист-стажер в инвестиционный фонд', 'area__0': 'Санкт-Петербург', 'working_time_intervals__0': 'Можно работать сменами по\\xa04–6 часов в\\xa0день', 'experience__0': 'Нет опыта', 'salary_to__0': None, 'professional_roles__0': 'Программист, разработчик', 'response_letter_required__0': True, 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=102978103', 'working_time_modes__0': None, 'accept_temporary__0': False, 'created_at__0': '2024-06-29T23:30:33+0300', 'employment__0': 'Полная занятость', 'department__0': None, 'snippet_responsibility__0': 'Написание кода по техническому заданию. Работа с API различных платформ для выполнения задач. Разработка алгоритмов для торговых стратегий фонда. ', 'snippet_requirement__0': 'Знание языка программирования <highlighttext>Python</highlighttext>. Опыт работы с API. Понимание принципов алгоритмической торговли. Базовые знания в области блокчейн-технологий. ', 'show_logo_in_search__0': None, 'schedule__0': 'Удаленная работа', 'type__0': 'Открытая', 'alternate_url__0': 'https://hh.ru/vacancy/102978103', 'archived__1': False, 'salary_from__1': 47990.0, 'has_test__1': False, 'url__1': 'https://api.hh.ru/vacancies/104008694?host=hh.ru', 'contacts__1': None, 'vacancy_id__1': '104008694', 'accept_incomplete_resumes__1': True, 'premium__1': False, 'working_days__1': 'Работа только по\\xa0сб\\xa0и\\xa0вс', 'employer_url__1': 'https://hh.ru/employer/3486217', 'vacancy_hash__1': '5abd0bbc5ec1873834c9486b532704bd88ae8f11065d484a22b64af7853f41b5', 'sort_point_distance__1': None, 'employer_name__1': 'ТЭМП', 'response_url__1': None, 'published_at__1': '2024-07-16T16:12:17+0300', 'name__1': 'Удаленный менеджер (срочно, возможна подработка)' ... 6360 parameters truncated ... 'experience__188': 'От 3 до 6 лет', 'salary_to__188': None, 'professional_roles__188': 'Программист, разработчик', 'response_letter_required__188': False, 'apply_alternate_url__188': 'https://hh.ru/applicant/vacancy_response?vacancyId=101279533', 'working_time_modes__188': None, 'accept_temporary__188': False, 'created_at__188': '2024-07-15T09:57:27+0300', 'employment__188': 'Полная занятость', 'department__188': None, 'snippet_responsibility__188': 'Naumen Contact Center - программная платформа для организации контакт-центров. Она обеспечивает работу телефонии, коммуникацию с клиентами в социальных сетях, мессенджерах...', 'snippet_requirement__188': 'Понимание принципов и проблем многопоточного программирования. Опыт разработки клиент-серверных приложений. Будет плюсом: Опыт разработки на <highlighttext>Python</highlighttext>. Высшее профильное образование.', 'show_logo_in_search__188': True, 'schedule__188': 'Удаленная работа', 'type__188': 'Открытая', 'alternate_url__188': 'https://hh.ru/vacancy/101279533', 'archived__189': False, 'salary_from__189': None, 'has_test__189': False, 'url__189': 'https://api.hh.ru/vacancies/102794788?host=hh.ru', 'contacts__189': None, 'vacancy_id__189': '102794788', 'accept_incomplete_resumes__189': False, 'premium__189': False, 'working_days__189': None, 'employer_url__189': 'https://hh.ru/employer/2501342', 'vacancy_hash__189': '695cea8f888792744354dac813fd83911d3dc5cccf6412a9dc706df53e7ef38a', 'sort_point_distance__189': None, 'employer_name__189': 'Ракета', 'response_url__189': None, 'published_at__189': '2024-07-14T17:27:46+0300', 'name__189': 'Аналитик 1С (УТ, ERP)', 'area__189': 'Екатеринбург', 'working_time_intervals__189': None, 'experience__189': 'От 3 до 6 лет', 'salary_to__189': None, 'professional_roles__189': 'Системный аналитик', 'response_letter_required__189': False, 'apply_alternate_url__189': 'https://hh.ru/applicant/vacancy_response?vacancyId=102794788', 'working_time_modes__189': None, 'accept_temporary__189': False, 'created_at__189': '2024-07-14T17:27:46+0300', 'employment__189': 'Полная занятость', 'department__189': None, 'snippet_responsibility__189': 'Планирование этапности перевода функциональности в соответствии с принципами сохранения целостности ведения бизнес-процессов в системе. Формализация требований для <highlighttext>разработчиков</highlighttext>. ', 'snippet_requirement__189': 'Опыт работы с 1С системами в роли аналитика от 3х лет. Опыт работы с УТ в роли аналитика...', 'show_logo_in_search__189': None, 'schedule__189': 'Удаленная работа', 'type__189': 'Открытая', 'alternate_url__189': 'https://hh.ru/vacancy/102794788'}]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 263, "message": "An error has been caught in function '<module>', process 'MainProcess' (11572), thread 'MainThread' (6056):", "module": "main", "name": "__main__", "process": {"id": 11572, "name": "MainProcess"}, "thread": {"id": 6056, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:15:50.875765+03:00", "timestamp": 1721214950.875765}}}
{"text": "2024-07-17T14:15:51.101996+0300 INFO Собрано 190 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:09.964286", "seconds": 9.964286}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 264, "message": "Собрано 190 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 11572, "name": "MainProcess"}, "thread": {"id": 6056, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:15:51.101996+03:00", "timestamp": 1721214951.101996}}}
{"text": "2024-07-17T14:17:37.810927+0300 INFO Собрано 154 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:01.990967", "seconds": 1.990967}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 154 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 9512, "name": "MainProcess"}, "thread": {"id": 196, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:17:37.810927+03:00", "timestamp": 1721215057.810927}}}
{"text": "2024-07-17T14:17:41.194998+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.375038", "seconds": 5.375038}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 9512, "name": "MainProcess"}, "thread": {"id": 196, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:17:41.194998+03:00", "timestamp": 1721215061.194998}}}
{"text": "2024-07-17T14:17:45.098062+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (9512), thread 'MainThread' (196):\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 263, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_test': Fa...\n    └ <function save_to_db at 0x0000029894580900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 179, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False, dtype=dtype)\n    │            │      │           │                                              └ {'vacancy_id': <class 'str'>, 'premium': <class 'bool'>, 'name': <class 'str'>, 'department': <class 'str'>, 'has_test': <cla...\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x00000298925614E0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False, 'dtype': {'vacancy_id': <class 'str'>, 'premium': <class 'bool'>, 'name': <class 'str...\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    102978103  ...  24a1e68192ea262701345f49ae0607c0...\n           └ <function NDFrame.to_sql at 0x00000298925613A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x00000298938C1620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x00000298938C31A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x0000029894B75820>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2008, in to_sql\n    table = self.prep_table(\n            │    └ <function SQLDatabase.prep_table at 0x00000298938C3060>\n            └ <pandas.io.sql.SQLDatabase object at 0x0000029894B75820>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1900, in prep_table\n    raise ValueError(f\"The type of {col} is not a SQLAlchemy type\")\n                                    └ 'vacancy_id'\n\nValueError: The type of vacancy_id is not a SQLAlchemy type\n", "record": {"elapsed": {"repr": "0:00:09.278102", "seconds": 9.278102}, "exception": {"type": "ValueError", "value": "The type of vacancy_id is not a SQLAlchemy type", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 263, "message": "An error has been caught in function '<module>', process 'MainProcess' (9512), thread 'MainThread' (196):", "module": "main", "name": "__main__", "process": {"id": 9512, "name": "MainProcess"}, "thread": {"id": 196, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:17:45.098062+03:00", "timestamp": 1721215065.098062}}}
{"text": "2024-07-17T14:17:45.238684+0300 INFO Собрано 190 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:09.418724", "seconds": 9.418724}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 264, "message": "Собрано 190 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 9512, "name": "MainProcess"}, "thread": {"id": 196, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:17:45.238684+03:00", "timestamp": 1721215065.238684}}}
{"text": "2024-07-17T14:22:54.594748+0300 INFO Собрано 154 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:02.095048", "seconds": 2.095048}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 154 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 11240, "name": "MainProcess"}, "thread": {"id": 5444, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:22:54.594748+03:00", "timestamp": 1721215374.594748}}}
{"text": "2024-07-17T14:22:58.418133+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.918433", "seconds": 5.918433}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 11240, "name": "MainProcess"}, "thread": {"id": 5444, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:22:58.418133+03:00", "timestamp": 1721215378.418133}}}
{"text": "2024-07-17T14:23:02.294694+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (11240), thread 'MainThread' (5444):\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 258, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_test': Fa...\n    └ <function save_to_db at 0x0000026DEC0E0900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 174, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False, dtype=dtype)\n    │            │      │           │                                              └ {'vacancy_id': <class 'str'>, 'premium': <class 'bool'>, 'name': <class 'str'>, 'department': <class 'str'>, 'has_test': <cla...\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x0000026DEA0814E0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False, 'dtype': {'vacancy_id': <class 'str'>, 'premium': <class 'bool'>, 'name': <class 'str...\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    102978103  ...  24a1e68192ea262701345f49ae0607c0...\n           └ <function NDFrame.to_sql at 0x0000026DEA0813A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x0000026DEB3E1620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x0000026DEB3E31A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x0000026DEC0D8E30>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2008, in to_sql\n    table = self.prep_table(\n            │    └ <function SQLDatabase.prep_table at 0x0000026DEB3E3060>\n            └ <pandas.io.sql.SQLDatabase object at 0x0000026DEC0D8E30>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1900, in prep_table\n    raise ValueError(f\"The type of {col} is not a SQLAlchemy type\")\n                                    └ 'vacancy_id'\n\nValueError: The type of vacancy_id is not a SQLAlchemy type\n", "record": {"elapsed": {"repr": "0:00:09.794994", "seconds": 9.794994}, "exception": {"type": "ValueError", "value": "The type of vacancy_id is not a SQLAlchemy type", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 258, "message": "An error has been caught in function '<module>', process 'MainProcess' (11240), thread 'MainThread' (5444):", "module": "main", "name": "__main__", "process": {"id": 11240, "name": "MainProcess"}, "thread": {"id": 5444, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:23:02.294694+03:00", "timestamp": 1721215382.294694}}}
{"text": "2024-07-17T14:23:02.445292+0300 INFO Собрано 190 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:09.945592", "seconds": 9.945592}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 259, "message": "Собрано 190 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 11240, "name": "MainProcess"}, "thread": {"id": 5444, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:23:02.445292+03:00", "timestamp": 1721215382.445292}}}
{"text": "2024-07-17T14:25:22.050140+0300 INFO Собрано 154 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:02.139530", "seconds": 2.13953}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 154 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 12208, "name": "MainProcess"}, "thread": {"id": 9212, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:25:22.050140+03:00", "timestamp": 1721215522.05014}}}
{"text": "2024-07-17T14:25:25.553810+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.643200", "seconds": 5.6432}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 12208, "name": "MainProcess"}, "thread": {"id": 9212, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:25:25.553810+03:00", "timestamp": 1721215525.55381}}}
{"text": "2024-07-17T14:25:29.510648+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (12208), thread 'MainThread' (9212):\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 252, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_test': Fa...\n    └ <function save_to_db at 0x00000255D8B10900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 168, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False, dtype=dtype)\n    │            │      │           │                                              └ {'vacancy_id': <class 'sqlalchemy.sql.sqltypes.String'>, 'premium': <class 'bool'>, 'name': <class 'str'>, 'department': <cla...\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x00000255D6A554E0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False, 'dtype': {'vacancy_id': <class 'sqlalchemy.sql.sqltypes.String'>, 'premium': <class '...\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    102978103  ...  24a1e68192ea262701345f49ae0607c0...\n           └ <function NDFrame.to_sql at 0x00000255D6A553A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x00000255D7DB1620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x00000255D7DB31A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x00000255D64FF2F0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2008, in to_sql\n    table = self.prep_table(\n            │    └ <function SQLDatabase.prep_table at 0x00000255D7DB3060>\n            └ <pandas.io.sql.SQLDatabase object at 0x00000255D64FF2F0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1900, in prep_table\n    raise ValueError(f\"The type of {col} is not a SQLAlchemy type\")\n                                    └ 'premium'\n\nValueError: The type of premium is not a SQLAlchemy type\n", "record": {"elapsed": {"repr": "0:00:09.600038", "seconds": 9.600038}, "exception": {"type": "ValueError", "value": "The type of premium is not a SQLAlchemy type", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 252, "message": "An error has been caught in function '<module>', process 'MainProcess' (12208), thread 'MainThread' (9212):", "module": "main", "name": "__main__", "process": {"id": 12208, "name": "MainProcess"}, "thread": {"id": 9212, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:25:29.510648+03:00", "timestamp": 1721215529.510648}}}
{"text": "2024-07-17T14:25:29.691124+0300 INFO Собрано 190 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:09.780514", "seconds": 9.780514}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 253, "message": "Собрано 190 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 12208, "name": "MainProcess"}, "thread": {"id": 9212, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:25:29.691124+03:00", "timestamp": 1721215529.691124}}}
{"text": "2024-07-17T14:28:48.573939+0300 INFO Собрано 154 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:02.420485", "seconds": 2.420485}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 154 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 548, "name": "MainProcess"}, "thread": {"id": 2412, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:28:48.573939+03:00", "timestamp": 1721215728.573939}}}
{"text": "2024-07-17T14:28:52.152477+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.999023", "seconds": 5.999023}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 548, "name": "MainProcess"}, "thread": {"id": 2412, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:28:52.152477+03:00", "timestamp": 1721215732.152477}}}
{"text": "2024-07-17T14:28:56.234643+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (548), thread 'MainThread' (2412):\nTraceback (most recent call last):\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x000002846E2C0C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000002846E27AE40>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'professional_roles__0': 'Программист, разработчик', 'employer_name__0': 'Smit&Co', 'published_at__0': '2024-06-29T23:30:33+...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000002846E9967A0; closed: -1>\n\npsycopg2.ProgrammingError: can't adapt type 'dict'\n\n\nThe above exception was the direct cause of the following exception:\n\n\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 252, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_test': Fa...\n    └ <function save_to_db at 0x000002846E340900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 168, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False, dtype=dtype)\n    │            │      │           │                                              └ {'vacancy_id': <class 'sqlalchemy.sql.sqltypes.String'>, 'premium': <class 'sqlalchemy.sql.sqltypes.Boolean'>, 'name': <class...\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x000002846C3014E0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False, 'dtype': {'vacancy_id': <class 'sqlalchemy.sql.sqltypes.String'>, 'premium': <class '...\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    102978103  ...  24a1e68192ea262701345f49ae0607c0...\n           └ <function NDFrame.to_sql at 0x000002846C3013A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x000002846D651620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x000002846D6531A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x000002846D826BA0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2018, in to_sql\n    total_inserted = sql_engine.insert_records(\n                     │          └ <function SQLAlchemyEngine.insert_records at 0x000002846D652980>\n                     └ <pandas.io.sql.SQLAlchemyEngine object at 0x000002846E8DC710>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1567, in insert_records\n    raise err\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1558, in insert_records\n    return table.insert(chunksize=chunksize, method=method)\n           │     │                │                 └ None\n           │     │                └ None\n           │     └ <function SQLTable.insert at 0x000002846D651DA0>\n           └ <pandas.io.sql.SQLTable object at 0x000002846DB350A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1119, in insert\n    num_inserted = exec_insert(conn, keys, chunk_iter)\n                   │           │     │     └ <zip object at 0x000002846E993BC0>\n                   │           │     └ ['vacancy_id', 'premium', 'name', 'department', 'has_test', 'response_letter_required', 'area', 'salary_from', 'salary_to', '...\n                   │           └ <sqlalchemy.engine.base.Connection object at 0x000002846E935C40>\n                   └ <bound method SQLTable._execute_insert of <pandas.io.sql.SQLTable object at 0x000002846DB350A0>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1010, in _execute_insert\n    result = conn.execute(self.table.insert(), data)\n             │    │       │    │     │         └ [{'vacancy_id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_t...\n             │    │       │    │     └ <function TableClause.insert at 0x000002846E119300>\n             │    │       │    └ Table('stage_pars_hh', MetaData(), Column('vacancy_id', String(), table=<stage_pars_hh>), Column('premium', Boolean(), table=...\n             │    │       └ <pandas.io.sql.SQLTable object at 0x000002846DB350A0>\n             │    └ <function Connection.execute at 0x000002846E1FD440>\n             └ <sqlalchemy.engine.base.Connection object at 0x000002846E935C40>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x000002846E9A2960>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           │          └ <function Connection._execute_clauseelement at 0x000002846E1FD760>\n           └ <sqlalchemy.engine.base.Connection object at 0x000002846E935C40>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          │    └ <function Connection._execute_context at 0x000002846E1FD940>\n          └ <sqlalchemy.engine.base.Connection object at 0x000002846E935C40>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1844, in _execute_context\n    return self._exec_insertmany_context(dialect, context)\n           │    │                        │        └ <sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x000002846E9A2A80>\n           │    │                        └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000002846E27AE40>\n           │    └ <function Connection._exec_insertmany_context at 0x000002846E1FDA80>\n           └ <sqlalchemy.engine.base.Connection object at 0x000002846E935C40>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2124, in _exec_insertmany_context\n    self._handle_dbapi_exception(\n    │    └ <function Connection._handle_dbapi_exception at 0x000002846E1FDC60>\n    └ <sqlalchemy.engine.base.Connection object at 0x000002846E935C40>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2353, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n          │                    │              │                 └ ProgrammingError(\"can't adapt type 'dict'\")\n          │                    │              └ (<class 'psycopg2.ProgrammingError'>, ProgrammingError(\"can't adapt type 'dict'\"), <traceback object at 0x000002846E1595C0>)\n          │                    └ <method 'with_traceback' of 'BaseException' objects>\n          └ ProgrammingError(\"(psycopg2.ProgrammingError) can't adapt type 'dict'\")\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x000002846E2C0C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000002846E27AE40>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'professional_roles__0': 'Программист, разработчик', 'employer_name__0': 'Smit&Co', 'published_at__0': '2024-06-29T23:30:33+...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x000002846E9967A0; closed: -1>\n\nsqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 149771 characters truncated ... %(accept_incomplete_resumes__189)s, %(experience__189)s, %(employment__189)s, %(vacancy_hash__189)s)]\n[parameters: {'professional_roles__0': 'Программист, разработчик', 'employer_name__0': 'Smit&Co', 'published_at__0': '2024-06-29T23:30:33+0300', 'created_at__0': '2024-06-29T23:30:33+0300', 'salary_to__0': None, 'snippet_responsibility__0': 'Написание кода по техническому заданию. Работа с API различных платформ для выполнения задач. Разработка алгоритмов для торговых стратегий фонда. ', 'premium__0': False, 'vacancy_id__0': '102978103', 'show_logo_in_search__0': None, 'working_time_intervals__0': 'Можно работать сменами по\\xa04–6 часов в\\xa0день', 'working_days__0': None, 'area__0': 'Санкт-Петербург', 'archived__0': False, 'url__0': 'https://api.hh.ru/vacancies/102978103?host=hh.ru', 'vacancy_hash__0': '24a1e68192ea262701345f49ae0607c004c8356eedcd18ab8024240aaeda7ab9', 'employment__0': 'Полная занятость', 'name__0': 'Программист-стажер в инвестиционный фонд', 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=102978103', 'accept_temporary__0': False, 'type__0': 'Открытая', 'has_test__0': False, 'schedule__0': 'Удаленная работа', 'accept_incomplete_resumes__0': False, 'experience__0': 'Нет опыта', 'response_letter_required__0': True, 'employer_url__0': 'https://hh.ru/employer/4789182', 'department__0': None, 'sort_point_distance__0': None, 'alternate_url__0': 'https://hh.ru/vacancy/102978103', 'contacts__0': None, 'working_time_modes__0': None, 'snippet_requirement__0': 'Знание языка программирования <highlighttext>Python</highlighttext>. Опыт работы с API. Понимание принципов алгоритмической торговли. Базовые знания в области блокчейн-технологий. ', 'salary_from__0': 50000.0, 'response_url__0': None, 'professional_roles__1': 'Другое', 'employer_name__1': 'ТЭМП', 'published_at__1': '2024-07-16T16:12:17+0300', 'created_at__1': '2024-07-16T16:12:17+0300', 'salary_to__1': None, 'snippet_responsibility__1': 'Помогать клиентам в оперативной настройке работы сервисов. Предоставлять обратную связь менеджерам и <highlighttext>разработчикам</highlighttext> для устранения неполадок. Выполнять поставленные цели и...', 'premium__1': False, 'vacancy_id__1': '104008694', 'show_logo_in_search__1': None, 'working_time_intervals__1': 'Можно работать сменами по\\xa04–6 часов в\\xa0день', 'working_days__1': 'Работа только по\\xa0сб\\xa0и\\xa0вс', 'area__1': 'Санкт-Петербург', 'archived__1': False, 'url__1': 'https://api.hh.ru/vacancies/104008694?host=hh.ru', 'vacancy_hash__1': '5abd0bbc5ec1873834c9486b532704bd88ae8f11065d484a22b64af7853f41b5', 'employment__1': 'Частичная занятость' ... 6360 parameters truncated ... 'accept_temporary__188': False, 'type__188': 'Открытая', 'has_test__188': False, 'schedule__188': 'Удаленная работа', 'accept_incomplete_resumes__188': False, 'experience__188': 'От 3 до 6 лет', 'response_letter_required__188': False, 'employer_url__188': 'https://hh.ru/employer/42600', 'department__188': None, 'sort_point_distance__188': None, 'alternate_url__188': 'https://hh.ru/vacancy/101279533', 'contacts__188': None, 'working_time_modes__188': None, 'snippet_requirement__188': 'Понимание принципов и проблем многопоточного программирования. Опыт разработки клиент-серверных приложений. Будет плюсом: Опыт разработки на <highlighttext>Python</highlighttext>. Высшее профильное образование.', 'salary_from__188': None, 'response_url__188': None, 'professional_roles__189': 'Системный аналитик', 'employer_name__189': 'Ракета', 'published_at__189': '2024-07-14T17:27:46+0300', 'created_at__189': '2024-07-14T17:27:46+0300', 'salary_to__189': None, 'snippet_responsibility__189': 'Планирование этапности перевода функциональности в соответствии с принципами сохранения целостности ведения бизнес-процессов в системе. Формализация требований для <highlighttext>разработчиков</highlighttext>. ', 'premium__189': False, 'vacancy_id__189': '102794788', 'show_logo_in_search__189': None, 'working_time_intervals__189': None, 'working_days__189': None, 'area__189': 'Екатеринбург', 'archived__189': False, 'url__189': 'https://api.hh.ru/vacancies/102794788?host=hh.ru', 'vacancy_hash__189': '695cea8f888792744354dac813fd83911d3dc5cccf6412a9dc706df53e7ef38a', 'employment__189': 'Полная занятость', 'name__189': 'Аналитик 1С (УТ, ERP)', 'apply_alternate_url__189': 'https://hh.ru/applicant/vacancy_response?vacancyId=102794788', 'accept_temporary__189': False, 'type__189': 'Открытая', 'has_test__189': False, 'schedule__189': 'Удаленная работа', 'accept_incomplete_resumes__189': False, 'experience__189': 'От 3 до 6 лет', 'response_letter_required__189': False, 'employer_url__189': 'https://hh.ru/employer/2501342', 'department__189': None, 'sort_point_distance__189': None, 'alternate_url__189': 'https://hh.ru/vacancy/102794788', 'contacts__189': None, 'working_time_modes__189': None, 'snippet_requirement__189': 'Опыт работы с 1С системами в роли аналитика от 3х лет. Опыт работы с УТ в роли аналитика...', 'salary_from__189': None, 'response_url__189': None}]\n(Background on this error at: https://sqlalche.me/e/20/f405)\n", "record": {"elapsed": {"repr": "0:00:10.081189", "seconds": 10.081189}, "exception": {"type": "ProgrammingError", "value": "(psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 149771 characters truncated ... %(accept_incomplete_resumes__189)s, %(experience__189)s, %(employment__189)s, %(vacancy_hash__189)s)]\n[parameters: {'professional_roles__0': 'Программист, разработчик', 'employer_name__0': 'Smit&Co', 'published_at__0': '2024-06-29T23:30:33+0300', 'created_at__0': '2024-06-29T23:30:33+0300', 'salary_to__0': None, 'snippet_responsibility__0': 'Написание кода по техническому заданию. Работа с API различных платформ для выполнения задач. Разработка алгоритмов для торговых стратегий фонда. ', 'premium__0': False, 'vacancy_id__0': '102978103', 'show_logo_in_search__0': None, 'working_time_intervals__0': 'Можно работать сменами по\\xa04–6 часов в\\xa0день', 'working_days__0': None, 'area__0': 'Санкт-Петербург', 'archived__0': False, 'url__0': 'https://api.hh.ru/vacancies/102978103?host=hh.ru', 'vacancy_hash__0': '24a1e68192ea262701345f49ae0607c004c8356eedcd18ab8024240aaeda7ab9', 'employment__0': 'Полная занятость', 'name__0': 'Программист-стажер в инвестиционный фонд', 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=102978103', 'accept_temporary__0': False, 'type__0': 'Открытая', 'has_test__0': False, 'schedule__0': 'Удаленная работа', 'accept_incomplete_resumes__0': False, 'experience__0': 'Нет опыта', 'response_letter_required__0': True, 'employer_url__0': 'https://hh.ru/employer/4789182', 'department__0': None, 'sort_point_distance__0': None, 'alternate_url__0': 'https://hh.ru/vacancy/102978103', 'contacts__0': None, 'working_time_modes__0': None, 'snippet_requirement__0': 'Знание языка программирования <highlighttext>Python</highlighttext>. Опыт работы с API. Понимание принципов алгоритмической торговли. Базовые знания в области блокчейн-технологий. ', 'salary_from__0': 50000.0, 'response_url__0': None, 'professional_roles__1': 'Другое', 'employer_name__1': 'ТЭМП', 'published_at__1': '2024-07-16T16:12:17+0300', 'created_at__1': '2024-07-16T16:12:17+0300', 'salary_to__1': None, 'snippet_responsibility__1': 'Помогать клиентам в оперативной настройке работы сервисов. Предоставлять обратную связь менеджерам и <highlighttext>разработчикам</highlighttext> для устранения неполадок. Выполнять поставленные цели и...', 'premium__1': False, 'vacancy_id__1': '104008694', 'show_logo_in_search__1': None, 'working_time_intervals__1': 'Можно работать сменами по\\xa04–6 часов в\\xa0день', 'working_days__1': 'Работа только по\\xa0сб\\xa0и\\xa0вс', 'area__1': 'Санкт-Петербург', 'archived__1': False, 'url__1': 'https://api.hh.ru/vacancies/104008694?host=hh.ru', 'vacancy_hash__1': '5abd0bbc5ec1873834c9486b532704bd88ae8f11065d484a22b64af7853f41b5', 'employment__1': 'Частичная занятость' ... 6360 parameters truncated ... 'accept_temporary__188': False, 'type__188': 'Открытая', 'has_test__188': False, 'schedule__188': 'Удаленная работа', 'accept_incomplete_resumes__188': False, 'experience__188': 'От 3 до 6 лет', 'response_letter_required__188': False, 'employer_url__188': 'https://hh.ru/employer/42600', 'department__188': None, 'sort_point_distance__188': None, 'alternate_url__188': 'https://hh.ru/vacancy/101279533', 'contacts__188': None, 'working_time_modes__188': None, 'snippet_requirement__188': 'Понимание принципов и проблем многопоточного программирования. Опыт разработки клиент-серверных приложений. Будет плюсом: Опыт разработки на <highlighttext>Python</highlighttext>. Высшее профильное образование.', 'salary_from__188': None, 'response_url__188': None, 'professional_roles__189': 'Системный аналитик', 'employer_name__189': 'Ракета', 'published_at__189': '2024-07-14T17:27:46+0300', 'created_at__189': '2024-07-14T17:27:46+0300', 'salary_to__189': None, 'snippet_responsibility__189': 'Планирование этапности перевода функциональности в соответствии с принципами сохранения целостности ведения бизнес-процессов в системе. Формализация требований для <highlighttext>разработчиков</highlighttext>. ', 'premium__189': False, 'vacancy_id__189': '102794788', 'show_logo_in_search__189': None, 'working_time_intervals__189': None, 'working_days__189': None, 'area__189': 'Екатеринбург', 'archived__189': False, 'url__189': 'https://api.hh.ru/vacancies/102794788?host=hh.ru', 'vacancy_hash__189': '695cea8f888792744354dac813fd83911d3dc5cccf6412a9dc706df53e7ef38a', 'employment__189': 'Полная занятость', 'name__189': 'Аналитик 1С (УТ, ERP)', 'apply_alternate_url__189': 'https://hh.ru/applicant/vacancy_response?vacancyId=102794788', 'accept_temporary__189': False, 'type__189': 'Открытая', 'has_test__189': False, 'schedule__189': 'Удаленная работа', 'accept_incomplete_resumes__189': False, 'experience__189': 'От 3 до 6 лет', 'response_letter_required__189': False, 'employer_url__189': 'https://hh.ru/employer/2501342', 'department__189': None, 'sort_point_distance__189': None, 'alternate_url__189': 'https://hh.ru/vacancy/102794788', 'contacts__189': None, 'working_time_modes__189': None, 'snippet_requirement__189': 'Опыт работы с 1С системами в роли аналитика от 3х лет. Опыт работы с УТ в роли аналитика...', 'salary_from__189': None, 'response_url__189': None}]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 252, "message": "An error has been caught in function '<module>', process 'MainProcess' (548), thread 'MainThread' (2412):", "module": "main", "name": "__main__", "process": {"id": 548, "name": "MainProcess"}, "thread": {"id": 2412, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:28:56.234643+03:00", "timestamp": 1721215736.234643}}}
{"text": "2024-07-17T14:28:56.411985+0300 INFO Собрано 190 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:10.258531", "seconds": 10.258531}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 253, "message": "Собрано 190 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 548, "name": "MainProcess"}, "thread": {"id": 2412, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:28:56.411985+03:00", "timestamp": 1721215736.411985}}}
{"text": "2024-07-17T14:33:11.782617+0300 INFO Собрано 154 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:02.185622", "seconds": 2.185622}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 154 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 4508, "name": "MainProcess"}, "thread": {"id": 7144, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:33:11.782617+03:00", "timestamp": 1721215991.782617}}}
{"text": "2024-07-17T14:33:41.307149+0300 INFO Собрано 155 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:02.064160", "seconds": 2.06416}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 155 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 3896, "name": "MainProcess"}, "thread": {"id": 2348, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:33:41.307149+03:00", "timestamp": 1721216021.307149}}}
{"text": "2024-07-17T14:33:44.708148+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.465159", "seconds": 5.465159}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 3896, "name": "MainProcess"}, "thread": {"id": 2348, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:33:44.708148+03:00", "timestamp": 1721216024.708148}}}
{"text": "2024-07-17T14:33:47.845111+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (3896), thread 'MainThread' (2348):\nTraceback (most recent call last):\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py\", line 3805, in get_loc\n    return self._engine.get_loc(casted_key)\n           │    │               └ 0\n           │    └ <pandas._libs.properties.CachedProperty object at 0x000001D6CF12B940>\n           └ Index(['vacancy_id', 'premium', 'name', 'department', 'has_test',\n                    'response_letter_required', 'area', 'salary_from', '...\n  File \"index.pyx\", line 167, in pandas._libs.index.IndexEngine.get_loc\n  File \"index.pyx\", line 196, in pandas._libs.index.IndexEngine.get_loc\n  File \"pandas\\\\_libs\\\\hashtable_class_helper.pxi\", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item\n  File \"pandas\\\\_libs\\\\hashtable_class_helper.pxi\", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item\n\nKeyError: 0\n\n\nThe above exception was the direct cause of the following exception:\n\n\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 256, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_test': Fa...\n    └ <function save_to_db at 0x000001D6D1460900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 132, in save_to_db\n    print(vacancies_df[0])\n          └     vacancy_id  ...                                       vacancy_hash\n            0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\frame.py\", line 4102, in __getitem__\n    indexer = self.columns.get_loc(key)\n              │    │               └ 0\n              │    └ <pandas._libs.properties.AxisProperty object at 0x000001D6CF4199F0>\n              └     vacancy_id  ...                                       vacancy_hash\n                0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\base.py\", line 3812, in get_loc\n    raise KeyError(key) from err\n                   └ 0\n\nKeyError: 0\n", "record": {"elapsed": {"repr": "0:00:08.602122", "seconds": 8.602122}, "exception": {"type": "KeyError", "value": "0", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 256, "message": "An error has been caught in function '<module>', process 'MainProcess' (3896), thread 'MainThread' (2348):", "module": "main", "name": "__main__", "process": {"id": 3896, "name": "MainProcess"}, "thread": {"id": 2348, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:33:47.845111+03:00", "timestamp": 1721216027.845111}}}
{"text": "2024-07-17T14:33:48.008383+0300 INFO Собрано 191 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:08.765394", "seconds": 8.765394}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 257, "message": "Собрано 191 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 3896, "name": "MainProcess"}, "thread": {"id": 2348, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:33:48.008383+03:00", "timestamp": 1721216028.008383}}}
{"text": "2024-07-17T14:34:09.949331+0300 INFO Собрано 155 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:02.270143", "seconds": 2.270143}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 155 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 9504, "name": "MainProcess"}, "thread": {"id": 9752, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:34:09.949331+03:00", "timestamp": 1721216049.949331}}}
{"text": "2024-07-17T14:34:13.451984+0300 INFO Собрано 36 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:05.772796", "seconds": 5.772796}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "get_vacancies", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 31, "message": "Собрано 36 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 9504, "name": "MainProcess"}, "thread": {"id": 9752, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:34:13.451984+03:00", "timestamp": 1721216053.451984}}}
{"text": "2024-07-17T14:34:17.595322+0300 ERROR An error has been caught in function '<module>', process 'MainProcess' (9504), thread 'MainThread' (9752):\nTraceback (most recent call last):\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x0000017DA9DA0C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x0000017DAA21FC50>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'schedule__0': 'Удаленная работа', 'response_letter_required__0': True, 'url__0': 'https://api.hh.ru/vacancies/102978103?hos...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x0000017DAA48B060; closed: -1>\n\npsycopg2.ProgrammingError: can't adapt type 'dict'\n\n\nThe above exception was the direct cause of the following exception:\n\n\nTraceback (most recent call last):\n\n> File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 256, in <module>\n    save_to_db(all_vacancies, db_url, table_name)\n    │          │              │       └ 'stage_pars_hh'\n    │          │              └ 'postgresql+psycopg2://user544:ROA_Othgc3@pgvps.kulakovav.ru:5432/pars_hh'\n    │          └ [{'id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_test': Fa...\n    └ <function save_to_db at 0x0000017DA9E20900>\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\main.py\", line 172, in save_to_db\n    vacancies_df.to_sql(table_name, engine, if_exists='append', index=False, dtype=dtype)\n    │            │      │           │                                              └ {'vacancy_id': <class 'sqlalchemy.sql.sqltypes.String'>, 'premium': <class 'sqlalchemy.sql.sqltypes.Boolean'>, 'name': <class...\n    │            │      │           └ Engine(postgresql+psycopg2://user544:***@pgvps.kulakovav.ru:5432/pars_hh)\n    │            │      └ 'stage_pars_hh'\n    │            └ <function NDFrame.to_sql at 0x0000017DA7D8D4E0>\n    └     vacancy_id  ...                                       vacancy_hash\n      0    102978103  ...  24a1e68192ea262701345f49ae0607c00...\n\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\util\\_decorators.py\", line 333, in wrapper\n    return func(*args, **kwargs)\n           │     │       └ {'if_exists': 'append', 'index': False, 'dtype': {'vacancy_id': <class 'sqlalchemy.sql.sqltypes.String'>, 'premium': <class '...\n           │     └ (    vacancy_id  ...                                       vacancy_hash\n           │       0    102978103  ...  24a1e68192ea262701345f49ae0607c0...\n           └ <function NDFrame.to_sql at 0x0000017DA7D8D3A0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\core\\generic.py\", line 3087, in to_sql\n    return sql.to_sql(\n           │   └ <function to_sql at 0x0000017DA90F1620>\n           └ <module 'pandas.io.sql' from 'D:\\\\YandexDisk\\\\Programm\\\\pars_hh\\\\.venv\\\\Lib\\\\site-packages\\\\pandas\\\\io\\\\sql.py'>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 842, in to_sql\n    return pandas_sql.to_sql(\n           │          └ <function SQLDatabase.to_sql at 0x0000017DA90F31A0>\n           └ <pandas.io.sql.SQLDatabase object at 0x0000017DA803EBA0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 2018, in to_sql\n    total_inserted = sql_engine.insert_records(\n                     │          └ <function SQLAlchemyEngine.insert_records at 0x0000017DA90F2980>\n                     └ <pandas.io.sql.SQLAlchemyEngine object at 0x0000017DAA4429F0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1567, in insert_records\n    raise err\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1558, in insert_records\n    return table.insert(chunksize=chunksize, method=method)\n           │     │                │                 └ None\n           │     │                └ None\n           │     └ <function SQLTable.insert at 0x0000017DA90F1DA0>\n           └ <pandas.io.sql.SQLTable object at 0x0000017DAA442B70>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1119, in insert\n    num_inserted = exec_insert(conn, keys, chunk_iter)\n                   │           │     │     └ <zip object at 0x0000017DAA4A0240>\n                   │           │     └ ['vacancy_id', 'premium', 'name', 'department', 'has_test', 'response_letter_required', 'area', 'salary_from', 'salary_to', '...\n                   │           └ <sqlalchemy.engine.base.Connection object at 0x0000017DAA3AACC0>\n                   └ <bound method SQLTable._execute_insert of <pandas.io.sql.SQLTable object at 0x0000017DAA442B70>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\pandas\\io\\sql.py\", line 1010, in _execute_insert\n    result = conn.execute(self.table.insert(), data)\n             │    │       │    │     │         └ [{'vacancy_id': '102978103', 'premium': False, 'name': 'Программист-стажер в инвестиционный фонд', 'department': None, 'has_t...\n             │    │       │    │     └ <function TableClause.insert at 0x0000017DA9BF9300>\n             │    │       │    └ Table('stage_pars_hh', MetaData(), Column('vacancy_id', String(), table=<stage_pars_hh>), Column('premium', Boolean(), table=...\n             │    │       └ <pandas.io.sql.SQLTable object at 0x0000017DAA442B70>\n             │    └ <function Connection.execute at 0x0000017DA9CDD440>\n             └ <sqlalchemy.engine.base.Connection object at 0x0000017DAA3AACC0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x0000017DAA4775C0>>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           │          └ <function Connection._execute_clauseelement at 0x0000017DA9CDD760>\n           └ <sqlalchemy.engine.base.Connection object at 0x0000017DAA3AACC0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          │    └ <function Connection._execute_context at 0x0000017DA9CDD940>\n          └ <sqlalchemy.engine.base.Connection object at 0x0000017DAA3AACC0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1844, in _execute_context\n    return self._exec_insertmany_context(dialect, context)\n           │    │                        │        └ <sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2 object at 0x0000017DAA4776E0>\n           │    │                        └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x0000017DAA21FC50>\n           │    └ <function Connection._exec_insertmany_context at 0x0000017DA9CDDA80>\n           └ <sqlalchemy.engine.base.Connection object at 0x0000017DAA3AACC0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2124, in _exec_insertmany_context\n    self._handle_dbapi_exception(\n    │    └ <function Connection._handle_dbapi_exception at 0x0000017DA9CDDC60>\n    └ <sqlalchemy.engine.base.Connection object at 0x0000017DAA3AACC0>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2353, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n          │                    │              │                 └ ProgrammingError(\"can't adapt type 'dict'\")\n          │                    │              └ (<class 'psycopg2.ProgrammingError'>, ProgrammingError(\"can't adapt type 'dict'\"), <traceback object at 0x0000017DA4D14240>)\n          │                    └ <method 'with_traceback' of 'BaseException' objects>\n          └ ProgrammingError(\"(psycopg2.ProgrammingError) can't adapt type 'dict'\")\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2116, in _exec_insertmany_context\n    dialect.do_execute(\n    │       └ <function DefaultDialect.do_execute at 0x0000017DA9DA0C20>\n    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x0000017DAA21FC50>\n  File \"D:\\YandexDisk\\Programm\\pars_hh\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 924, in do_execute\n    cursor.execute(statement, parameters)\n    │      │       │          └ {'schedule__0': 'Удаленная работа', 'response_letter_required__0': True, 'url__0': 'https://api.hh.ru/vacancies/102978103?hos...\n    │      │       └ 'INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, sal...\n    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>\n    └ <cursor object at 0x0000017DAA48B060; closed: -1>\n\nsqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 150578 characters truncated ... %(accept_incomplete_resumes__190)s, %(experience__190)s, %(employment__190)s, %(vacancy_hash__190)s)]\n[parameters: {'schedule__0': 'Удаленная работа', 'response_letter_required__0': True, 'url__0': 'https://api.hh.ru/vacancies/102978103?host=hh.ru', 'created_at__0': '2024-06-29T23:30:33+0300', 'employer_url__0': 'https://hh.ru/employer/4789182', 'archived__0': False, 'salary_to__0': None, 'premium__0': False, 'response_url__0': None, 'vacancy_id__0': '102978103', 'professional_roles__0': 'Программист, разработчик', 'has_test__0': False, 'sort_point_distance__0': None, 'snippet_responsibility__0': 'Написание кода по техническому заданию. Работа с API различных платформ для выполнения задач. Разработка алгоритмов для торговых стратегий фонда. ', 'show_logo_in_search__0': None, 'salary_from__0': 50000.0, 'contacts__0': None, 'department__0': None, 'working_time_intervals__0': 'Можно работать сменами по\\xa04–6 часов в\\xa0день', 'type__0': 'Открытая', 'experience__0': 'Нет опыта', 'snippet_requirement__0': 'Знание языка программирования <highlighttext>Python</highlighttext>. Опыт работы с API. Понимание принципов алгоритмической торговли. Базовые знания в области блокчейн-технологий. ', 'area__0': 'Санкт-Петербург', 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=102978103', 'name__0': 'Программист-стажер в инвестиционный фонд', 'employer_name__0': 'Smit&Co', 'accept_incomplete_resumes__0': False, 'vacancy_hash__0': '24a1e68192ea262701345f49ae0607c004c8356eedcd18ab8024240aaeda7ab9', 'published_at__0': '2024-06-29T23:30:33+0300', 'accept_temporary__0': False, 'working_time_modes__0': None, 'employment__0': 'Полная занятость', 'working_days__0': None, 'alternate_url__0': 'https://hh.ru/vacancy/102978103', 'schedule__1': 'Удаленная работа', 'response_letter_required__1': False, 'url__1': 'https://api.hh.ru/vacancies/104008694?host=hh.ru', 'created_at__1': '2024-07-16T16:12:17+0300', 'employer_url__1': 'https://hh.ru/employer/3486217', 'archived__1': False, 'salary_to__1': None, 'premium__1': False, 'response_url__1': None, 'vacancy_id__1': '104008694', 'professional_roles__1': 'Другое', 'has_test__1': False, 'sort_point_distance__1': None, 'snippet_responsibility__1': 'Помогать клиентам в оперативной настройке работы сервисов. Предоставлять обратную связь менеджерам и <highlighttext>разработчикам</highlighttext> для устранения неполадок. Выполнять поставленные цели и...', 'show_logo_in_search__1': None, 'salary_from__1': 47990.0 ... 6394 parameters truncated ... 'working_time_intervals__189': None, 'type__189': 'Открытая', 'experience__189': 'От 3 до 6 лет', 'snippet_requirement__189': 'Понимание принципов и проблем многопоточного программирования. Опыт разработки клиент-серверных приложений. Будет плюсом: Опыт разработки на <highlighttext>Python</highlighttext>. Высшее профильное образование.', 'area__189': 'Екатеринбург', 'apply_alternate_url__189': 'https://hh.ru/applicant/vacancy_response?vacancyId=101279533', 'name__189': 'Senior C++ разработчик на продукт Naumen Contact Center', 'employer_name__189': 'NAUMEN', 'accept_incomplete_resumes__189': False, 'vacancy_hash__189': '2adaa4587d4f3a9f951eddb4e9a4d4e51807a43920862499892b905f697a9920', 'published_at__189': '2024-07-15T09:57:27+0300', 'accept_temporary__189': False, 'working_time_modes__189': None, 'employment__189': 'Полная занятость', 'working_days__189': None, 'alternate_url__189': 'https://hh.ru/vacancy/101279533', 'schedule__190': 'Удаленная работа', 'response_letter_required__190': False, 'url__190': 'https://api.hh.ru/vacancies/102794788?host=hh.ru', 'created_at__190': '2024-07-14T17:27:46+0300', 'employer_url__190': 'https://hh.ru/employer/2501342', 'archived__190': False, 'salary_to__190': None, 'premium__190': False, 'response_url__190': None, 'vacancy_id__190': '102794788', 'professional_roles__190': 'Системный аналитик', 'has_test__190': False, 'sort_point_distance__190': None, 'snippet_responsibility__190': 'Планирование этапности перевода функциональности в соответствии с принципами сохранения целостности ведения бизнес-процессов в системе. Формализация требований для <highlighttext>разработчиков</highlighttext>. ', 'show_logo_in_search__190': None, 'salary_from__190': None, 'contacts__190': None, 'department__190': None, 'working_time_intervals__190': None, 'type__190': 'Открытая', 'experience__190': 'От 3 до 6 лет', 'snippet_requirement__190': 'Опыт работы с 1С системами в роли аналитика от 3х лет. Опыт работы с УТ в роли аналитика...', 'area__190': 'Екатеринбург', 'apply_alternate_url__190': 'https://hh.ru/applicant/vacancy_response?vacancyId=102794788', 'name__190': 'Аналитик 1С (УТ, ERP)', 'employer_name__190': 'Ракета', 'accept_incomplete_resumes__190': False, 'vacancy_hash__190': '695cea8f888792744354dac813fd83911d3dc5cccf6412a9dc706df53e7ef38a', 'published_at__190': '2024-07-14T17:27:46+0300', 'accept_temporary__190': False, 'working_time_modes__190': None, 'employment__190': 'Полная занятость', 'working_days__190': None, 'alternate_url__190': 'https://hh.ru/vacancy/102794788'}]\n(Background on this error at: https://sqlalche.me/e/20/f405)\n", "record": {"elapsed": {"repr": "0:00:09.916134", "seconds": 9.916134}, "exception": {"type": "ProgrammingError", "value": "(psycopg2.ProgrammingError) can't adapt type 'dict'\n[SQL: INSERT INTO stage_pars_hh (vacancy_id, premium, name, department, has_test, response_letter_required, area, salary_from, salary_to, type, response_url, sort_point_distance, published_at, created_at, archived, apply_alternate_url, show_logo_in_search, ... 150578 characters truncated ... %(accept_incomplete_resumes__190)s, %(experience__190)s, %(employment__190)s, %(vacancy_hash__190)s)]\n[parameters: {'schedule__0': 'Удаленная работа', 'response_letter_required__0': True, 'url__0': 'https://api.hh.ru/vacancies/102978103?host=hh.ru', 'created_at__0': '2024-06-29T23:30:33+0300', 'employer_url__0': 'https://hh.ru/employer/4789182', 'archived__0': False, 'salary_to__0': None, 'premium__0': False, 'response_url__0': None, 'vacancy_id__0': '102978103', 'professional_roles__0': 'Программист, разработчик', 'has_test__0': False, 'sort_point_distance__0': None, 'snippet_responsibility__0': 'Написание кода по техническому заданию. Работа с API различных платформ для выполнения задач. Разработка алгоритмов для торговых стратегий фонда. ', 'show_logo_in_search__0': None, 'salary_from__0': 50000.0, 'contacts__0': None, 'department__0': None, 'working_time_intervals__0': 'Можно работать сменами по\\xa04–6 часов в\\xa0день', 'type__0': 'Открытая', 'experience__0': 'Нет опыта', 'snippet_requirement__0': 'Знание языка программирования <highlighttext>Python</highlighttext>. Опыт работы с API. Понимание принципов алгоритмической торговли. Базовые знания в области блокчейн-технологий. ', 'area__0': 'Санкт-Петербург', 'apply_alternate_url__0': 'https://hh.ru/applicant/vacancy_response?vacancyId=102978103', 'name__0': 'Программист-стажер в инвестиционный фонд', 'employer_name__0': 'Smit&Co', 'accept_incomplete_resumes__0': False, 'vacancy_hash__0': '24a1e68192ea262701345f49ae0607c004c8356eedcd18ab8024240aaeda7ab9', 'published_at__0': '2024-06-29T23:30:33+0300', 'accept_temporary__0': False, 'working_time_modes__0': None, 'employment__0': 'Полная занятость', 'working_days__0': None, 'alternate_url__0': 'https://hh.ru/vacancy/102978103', 'schedule__1': 'Удаленная работа', 'response_letter_required__1': False, 'url__1': 'https://api.hh.ru/vacancies/104008694?host=hh.ru', 'created_at__1': '2024-07-16T16:12:17+0300', 'employer_url__1': 'https://hh.ru/employer/3486217', 'archived__1': False, 'salary_to__1': None, 'premium__1': False, 'response_url__1': None, 'vacancy_id__1': '104008694', 'professional_roles__1': 'Другое', 'has_test__1': False, 'sort_point_distance__1': None, 'snippet_responsibility__1': 'Помогать клиентам в оперативной настройке работы сервисов. Предоставлять обратную связь менеджерам и <highlighttext>разработчикам</highlighttext> для устранения неполадок. Выполнять поставленные цели и...', 'show_logo_in_search__1': None, 'salary_from__1': 47990.0 ... 6394 parameters truncated ... 'working_time_intervals__189': None, 'type__189': 'Открытая', 'experience__189': 'От 3 до 6 лет', 'snippet_requirement__189': 'Понимание принципов и проблем многопоточного программирования. Опыт разработки клиент-серверных приложений. Будет плюсом: Опыт разработки на <highlighttext>Python</highlighttext>. Высшее профильное образование.', 'area__189': 'Екатеринбург', 'apply_alternate_url__189': 'https://hh.ru/applicant/vacancy_response?vacancyId=101279533', 'name__189': 'Senior C++ разработчик на продукт Naumen Contact Center', 'employer_name__189': 'NAUMEN', 'accept_incomplete_resumes__189': False, 'vacancy_hash__189': '2adaa4587d4f3a9f951eddb4e9a4d4e51807a43920862499892b905f697a9920', 'published_at__189': '2024-07-15T09:57:27+0300', 'accept_temporary__189': False, 'working_time_modes__189': None, 'employment__189': 'Полная занятость', 'working_days__189': None, 'alternate_url__189': 'https://hh.ru/vacancy/101279533', 'schedule__190': 'Удаленная работа', 'response_letter_required__190': False, 'url__190': 'https://api.hh.ru/vacancies/102794788?host=hh.ru', 'created_at__190': '2024-07-14T17:27:46+0300', 'employer_url__190': 'https://hh.ru/employer/2501342', 'archived__190': False, 'salary_to__190': None, 'premium__190': False, 'response_url__190': None, 'vacancy_id__190': '102794788', 'professional_roles__190': 'Системный аналитик', 'has_test__190': False, 'sort_point_distance__190': None, 'snippet_responsibility__190': 'Планирование этапности перевода функциональности в соответствии с принципами сохранения целостности ведения бизнес-процессов в системе. Формализация требований для <highlighttext>разработчиков</highlighttext>. ', 'show_logo_in_search__190': None, 'salary_from__190': None, 'contacts__190': None, 'department__190': None, 'working_time_intervals__190': None, 'type__190': 'Открытая', 'experience__190': 'От 3 до 6 лет', 'snippet_requirement__190': 'Опыт работы с 1С системами в роли аналитика от 3х лет. Опыт работы с УТ в роли аналитика...', 'area__190': 'Екатеринбург', 'apply_alternate_url__190': 'https://hh.ru/applicant/vacancy_response?vacancyId=102794788', 'name__190': 'Аналитик 1С (УТ, ERP)', 'employer_name__190': 'Ракета', 'accept_incomplete_resumes__190': False, 'vacancy_hash__190': '695cea8f888792744354dac813fd83911d3dc5cccf6412a9dc706df53e7ef38a', 'published_at__190': '2024-07-14T17:27:46+0300', 'accept_temporary__190': False, 'working_time_modes__190': None, 'employment__190': 'Полная занятость', 'working_days__190': None, 'alternate_url__190': 'https://hh.ru/vacancy/102794788'}]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "traceback": true}, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 256, "message": "An error has been caught in function '<module>', process 'MainProcess' (9504), thread 'MainThread' (9752):", "module": "main", "name": "__main__", "process": {"id": 9504, "name": "MainProcess"}, "thread": {"id": 9752, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:34:17.595322+03:00", "timestamp": 1721216057.595322}}}
{"text": "2024-07-17T14:34:17.798776+0300 INFO Собрано 191 вакансий и сохранено в базу данных\n", "record": {"elapsed": {"repr": "0:00:10.119588", "seconds": 10.119588}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "D:\\YandexDisk\\Programm\\pars_hh\\main.py"}, "function": "<module>", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 257, "message": "Собрано 191 вакансий и сохранено в базу данных", "module": "main", "name": "__main__", "process": {"id": 9504, "name": "MainProcess"}, "thread": {"id": 9752, "name": "MainThread"}, "time": {"repr": "2024-07-17 14:34:17.798776+03:00", "timestamp": 1721216057.798776}}}
